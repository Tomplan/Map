import{u as j,r as d,j as e,bd as v,be as _,_ as E}from"./index-7f5811f0.js";function P({isAdminView:m,mapInstance:n,updateMarker:l}){const{t:r}=j(),[i,h]=d.useState(!1),[b,p]=d.useState(!1),[a,c]=d.useState(""),[g,s]=d.useState(""),k=()=>{p(!0),c(""),s("")},M=async()=>{if(!a||isNaN(Number(a))){s(r("mapManagement.errorInvalidId"));return}if(await w(a)){s(r("mapManagement.errorIdExists"));return}p(!1),h(!0),s("")},y=()=>{p(!1),c(""),s("")};d.useEffect(()=>{if(!i||!n||!a)return;const t=u=>{const f=u.latlng,o={...C({lat:f.lat,lng:f.lng}),id:Number(a)};typeof l=="function"&&l(o.id,o,{add:!0}),h(!1),c(""),n.off("click",t)};return n.on("click",t),()=>{n.off("click",t)}},[i,n,l,a]);async function w(t){try{const{supabase:u}=await E(()=>import("./index-7f5811f0.js").then(o=>o.bh),["assets/index-7f5811f0.js","assets/index-aedf75d4.css"]),f=["markers_core","markers_appearance","markers_content"];for(const o of f){const{data:x,error:I}=await u.from(o).select("id").eq("id",Number(t));if(I)return!1;if(x&&x.length>0)return!0}return!1}catch{return!1}}return!m||typeof l!="function"?null:e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:k,"aria-label":"Add marker","data-testid":"add-marker-button",className:"bg-white rounded-full shadow p-2 flex items-center justify-center print-hide",style:{position:"absolute",left:10,top:60,zIndex:1001,width:44,height:44,border:"none",cursor:i?"crosshair":"pointer",background:i?"#e3f2fd":"white"},title:r(i?"mapManagement.addMarkerTooltipActive":"mapManagement.addMarkerTooltip"),children:[e.jsx(v.Icon,{path:_,size:1.5,color:"#1976d2","aria-hidden":"true",style:{width:"42px",height:"42px"}}),e.jsx("span",{className:"sr-only",children:r("mapManagement.addMarker")})]}),b&&e.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100svh",background:"rgba(0,0,0,0.3)",zIndex:2e3,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs("div",{style:{background:"white",borderRadius:8,boxShadow:"0 2px 16px rgba(25,118,210,0.15)",padding:32,minWidth:320,display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx("h2",{style:{color:"#1976d2",fontWeight:700,marginBottom:16},children:r("mapManagement.enterMarkerId")}),e.jsx("input",{type:"number",value:a,onChange:t=>c(t.target.value),style:{fontSize:18,padding:"8px 12px",border:"2px solid #1976d2",borderRadius:4,marginBottom:12,width:"100%"},placeholder:r("mapManagement.markerIdPlaceholder"),min:1}),g&&e.jsx("div",{style:{color:"red",marginBottom:8},children:g}),e.jsxs("div",{style:{display:"flex",gap:12},children:[e.jsx("button",{onClick:M,style:{background:"#1976d2",color:"white",border:"none",borderRadius:4,padding:"8px 20px",fontWeight:600,cursor:"pointer"},children:r("mapManagement.confirm")}),e.jsx("button",{onClick:y,style:{background:"#eee",color:"#1976d2",border:"none",borderRadius:4,padding:"8px 20px",fontWeight:600,cursor:"pointer"},children:r("mapManagement.cancel")})]})]})})]})}function C({lat:m,lng:n}){return{id:null,lat:m,lng:n,name:"",label:"",logo:"",coreLocked:!1}}export{P as default};
