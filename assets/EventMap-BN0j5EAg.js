const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-D7EvdnWU.js","assets/index-DR-7GlaB.css"])))=>i.map(i=>d[i]);
import{r as x,a as xe,g as be,b as ve,l as B,c as we,R as E,L as Le,d as Se,e as V,f as je,h as Me,w as Ce,i as Ne,j as M,k as l,m as le,n as K,M as Ee,I as Ie,o as ze,_ as Oe,p as Ae,q as Te}from"./index-D7EvdnWU.js";const Pe=(e,t,n,o)=>{const i=[n,{code:t,...o||{}}];if(e?.services?.logger?.forward)return e.services.logger.forward(i,"warn","react-i18next::",!0);T(i[0])&&(i[0]=`react-i18next:: ${i[0]}`),e?.services?.logger?.warn?e.services.logger.warn(...i):console?.warn&&console.warn(...i)},te={},ce=(e,t,n,o)=>{T(n)&&te[n]||(T(n)&&(te[n]=new Date),Pe(e,t,n,o))},de=(e,t)=>()=>{if(e.isInitialized)t();else{const n=()=>{setTimeout(()=>{e.off("initialized",n)},0),t()};e.on("initialized",n)}},Y=(e,t,n)=>{e.loadNamespaces(t,de(e,n))},ne=(e,t,n,o)=>{if(T(n)&&(n=[n]),e.options.preload&&e.options.preload.indexOf(t)>-1)return Y(e,n,o);n.forEach(i=>{e.options.ns.indexOf(i)<0&&e.options.ns.push(i)}),e.loadLanguages(t,de(e,o))},_e=(e,t,n={})=>!t.languages||!t.languages.length?(ce(t,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:t.languages}),!0):t.hasLoadedNamespace(e,{lng:n.lng,precheck:(o,i)=>{if(n.bindI18n&&n.bindI18n.indexOf("languageChanging")>-1&&o.services.backendConnector.backend&&o.isLanguageChangingTo&&!i(o.isLanguageChangingTo,e))return!1}}),T=e=>typeof e=="string",Re=e=>typeof e=="object"&&e!==null,ke=x.createContext();class De{constructor(){this.usedNamespaces={}}addUsedNamespaces(t){t.forEach(n=>{this.usedNamespaces[n]||(this.usedNamespaces[n]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}var q={exports:{}},X={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oe;function He(){if(oe)return X;oe=1;var e=xe();function t(g,h){return g===h&&(g!==0||1/g===1/h)||g!==g&&h!==h}var n=typeof Object.is=="function"?Object.is:t,o=e.useState,i=e.useEffect,c=e.useLayoutEffect,r=e.useDebugValue;function u(g,h){var b=h(),y=o({inst:{value:b,getSnapshot:h}}),w=y[0].inst,m=y[1];return c(function(){w.value=b,w.getSnapshot=h,d(w)&&m({inst:w})},[g,b,h]),i(function(){return d(w)&&m({inst:w}),g(function(){d(w)&&m({inst:w})})},[g]),r(b),b}function d(g){var h=g.getSnapshot;g=g.value;try{var b=h();return!n(g,b)}catch{return!0}}function a(g,h){return h()}var s=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?a:u;return X.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:s,X}var ae;function $e(){return ae||(ae=1,q.exports=He()),q.exports}var Ue=$e();const We=(e,t)=>T(t)?t:Re(t)&&T(t.defaultValue)?t.defaultValue:Array.isArray(e)?e[e.length-1]:e,Ge={t:We,ready:!1},Be=()=>()=>{},ue=(e,t={})=>{const{i18n:n}=t,{i18n:o,defaultNS:i}=x.useContext(ke)||{},c=n||o||be();c&&!c.reportNamespaces&&(c.reportNamespaces=new De),c||ce(c,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const r=x.useMemo(()=>({...ve(),...c?.options?.react,...t}),[c,t]),{useSuspense:u,keyPrefix:d}=r,a=x.useMemo(()=>{const f=i||c?.options?.defaultNS;return T(f)?[f]:f||["translation"]},[e,i,c]);c?.reportNamespaces?.addUsedNamespaces?.(a);const s=x.useCallback(f=>{if(!c)return Be;const{bindI18n:v,bindI18nStore:L}=r;return v&&c.on(v,f),L&&c.store.on(L,f),()=>{v&&v.split(" ").forEach(N=>c.off(N,f)),L&&L.split(" ").forEach(N=>c.store.off(N,f))}},[c,r]),g=x.useRef(),h=x.useCallback(()=>{if(!c)return Ge;const f=!!(c.isInitialized||c.initializedStoreOnce)&&a.every(z=>_e(z,c,r)),v=c.getFixedT(t.lng||c.language,r.nsMode==="fallback"?a:a[0],d),L=g.current;if(L&&L.ready===f&&L.lng===(t.lng||c.language)&&L.keyPrefix===d)return L;const N={t:v,ready:f,lng:t.lng||c.language,keyPrefix:d};return g.current=N,N},[c,a,d,r,t.lng]),[b,y]=x.useState(0),{t:w,ready:m}=Ue.useSyncExternalStore(s,h,h);x.useEffect(()=>{if(c&&!m&&!u){const f=()=>y(v=>v+1);t.lng?ne(c,t.lng,a,f):Y(c,a,f)}},[c,t.lng,a,m,u,b]);const S=c||{},C=x.useMemo(()=>{const f=[w,S,m];return f.t=w,f.i18n=S,f.ready=m,f},[w,S,m]);if(c&&u&&!m)throw new Promise(f=>{const v=()=>f();t.lng?ne(c,t.lng,a,v):Y(c,a,v)});return C};function Fe(e,t,n){const{opacity:o,zIndex:i}=t;o!=null&&o!==n.opacity&&e.setOpacity(o),i!=null&&i!==n.zIndex&&e.setZIndex(i)}function Ze({bounds:e,boundsOptions:t,center:n,children:o,className:i,id:c,placeholder:r,style:u,whenReady:d,zoom:a,...s},g){const[h]=x.useState({className:i,id:c,style:u}),[b,y]=x.useState(null),w=x.useRef(void 0);x.useImperativeHandle(g,()=>b?.map??null,[b]);const m=x.useCallback(C=>{if(C!==null&&!w.current){const f=new B.Map(C,s);w.current=f,n!=null&&a!=null?f.setView(n,a):e!=null&&f.fitBounds(e,t),d!=null&&f.whenReady(d),y(we(f))}},[]);x.useEffect(()=>()=>{b?.map.remove()},[b]);const S=b?E.createElement(Le,{value:b},o):r??null;return E.createElement("div",{...h,ref:m},S)}const qe=x.forwardRef(Ze),fe=Se(function({position:t,...n},o){const i=new B.Marker(t,n);return V(i,je(o,{overlayContainer:i}))},function(t,n,o){n.position!==o.position&&t.setLatLng(n.position),n.icon!=null&&n.icon!==o.icon&&t.setIcon(n.icon),n.zIndexOffset!=null&&n.zIndexOffset!==o.zIndexOffset&&t.setZIndexOffset(n.zIndexOffset),n.opacity!=null&&n.opacity!==o.opacity&&t.setOpacity(n.opacity),t.dragging!=null&&n.draggable!==o.draggable&&(n.draggable===!0?t.dragging.enable():t.dragging.disable())}),Xe=Me(function({url:t,...n},o){const i=new B.TileLayer(t,Ce(n,o));return V(i,o)},function(t,n,o){Fe(t,n,o);const{url:i}=n;i!=null&&i!==o.url&&t.setUrl(i)}),he=Ne(function(t,n){const o=new B.Tooltip(t,n.overlayContainer);return V(o,n)},function(t,n,{position:o},i){x.useEffect(function(){const r=n.overlayContainer;if(r==null)return;const{instance:u}=t,d=s=>{s.tooltip===u&&(o!=null&&u.setLatLng(o),u.update(),i(!0))},a=s=>{s.tooltip===u&&i(!1)};return r.on({tooltipopen:d,tooltipclose:a}),r.bindTooltip(u),function(){r.off({tooltipopen:d,tooltipclose:a}),r._map!=null&&r.unbindTooltip()}},[t,n,i,o])});function J({glyph:e,glyphColor:t="white",bgColor:n="white",glyphSize:o="8px",iconUrl:i="/Map/assets/icons/glyph-marker-icon-blue.svg",className:c,iconSize:r,prefix:u,glyphAnchor:d}){let a=o;typeof a=="number"?a=`${a}px`:typeof a=="string"&&!a.endsWith("px")?a=`${a}px`:a||(a="8px");const s=r||[25,41],g=Math.round(s[0]*(41/25)),h=Math.round(s[1]*(41/41)),b=Math.round(g*12/41),y=h;return M.icon.glyph({iconUrl:i||"/Map/assets/icons/glyph-marker-icon-blue.svg",iconSize:s,iconAnchor:[Math.round(s[0]/2),s[1]],popupAnchor:[1,-34],tooltipAnchor:[0,0],shadowUrl:"/Map/assets/icons/marker-shadow.png",shadowSize:[g,h],shadowAnchor:[b,y],prefix:u||"",glyph:e||"",glyphColor:t||"white",bgColor:n,glyphSize:a,glyphAnchor:d||[0,0],className:c||""})}function Ye({safeMarkers:e,infoButtonToggled:t,setInfoButtonToggled:n,isMobile:o,updateMarker:i,isMarkerDraggable:c}){return l.jsx(l.Fragment,{children:e.filter(r=>r.id>=1001).map(r=>{const u=t[r.id];let d=[r.lat,r.lng],a=r.iconUrl;a||(a=`${r.type||"glyph-marker-icon-blue"}.svg`),a=le(a);const s=J({className:r.type?`marker-icon marker-type-${r.type}`:"marker-icon",prefix:r.prefix,iconUrl:a,iconSize:Array.isArray(r.iconSize)?r.iconSize:[17,28],glyph:r.glyph||"?",glyphColor:r.glyphColor||"white",glyphSize:r.glyphSize||"12px",glyphAnchor:r.glyphAnchor||[0,-5]}),g=r.logo?K(r.logo):null,h=c(r),b={...h?{dragend:y=>{const{lat:w,lng:m}=y.target.getLatLng();i(r.id,{lat:w,lng:m})}}:{}};return l.jsx(fe,{position:d,icon:s,draggable:h,eventHandlers:b,children:l.jsx(he,{direction:"top",offset:[0,-32],opacity:1,permanent:!1,interactive:!0,children:l.jsxs("div",{className:"flex flex-col items-center",children:[g&&l.jsx("img",{src:g,alt:r.name||"Logo",style:{maxWidth:120,maxHeight:80,objectFit:"contain",borderRadius:0}}),l.jsx("span",{style:{fontWeight:600,color:"#1976d2"},children:r.name}),o&&l.jsx("button",{className:`mt-2 px-2 py-1 text-xs rounded ${u?"bg-green-500 text-white":"bg-blue-500 text-white"}`,onClick:()=>{n(y=>({...y,[r.id]:!y[r.id]}))},children:"More info"})]})})},`${r.id}-${r.coreLocked}-${r.appearanceLocked}-${r.contentLocked}-${r.adminLocked}`)})})}function Ve({safeMarkers:e,infoButtonToggled:t,setInfoButtonToggled:n,isMobile:o,updateMarker:i,isMarkerDraggable:c,iconCreateFunction:r}){const u=E.useRef({}),[d,a]=E.useState({});return l.jsx(Ee,{chunkedLoading:!0,showCoverageOnHover:!0,spiderfyOnMaxZoom:!1,removeOutsideVisibleBounds:!0,disableClusteringAtZoom:18,maxClusterRadius:400,iconCreateFunction:r,children:e.filter(s=>s.id<1001).map(s=>{t[s.id];let g=[s.lat,s.lng],h=s.iconUrl;h||(h=`${s.type||"default"}.svg`),h=le(h);const b=J({className:s.type?`marker-icon marker-type-${s.type}`:"marker-icon",prefix:s.prefix,iconUrl:h,iconSize:Array.isArray(s.iconSize)?s.iconSize:[15,25],glyph:s.glyph||"",glyphColor:s.glyphColor||"white",glyphSize:s.glyphSize||"9px",glyphAnchor:s.glyphAnchor||[0,-4]}),y=s.logo?K(s.logo):null,w=c(s),m={...w?{dragend:f=>{const{lat:v,lng:L}=f.target.getLatLng();i(s.id,{lat:v,lng:L})}}:{}};u.current[s.id]||(u.current[s.id]=E.createRef());const C=o?{...m,click:()=>{d[s.id]||(a(f=>({...f,[s.id]:!0})),setTimeout(()=>{a(f=>({...f,[s.id]:!1}))},1500))}}:m;return l.jsx(fe,{position:g,icon:b,draggable:w,eventHandlers:C,ref:u.current[s.id],children:o?l.jsx(l.Fragment,{children:d[s.id]&&l.jsx(he,{direction:"top",offset:[0,-32],opacity:1,children:l.jsxs("div",{className:"flex flex-col items-center text-center",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[y&&l.jsx("img",{src:y,alt:s.name||"Logo",className:"w-5 h-5 rounded-full"}),l.jsx("span",{className:"font-medium",children:s.name})]}),l.jsx("span",{className:"text-xs text-gray-500 mt-1",children:"Tap again for details"})]})})}):null},`${s.id}-${s.coreLocked}-${s.appearanceLocked}-${s.contentLocked}-${s.adminLocked}`)})})}function Ke({isAdminView:e,mapInstance:t,updateMarker:n}){const{t:o}=ue(),[i,c]=x.useState(!1),[r,u]=x.useState(!1),[d,a]=x.useState(""),[s,g]=x.useState(""),h=()=>{u(!0),a(""),g("")},b=async()=>{if(!d||isNaN(Number(d))){g("Please enter a valid numeric ID.");return}if(await w(d)){g("ID already exists. Please choose another.");return}u(!1),c(!0),g("")},y=()=>{u(!1),a(""),g("")};x.useEffect(()=>{if(!i||!t||!d)return;const m=S=>{const C=S.latlng,f={...Je({lat:C.lat,lng:C.lng}),id:Number(d)};typeof n=="function"&&n(f.id,f,{add:!0}),c(!1),a(""),t.off("click",m)};return t.on("click",m),()=>{t.off("click",m)}},[i,t,n,d]);async function w(m){try{const{supabase:S}=await Oe(async()=>{const{supabase:f}=await import("./index-D7EvdnWU.js").then(v=>v.s);return{supabase:f}},__vite__mapDeps([0,1])),C=["Markers_Core","Markers_Appearance","Markers_Content","Markers_Admin"];for(const f of C){const{data:v,error:L}=await S.from(f).select("id").eq("id",Number(m));if(L)return!1;if(v&&v.length>0)return!0}return!1}catch{return!1}}return e?l.jsxs(l.Fragment,{children:[l.jsxs("button",{onClick:h,"aria-label":"Add marker",className:"bg-white rounded-full shadow p-2 flex items-center justify-center",style:{position:"absolute",left:10,top:60,zIndex:1001,width:44,height:44,border:"none",cursor:i?"crosshair":"pointer",background:i?"#e3f2fd":"white"},title:i?"Click on map to place marker":"Add marker",children:[l.jsx(Ie.Icon,{path:ze,size:1.5,color:"#1976d2","aria-hidden":"true",style:{width:"42px",height:"42px"}}),l.jsx("span",{className:"sr-only",children:"Add marker"})]}),r&&l.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0,0,0,0.3)",zIndex:2e3,display:"flex",alignItems:"center",justifyContent:"center"},children:l.jsxs("div",{style:{background:"white",borderRadius:8,boxShadow:"0 2px 16px rgba(25,118,210,0.15)",padding:32,minWidth:320,display:"flex",flexDirection:"column",alignItems:"center"},children:[l.jsx("h2",{style:{color:"#1976d2",fontWeight:700,marginBottom:16},children:"Enter Marker ID"}),l.jsx("input",{type:"number",value:d,onChange:m=>a(m.target.value),style:{fontSize:18,padding:"8px 12px",border:"2px solid #1976d2",borderRadius:4,marginBottom:12,width:"100%"},placeholder:"Marker ID (integer)",min:1}),s&&l.jsx("div",{style:{color:"red",marginBottom:8},children:s}),l.jsxs("div",{style:{display:"flex",gap:12},children:[l.jsx("button",{onClick:b,style:{background:"#1976d2",color:"white",border:"none",borderRadius:4,padding:"8px 20px",fontWeight:600,cursor:"pointer"},children:"Confirm"}),l.jsx("button",{onClick:y,style:{background:"#eee",color:"#1976d2",border:"none",borderRadius:4,padding:"8px 20px",fontWeight:600,cursor:"pointer"},children:"Cancel"})]})]})})]}):null}function Je({lat:e,lng:t}){return{id:null,lat:e,lng:t,name:"",label:"",logo:"",boothNumber:"",coreLocked:!1}}function Qe(e){return e.getChildCount(),J({iconUrl:"/Map/assets/icons/glyph-marker-icon-orange.svg",iconSize:[50,82],glyph:`<div style='display:flex;align-items:center;justify-content:center;width:100%;height:100%;'>
  <img src='/Map/assets/logos/4x4Vakantiebeurs.png' alt='logo' style='width:40px;height:40px;object-fit:contain;display:block;margin:auto;position:relative;left:1px;top:10px;' />
      </div>`,glyphColor:"white",glyphSize:"40px",className:"custom-cluster-icon"})}var ge={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},ie=E.createContext&&E.createContext(ge),et=["attr","size","title"];function tt(e,t){if(e==null)return{};var n=nt(e,t),o,i;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(i=0;i<c.length;i++)o=c[i],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}function nt(e,t){if(e==null)return{};var n={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;n[o]=e[o]}return n}function W(){return W=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},W.apply(this,arguments)}function re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,o)}return n}function G(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?re(Object(n),!0).forEach(function(o){ot(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):re(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function ot(e,t,n){return t=at(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function at(e){var t=it(e,"string");return typeof t=="symbol"?t:t+""}function it(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pe(e){return e&&e.map((t,n)=>E.createElement(t.tag,G({key:n},t.attr),pe(t.child)))}function Q(e){return t=>E.createElement(rt,W({attr:G({},e.attr)},t),pe(e.child))}function rt(e){var t=n=>{var{attr:o,size:i,title:c}=e,r=tt(e,et),u=i||n.size||"1em",d;return n.className&&(d=n.className),e.className&&(d=(d?d+" ":"")+e.className),E.createElement("svg",W({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,o,r,{className:d,style:G(G({color:e.color||n.color},n.style),e.style),height:u,width:u,xmlns:"http://www.w3.org/2000/svg"}),c&&E.createElement("title",null,c),e.children)};return ie!==void 0?E.createElement(ie.Consumer,null,n=>t(n)):t(ge)}function st(e){return Q({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"},child:[]}]})(e)}function lt(e){return Q({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"},child:[]}]})(e)}function ct(e){return Q({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M19 13H5v-2h14v2z"},child:[]}]})(e)}function dt(e){return e.angle||0}function A(e,t,n){const o=n*Math.PI/180,i=e*Math.cos(o)-t*Math.sin(o),c=e*Math.sin(o)+t*Math.cos(o);return[i,c]}function R(e){return e/111320}function k(e,t){return e/(40075e3*Math.cos(t*Math.PI/180)/360)}function ut(e){return e*111320}function ft(e,t){return e*(40075e3*Math.cos(t*Math.PI/180)/360)}function ht({mapInstance:e,markers:t,rectangleSize:n,isAdminView:o,showRectanglesAndHandles:i,updateMarker:c,rectangleLayerRef:r}){if(!e)return;r.current||(r.current=M.layerGroup(),r.current.addTo(e));const u=r.current;u._markerLayers||(u._markerLayers={}),Object.keys(u._markerLayers).forEach(d=>{t.find(a=>a.id===d)||(u.removeLayer(u._markerLayers[d].rectangle),u.removeLayer(u._markerLayers[d].handle),delete u._markerLayers[d])}),t.forEach(d=>{if(d.lat&&d.lng){const a=M.latLng(d.lat,d.lng),s=Array.isArray(d.rectangle)&&d.rectangle.length===2?d.rectangle:n,g=Number(s[0])/2,h=Number(s[1])/2,b=dt(d),y="#1976d2",w=[A(-g,-h,b),A(g,-h,b),A(g,h,b),A(-g,h,b)],m=w.map(([f,v])=>M.latLng(a.lat+R(v),a.lng+k(f,a.lat)));let S,C;if(u._markerLayers[d.id]){S=u._markerLayers[d.id].rectangle,S.setLatLngs(m),C=u._markerLayers[d.id].handle;const[f,v]=w[2],L=M.latLng(a.lat+R(v),a.lng+k(f,a.lat));C.setLatLng(L)}else{S=M.polygon(m,{color:y,weight:1});const[f,v]=w[2],L=M.latLng(a.lat+R(v),a.lng+k(f,a.lat));let N;if(o&&!d.coreLocked){const z=M.divIcon({className:"rotation-handle-icon",html:'<div style="width:8px;height:8px;background:#1976d2;border-radius:50%;"></div>',iconSize:[8,8],iconAnchor:[4,4]});N=M.marker(L,{icon:z,draggable:!0,interactive:!0,keyboard:!0,title:"Drag to rotate"}),N.on("dragstart",function(){e&&e.dragging.disable()});let I=b;N.on("drag",function(D){const H=D.target.getLatLng(),F=ft(H.lng-a.lng,a.lat),Z=ut(H.lat-a.lat);let P=Math.atan2(Z,F)*180/Math.PI;P<0&&(P+=360),I=P;const $=[A(-g,-h,I),A(g,-h,I),A(g,h,I),A(-g,h,I)],p=$.map(([ye,me])=>M.latLng(a.lat+R(me),a.lng+k(ye,a.lat)));S.setLatLngs(p);const[j,O]=$[2],_=M.latLng(a.lat+R(O),a.lng+k(j,a.lat));N.setLatLng(_)}),N.on("dragend",function(){e&&e.dragging.enable(),c(d.id,{angle:I})})}else{const z=M.divIcon({className:"rotation-handle-icon",html:'<div style="width:8px;height:8px;background:#1976d2;border-radius:50%;opacity:0.5;"></div>',iconSize:[8,8],iconAnchor:[4,4]});N=M.marker(L,{icon:z,draggable:!1,interactive:!1,keyboard:!1,title:"Locked"})}u.addLayer(S),u.addLayer(N),u._markerLayers[d.id]={rectangle:S,handle:N}}}}),Object.values(u._markerLayers).forEach(({rectangle:d,handle:a})=>{i?(u.addLayer(d),u.addLayer(a)):(u.removeLayer(d),u.removeLayer(a))})}function gt(e){e&&e.zoomIn()}function pt(e){e&&e.zoomOut()}function yt(e,t,n){e&&e.setView(t,n)}function se(e,t){console.log("Analytics event:",e,t)}function mt(){const e=x.useCallback(n=>{se("marker_view",{markerId:n,timestamp:Date.now()})},[]),t=x.useCallback(n=>{se("map_interaction",{type:n,timestamp:Date.now()})},[]);return{trackMarkerView:e,trackMapInteraction:t}}const xt={appearance:"none",WebkitAppearance:"none",MozAppearance:"none",outline:"none",background:"#fff",border:"2px solid #1976d2",borderRadius:4,width:18,height:18,display:"inline-block",position:"relative",marginRight:8,cursor:"pointer",verticalAlign:"middle"},U=[{key:"carto",name:"Carto Voyager",attribution:'&copy; <a href="https://carto.com/attributions">Carto</a>',url:"https://cartodb-basemaps-{s}.global.ssl.fastly.net/rastertiles/voyager_nolabels/{z}/{x}/{y}.png"},{key:"esri",name:"Esri World Imagery",attribution:"Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community",url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}"}];function vt({isAdminView:e,markersState:t,updateMarker:n}){const[o,i]=x.useState({}),c=typeof window<"u"&&/Mobi|Android|iPhone|iPad|iPod|Opera Mini|IEMobile|WPDesktop/i.test(window.navigator.userAgent),r=E.useRef(null),{t:u}=ue(),[d,a]=x.useState(!1),[s,g]=x.useState(U[0].key),[h,b]=x.useState(!1),[y,w]=x.useState(null),[m,S]=x.useState(null),C=[51.898095078807025,5.772961378097534],f=17;mt();const v=E.useMemo(()=>Array.isArray(t)?t:[],[t]),L=[6,6],N=E.useRef(null);E.useEffect(()=>{v.forEach(p=>{if(p.logo){const j=new window.Image;j.src=K(p.logo)}})},[v]);function z(p){return e&&p&&p.coreLocked===!1}x.useEffect(()=>{ht({mapInstance:y,markers:v,rectangleSize:L,isAdminView:e,showRectanglesAndHandles:h,updateMarker:n,rectangleLayerRef:N})},[y,t,L,e,h]),x.useEffect(()=>{if(!y)return;let p=m;p||(p=M.layerGroup(),S(p)),p.clearLayers(),v.forEach(j=>{if(j.lat&&j.lng){const O=[j.name,j.boothNumber,j.label].filter(Boolean).join(" | "),_=M.marker([j.lat,j.lng],{opacity:0,interactive:!1});_.feature={type:"Feature",properties:{searchText:O}},_.bindPopup(j.name||j.label||""),p.addLayer(_)}})},[y,v,m]),x.useEffect(()=>{if(y&&m){const p=new M.Control.Search({layer:m,propertyName:"searchText",initial:!1,zoom:21,marker:{icon:!1,animate:!0},textPlaceholder:"Search for name or booth...",position:"topleft"});if(y.addControl(p),r.current=p,!y._minimapControl){const j=M.tileLayer(U[0].url,{attribution:"",minZoom:0,maxZoom:16}),O=new M.Control.MiniMap(j,{position:"bottomright",width:120,height:120,zoomLevelFixed:15,toggleDisplay:!0,centerFixed:C,aimingRectOptions:{color:"#1976d2",weight:2,opacity:.9,fillOpacity:.1,fill:!0},shadowRectOptions:{color:"#90caf9",weight:1,opacity:.5,fillOpacity:.05,fill:!0},strings:{hideText:"Hide MiniMap",showText:"Show MiniMap"}});O.addTo(y),y._minimapControl=O}return p.on("search:locationfound",function(j){if(j&&j.layer&&j.layer.getLatLng){const O=j.layer.getLatLng();y.flyTo(O,21,{animate:!0}),p._input&&p._input.blur(),p.hideAlert&&p.hideAlert(),p.collapse&&p.collapse()}}),()=>{y.removeControl(p),r.current=null}}},[y,m]);const I=C,D=f,H=14,F=22,Z=p=>{p&&p.target?w(p.target):w(p)},ee=()=>gt(y),P=()=>pt(y),$=()=>yt(y,I,D);return l.jsxs("div",{style:{height:"100svh",height:"100dvh",height:"100vh",width:"100vw",position:"fixed",inset:0,zIndex:0,touchAction:"pan-x pan-y",overflow:"hidden"},tabIndex:0,"aria-label":"Event Map",role:"region",children:[l.jsxs("div",{style:{position:"absolute",top:10,right:10,zIndex:1e3,display:"flex",flexDirection:"column",gap:"10px"},children:[l.jsxs("button",{onClick:$,"aria-label":"Home",className:"bg-white rounded-full shadow p-2 flex items-center justify-center",style:{width:44,height:44},children:[l.jsx(st,{size:28,color:"#1976d2","aria-hidden":"true"}),l.jsx("span",{className:"sr-only",children:"Home"})]}),l.jsxs("button",{onClick:ee,"aria-label":"Zoom in",className:"bg-white rounded-full shadow p-2 mb-2 flex items-center justify-center",style:{width:44,height:44},children:[l.jsx(lt,{size:28,color:"#1976d2","aria-hidden":"true"}),l.jsx("span",{className:"sr-only",children:"Zoom in"})]}),l.jsxs("button",{onClick:P,"aria-label":"Zoom out",className:"bg-white rounded-full shadow p-2 mb-2 flex items-center justify-center",style:{width:44,height:44},children:[l.jsx(ct,{size:28,color:"#1976d2","aria-hidden":"true"}),l.jsx("span",{className:"sr-only",children:"Zoom out"})]}),e&&l.jsxs("div",{style:{position:"relative"},children:[l.jsxs("button",{"aria-label":"Map layers",className:"bg-white rounded-full shadow p-2 flex items-center justify-center mt-0 hover:bg-gray-100 focus:outline-none",style:{width:44,height:44},onClick:()=>a(p=>!p),children:[l.jsx(Ae,{path:Te,size:1.2,color:"#1976d2"}),l.jsx("span",{className:"sr-only",children:"Map layers"})]}),d&&l.jsxs("div",{className:"absolute right-0 mt-2 bg-white rounded shadow-lg border z-50",style:{minWidth:200,padding:8,color:"#1976d2"},role:"menu","aria-label":"Layer selection",children:[l.jsx("div",{className:"font-semibold mb-2",children:"Base Layers"}),U.map(p=>l.jsx("button",{className:`w-full text-left px-2 py-1 rounded hover:bg-blue-50 ${s===p.key?"bg-blue-50 font-bold":""}`,onClick:()=>g(p.key),role:"menuitem",style:{color:"#1976d2"},children:p.name},p.key)),l.jsx("div",{className:"font-semibold mt-4 mb-2",children:"Map Features"}),l.jsxs("label",{className:"flex items-center px-2 py-1 cursor-pointer hover:bg-blue-50 rounded",style:{color:"#1976d2"},children:[l.jsx("input",{type:"checkbox",checked:h,onChange:p=>b(p.target.checked),style:xt}),l.jsx("span",{style:{position:"relative",left:-26,width:18,height:18,pointerEvents:"none",display:h?"inline-block":"none"},children:l.jsx("svg",{width:"18",height:"18",viewBox:"0 0 18 18",style:{position:"absolute",top:0,left:0},children:l.jsx("polyline",{points:"4,9 8,13 14,5",stroke:"#1976d2",strokeWidth:"2.5",fill:"none"})})}),l.jsx("span",{style:{marginLeft:h?-8:0},children:"Booth Surface"})]})]})]})]}),e&&l.jsx(Ke,{isAdminView:e,mapInstance:y,updateMarker:n}),l.jsx("div",{id:"map-container",className:"fixed inset-0 w-full h-full",style:{zIndex:1,height:"100svh",height:"100dvh",height:"100vh",touchAction:"pan-x pan-y",overflow:"hidden"},"aria-label":u("map.ariaLabel"),children:l.jsxs(qe,{center:I,zoom:D,minZoom:H,maxZoom:F,zoomDelta:.5,zoomSnap:.5,zoomControl:!1,style:{width:"100vw",height:"100vh"},className:"focus:outline-none focus:ring-2 focus:ring-primary",whenReady:Z,attributionControl:!1,children:[U.filter(p=>p.key===s).map(p=>l.jsx(Xe,{attribution:p.attribution,url:p.url,maxZoom:22},p.key)),l.jsx(Ve,{safeMarkers:v,infoButtonToggled:o,setInfoButtonToggled:i,isMobile:c,updateMarker:n,isMarkerDraggable:z,iconCreateFunction:Qe}),l.jsx(Ye,{safeMarkers:v,infoButtonToggled:o,setInfoButtonToggled:i,isMobile:c,updateMarker:n,isMarkerDraggable:z})]})})]})}export{vt as default};
