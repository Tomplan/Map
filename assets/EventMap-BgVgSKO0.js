const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CucxoVOY.js","assets/index-BJ0U4iBb.css"])))=>i.map(i=>d[i]);
import{r as m,a as xe,g as be,b as ve,l as F,c as we,R as I,L as Le,d as Se,e as V,f as je,h as Me,w as Ce,i as Ee,j as M,k as c,m as le,n as K,M as Ie,I as Ne,o as ze,_ as Oe,p as Ae,q as Pe}from"./index-CucxoVOY.js";const _e=(e,t,n,a)=>{const r=[n,{code:t,...a||{}}];if(e?.services?.logger?.forward)return e.services.logger.forward(r,"warn","react-i18next::",!0);P(r[0])&&(r[0]=`react-i18next:: ${r[0]}`),e?.services?.logger?.warn?e.services.logger.warn(...r):console?.warn&&console.warn(...r)},te={},ce=(e,t,n,a)=>{P(n)&&te[n]||(P(n)&&(te[n]=new Date),_e(e,t,n,a))},de=(e,t)=>()=>{if(e.isInitialized)t();else{const n=()=>{setTimeout(()=>{e.off("initialized",n)},0),t()};e.on("initialized",n)}},Y=(e,t,n)=>{e.loadNamespaces(t,de(e,n))},ne=(e,t,n,a)=>{if(P(n)&&(n=[n]),e.options.preload&&e.options.preload.indexOf(t)>-1)return Y(e,n,a);n.forEach(r=>{e.options.ns.indexOf(r)<0&&e.options.ns.push(r)}),e.loadLanguages(t,de(e,a))},Te=(e,t,n={})=>!t.languages||!t.languages.length?(ce(t,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:t.languages}),!0):t.hasLoadedNamespace(e,{lng:n.lng,precheck:(a,r)=>{if(n.bindI18n&&n.bindI18n.indexOf("languageChanging")>-1&&a.services.backendConnector.backend&&a.isLanguageChangingTo&&!r(a.isLanguageChangingTo,e))return!1}}),P=e=>typeof e=="string",Re=e=>typeof e=="object"&&e!==null,ke=m.createContext();class $e{constructor(){this.usedNamespaces={}}addUsedNamespaces(t){t.forEach(n=>{this.usedNamespaces[n]||(this.usedNamespaces[n]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}var q={exports:{}},X={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oe;function De(){if(oe)return X;oe=1;var e=xe();function t(u,h){return u===h&&(u!==0||1/u===1/h)||u!==u&&h!==h}var n=typeof Object.is=="function"?Object.is:t,a=e.useState,r=e.useEffect,l=e.useLayoutEffect,s=e.useDebugValue;function d(u,h){var x=h(),y=a({inst:{value:x,getSnapshot:h}}),w=y[0].inst,p=y[1];return l(function(){w.value=x,w.getSnapshot=h,o(w)&&p({inst:w})},[u,x,h]),r(function(){return o(w)&&p({inst:w}),u(function(){o(w)&&p({inst:w})})},[u]),s(x),x}function o(u){var h=u.getSnapshot;u=u.value;try{var x=h();return!n(u,x)}catch{return!0}}function i(u,h){return h()}var v=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?i:d;return X.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:v,X}var ae;function He(){return ae||(ae=1,q.exports=De()),q.exports}var Ue=He();const We=(e,t)=>P(t)?t:Re(t)&&P(t.defaultValue)?t.defaultValue:Array.isArray(e)?e[e.length-1]:e,Ge={t:We,ready:!1},Fe=()=>()=>{},ue=(e,t={})=>{const{i18n:n}=t,{i18n:a,defaultNS:r}=m.useContext(ke)||{},l=n||a||be();l&&!l.reportNamespaces&&(l.reportNamespaces=new $e),l||ce(l,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const s=m.useMemo(()=>({...ve(),...l?.options?.react,...t}),[l,t]),{useSuspense:d,keyPrefix:o}=s,i=m.useMemo(()=>{const g=r||l?.options?.defaultNS;return P(g)?[g]:g||["translation"]},[e,r,l]);l?.reportNamespaces?.addUsedNamespaces?.(i);const v=m.useCallback(g=>{if(!l)return Fe;const{bindI18n:b,bindI18nStore:S}=s;return b&&l.on(b,g),S&&l.store.on(S,g),()=>{b&&b.split(" ").forEach(E=>l.off(E,g)),S&&S.split(" ").forEach(E=>l.store.off(E,g))}},[l,s]),u=m.useRef(),h=m.useCallback(()=>{if(!l)return Ge;const g=!!(l.isInitialized||l.initializedStoreOnce)&&i.every(z=>Te(z,l,s)),b=l.getFixedT(t.lng||l.language,s.nsMode==="fallback"?i:i[0],o),S=u.current;if(S&&S.ready===g&&S.lng===(t.lng||l.language)&&S.keyPrefix===o)return S;const E={t:b,ready:g,lng:t.lng||l.language,keyPrefix:o};return u.current=E,E},[l,i,o,s,t.lng]),[x,y]=m.useState(0),{t:w,ready:p}=Ue.useSyncExternalStore(v,h,h);m.useEffect(()=>{if(l&&!p&&!d){const g=()=>y(b=>b+1);t.lng?ne(l,t.lng,i,g):Y(l,i,g)}},[l,t.lng,i,p,d,x]);const L=l||{},C=m.useMemo(()=>{const g=[w,L,p];return g.t=w,g.i18n=L,g.ready=p,g},[w,L,p]);if(l&&d&&!p)throw new Promise(g=>{const b=()=>g();t.lng?ne(l,t.lng,i,b):Y(l,i,b)});return C};function Ze(e,t,n){const{opacity:a,zIndex:r}=t;a!=null&&a!==n.opacity&&e.setOpacity(a),r!=null&&r!==n.zIndex&&e.setZIndex(r)}function Be({bounds:e,boundsOptions:t,center:n,children:a,className:r,id:l,placeholder:s,style:d,whenReady:o,zoom:i,...v},u){const[h]=m.useState({className:r,id:l,style:d}),[x,y]=m.useState(null),w=m.useRef(void 0);m.useImperativeHandle(u,()=>x?.map??null,[x]);const p=m.useCallback(C=>{if(C!==null&&!w.current){const g=new F.Map(C,v);w.current=g,n!=null&&i!=null?g.setView(n,i):e!=null&&g.fitBounds(e,t),o!=null&&g.whenReady(o),y(we(g))}},[]);m.useEffect(()=>()=>{x?.map.remove()},[x]);const L=x?I.createElement(Le,{value:x},a):s??null;return I.createElement("div",{...h,ref:p},L)}const qe=m.forwardRef(Be),fe=Se(function({position:t,...n},a){const r=new F.Marker(t,n);return V(r,je(a,{overlayContainer:r}))},function(t,n,a){n.position!==a.position&&t.setLatLng(n.position),n.icon!=null&&n.icon!==a.icon&&t.setIcon(n.icon),n.zIndexOffset!=null&&n.zIndexOffset!==a.zIndexOffset&&t.setZIndexOffset(n.zIndexOffset),n.opacity!=null&&n.opacity!==a.opacity&&t.setOpacity(n.opacity),t.dragging!=null&&n.draggable!==a.draggable&&(n.draggable===!0?t.dragging.enable():t.dragging.disable())}),Xe=Me(function({url:t,...n},a){const r=new F.TileLayer(t,Ce(n,a));return V(r,a)},function(t,n,a){Ze(t,n,a);const{url:r}=n;r!=null&&r!==a.url&&t.setUrl(r)}),he=Ee(function(t,n){const a=new F.Tooltip(t,n.overlayContainer);return V(a,n)},function(t,n,{position:a},r){m.useEffect(function(){const s=n.overlayContainer;if(s==null)return;const{instance:d}=t,o=v=>{v.tooltip===d&&(a!=null&&d.setLatLng(a),d.update(),r(!0))},i=v=>{v.tooltip===d&&r(!1)};return s.on({tooltipopen:o,tooltipclose:i}),s.bindTooltip(d),function(){s.off({tooltipopen:o,tooltipclose:i}),s._map!=null&&s.unbindTooltip()}},[t,n,r,a])});function J({glyph:e,glyphColor:t="white",bgColor:n="white",glyphSize:a="8px",iconUrl:r="/Map/assets/icons/glyph-marker-icon-blue.svg",className:l,iconSize:s,prefix:d,glyphAnchor:o}){let i=a;typeof i=="number"?i=`${i}px`:typeof i=="string"&&!i.endsWith("px")?i=`${i}px`:i||(i="8px");const v=s||[25,41],u=Math.round(v[0]*(41/25)),h=Math.round(v[1]*(41/41)),x=Math.round(u*12/41),y=h;return M.icon.glyph({iconUrl:r||"/Map/assets/icons/glyph-marker-icon-blue.svg",iconSize:v,iconAnchor:[Math.round(v[0]/2),v[1]],popupAnchor:[1,-34],tooltipAnchor:[0,0],shadowUrl:"/Map/assets/icons/marker-shadow.png",shadowSize:[u,h],shadowAnchor:[x,y],prefix:d||"",glyph:e||"",glyphColor:t||"white",bgColor:n,glyphSize:i,glyphAnchor:o||[0,0],className:l||""})}function Ye({safeMarkers:e,infoButtonToggled:t,setInfoButtonToggled:n,isMobile:a,updateMarker:r,isMarkerDraggable:l}){return c.jsx(c.Fragment,{children:e.filter(s=>s.id>=1001).map(s=>{const d=t[s.id];let o=[s.lat,s.lng],i=s.iconUrl;i||(i=`${s.type||"glyph-marker-icon-blue"}.svg`),i=le(i);const v=J({className:s.type?`marker-icon marker-type-${s.type}`:"marker-icon",prefix:s.prefix,iconUrl:i,iconSize:Array.isArray(s.iconSize)?s.iconSize:[17,28],glyph:s.glyph||"?",glyphColor:s.glyphColor||"white",glyphSize:s.glyphSize||"12px",glyphAnchor:s.glyphAnchor||[0,-5]}),u=s.logo?K(s.logo):null,h=l(s),x={...h?{dragend:y=>{const{lat:w,lng:p}=y.target.getLatLng();r(s.id,{lat:w,lng:p})}}:{}};return c.jsx(fe,{position:o,icon:v,draggable:h,eventHandlers:x,children:c.jsx(he,{direction:"top",offset:[0,-32],opacity:1,permanent:!1,interactive:!0,children:c.jsxs("div",{className:"flex flex-col items-center",children:[u&&c.jsx("img",{src:u,alt:s.name||"Logo",style:{maxWidth:120,maxHeight:80,objectFit:"contain",borderRadius:0}}),c.jsx("span",{style:{fontWeight:600,color:"#1976d2"},children:s.name}),a&&c.jsx("button",{className:`mt-2 px-2 py-1 text-xs rounded ${d?"bg-green-500 text-white":"bg-blue-500 text-white"}`,onClick:()=>{n(y=>({...y,[s.id]:!y[s.id]}))},children:"More info"})]})})},`${s.id}-${s.coreLocked}-${s.appearanceLocked}-${s.contentLocked}-${s.adminLocked}`)})})}function Ve({safeMarkers:e,infoButtonToggled:t,setInfoButtonToggled:n,isMobile:a,updateMarker:r,isMarkerDraggable:l,iconCreateFunction:s}){const d=I.useRef({});return c.jsx(Ie,{chunkedLoading:!0,showCoverageOnHover:!0,spiderfyOnMaxZoom:!1,removeOutsideVisibleBounds:!0,disableClusteringAtZoom:18,maxClusterRadius:400,iconCreateFunction:s,children:e.filter(o=>o.id<1001).map(o=>{const i=t[o.id];let v=[o.lat,o.lng],u=o.iconUrl;u||(u=`${o.type||"default"}.svg`),u=le(u);const h=J({className:o.type?`marker-icon marker-type-${o.type}`:"marker-icon",prefix:o.prefix,iconUrl:u,iconSize:Array.isArray(o.iconSize)?o.iconSize:[15,25],glyph:o.glyph||"",glyphColor:o.glyphColor||"white",glyphSize:o.glyphSize||"9px",glyphAnchor:o.glyphAnchor||[0,-4]}),x=o.logo?K(o.logo):null,y=l(o),w={...y?{dragend:p=>{const{lat:L,lng:C}=p.target.getLatLng();r(o.id,{lat:L,lng:C})}}:{}};return d.current[o.id]||(d.current[o.id]=I.createRef()),c.jsx(fe,{position:v,icon:h,draggable:y,eventHandlers:w,ref:d.current[o.id],children:c.jsx(he,{direction:"top",offset:[0,-32],opacity:1,permanent:!1,interactive:!0,children:c.jsxs("div",{className:"flex flex-col items-center",children:[x&&c.jsx("img",{src:x,alt:o.name||"Logo",style:{maxWidth:120,maxHeight:80,objectFit:"contain",borderRadius:0}}),c.jsx("span",{style:{fontWeight:600,color:"#1976d2"},children:o.name}),a&&c.jsx("button",{className:`mt-2 px-2 py-1 text-xs rounded ${i?"bg-green-500 text-white":"bg-blue-500 text-white"}`,onClick:()=>{n(p=>({...p,[o.id]:!p[o.id]})),setTimeout(()=>{const p=d.current[o.id]?.current;p&&p.openPopup&&p.openPopup()},0)},children:"More info"})]})})},`${o.id}-${o.coreLocked}-${o.appearanceLocked}-${o.contentLocked}-${o.adminLocked}`)})})}function Ke({isAdminView:e,mapInstance:t,updateMarker:n}){const{t:a}=ue(),[r,l]=m.useState(!1),[s,d]=m.useState(!1),[o,i]=m.useState(""),[v,u]=m.useState(""),h=()=>{d(!0),i(""),u("")},x=async()=>{if(!o||isNaN(Number(o))){u("Please enter a valid numeric ID.");return}if(await w(o)){u("ID already exists. Please choose another.");return}d(!1),l(!0),u("")},y=()=>{d(!1),i(""),u("")};m.useEffect(()=>{if(!r||!t||!o)return;const p=L=>{const C=L.latlng,g={...Je({lat:C.lat,lng:C.lng}),id:Number(o)};typeof n=="function"&&n(g.id,g,{add:!0}),l(!1),i(""),t.off("click",p)};return t.on("click",p),()=>{t.off("click",p)}},[r,t,n,o]);async function w(p){try{const{supabase:L}=await Oe(async()=>{const{supabase:g}=await import("./index-CucxoVOY.js").then(b=>b.s);return{supabase:g}},__vite__mapDeps([0,1])),C=["Markers_Core","Markers_Appearance","Markers_Content","Markers_Admin"];for(const g of C){const{data:b,error:S}=await L.from(g).select("id").eq("id",Number(p));if(S)return!1;if(b&&b.length>0)return!0}return!1}catch{return!1}}return e?c.jsxs(c.Fragment,{children:[c.jsxs("button",{onClick:h,"aria-label":"Add marker",className:"bg-white rounded-full shadow p-2 flex items-center justify-center",style:{position:"absolute",left:10,top:60,zIndex:1001,width:44,height:44,border:"none",cursor:r?"crosshair":"pointer",background:r?"#e3f2fd":"white"},title:r?"Click on map to place marker":"Add marker",children:[c.jsx(Ne.Icon,{path:ze,size:1.5,color:"#1976d2","aria-hidden":"true",style:{width:"42px",height:"42px"}}),c.jsx("span",{className:"sr-only",children:"Add marker"})]}),s&&c.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0,0,0,0.3)",zIndex:2e3,display:"flex",alignItems:"center",justifyContent:"center"},children:c.jsxs("div",{style:{background:"white",borderRadius:8,boxShadow:"0 2px 16px rgba(25,118,210,0.15)",padding:32,minWidth:320,display:"flex",flexDirection:"column",alignItems:"center"},children:[c.jsx("h2",{style:{color:"#1976d2",fontWeight:700,marginBottom:16},children:"Enter Marker ID"}),c.jsx("input",{type:"number",value:o,onChange:p=>i(p.target.value),style:{fontSize:18,padding:"8px 12px",border:"2px solid #1976d2",borderRadius:4,marginBottom:12,width:"100%"},placeholder:"Marker ID (integer)",min:1}),v&&c.jsx("div",{style:{color:"red",marginBottom:8},children:v}),c.jsxs("div",{style:{display:"flex",gap:12},children:[c.jsx("button",{onClick:x,style:{background:"#1976d2",color:"white",border:"none",borderRadius:4,padding:"8px 20px",fontWeight:600,cursor:"pointer"},children:"Confirm"}),c.jsx("button",{onClick:y,style:{background:"#eee",color:"#1976d2",border:"none",borderRadius:4,padding:"8px 20px",fontWeight:600,cursor:"pointer"},children:"Cancel"})]})]})})]}):null}function Je({lat:e,lng:t}){return{id:null,lat:e,lng:t,name:"",label:"",logo:"",boothNumber:"",coreLocked:!1}}function Qe(e){return e.getChildCount(),J({iconUrl:"/Map/assets/icons/glyph-marker-icon-orange.svg",iconSize:[50,82],glyph:`<div style='display:flex;align-items:center;justify-content:center;width:100%;height:100%;'>
  <img src='/Map/assets/logos/4x4Vakantiebeurs.png' alt='logo' style='width:40px;height:40px;object-fit:contain;display:block;margin:auto;position:relative;left:1px;top:10px;' />
      </div>`,glyphColor:"white",glyphSize:"40px",className:"custom-cluster-icon"})}var ge={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},ie=I.createContext&&I.createContext(ge),et=["attr","size","title"];function tt(e,t){if(e==null)return{};var n=nt(e,t),a,r;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)a=l[r],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function nt(e,t){if(e==null)return{};var n={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;n[a]=e[a]}return n}function W(){return W=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},W.apply(this,arguments)}function re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,a)}return n}function G(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?re(Object(n),!0).forEach(function(a){ot(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):re(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function ot(e,t,n){return t=at(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function at(e){var t=it(e,"string");return typeof t=="symbol"?t:t+""}function it(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pe(e){return e&&e.map((t,n)=>I.createElement(t.tag,G({key:n},t.attr),pe(t.child)))}function Q(e){return t=>I.createElement(rt,W({attr:G({},e.attr)},t),pe(e.child))}function rt(e){var t=n=>{var{attr:a,size:r,title:l}=e,s=tt(e,et),d=r||n.size||"1em",o;return n.className&&(o=n.className),e.className&&(o=(o?o+" ":"")+e.className),I.createElement("svg",W({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,a,s,{className:o,style:G(G({color:e.color||n.color},n.style),e.style),height:d,width:d,xmlns:"http://www.w3.org/2000/svg"}),l&&I.createElement("title",null,l),e.children)};return ie!==void 0?I.createElement(ie.Consumer,null,n=>t(n)):t(ge)}function st(e){return Q({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"},child:[]}]})(e)}function lt(e){return Q({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"},child:[]}]})(e)}function ct(e){return Q({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M19 13H5v-2h14v2z"},child:[]}]})(e)}function dt(e){return e.angle||0}function A(e,t,n){const a=n*Math.PI/180,r=e*Math.cos(a)-t*Math.sin(a),l=e*Math.sin(a)+t*Math.cos(a);return[r,l]}function R(e){return e/111320}function k(e,t){return e/(40075e3*Math.cos(t*Math.PI/180)/360)}function ut(e){return e*111320}function ft(e,t){return e*(40075e3*Math.cos(t*Math.PI/180)/360)}function ht({mapInstance:e,markers:t,rectangleSize:n,isAdminView:a,showRectanglesAndHandles:r,updateMarker:l,rectangleLayerRef:s}){if(!e)return;s.current||(s.current=M.layerGroup(),s.current.addTo(e));const d=s.current;d._markerLayers||(d._markerLayers={}),Object.keys(d._markerLayers).forEach(o=>{t.find(i=>i.id===o)||(d.removeLayer(d._markerLayers[o].rectangle),d.removeLayer(d._markerLayers[o].handle),delete d._markerLayers[o])}),t.forEach(o=>{if(o.lat&&o.lng){const i=M.latLng(o.lat,o.lng),v=Array.isArray(o.rectangle)&&o.rectangle.length===2?o.rectangle:n,u=Number(v[0])/2,h=Number(v[1])/2,x=dt(o),y="#1976d2",w=[A(-u,-h,x),A(u,-h,x),A(u,h,x),A(-u,h,x)],p=w.map(([g,b])=>M.latLng(i.lat+R(b),i.lng+k(g,i.lat)));let L,C;if(d._markerLayers[o.id]){L=d._markerLayers[o.id].rectangle,L.setLatLngs(p),C=d._markerLayers[o.id].handle;const[g,b]=w[2],S=M.latLng(i.lat+R(b),i.lng+k(g,i.lat));C.setLatLng(S)}else{L=M.polygon(p,{color:y,weight:1});const[g,b]=w[2],S=M.latLng(i.lat+R(b),i.lng+k(g,i.lat));let E;if(a&&!o.coreLocked){const z=M.divIcon({className:"rotation-handle-icon",html:'<div style="width:8px;height:8px;background:#1976d2;border-radius:50%;"></div>',iconSize:[8,8],iconAnchor:[4,4]});E=M.marker(S,{icon:z,draggable:!0,interactive:!0,keyboard:!0,title:"Drag to rotate"}),E.on("dragstart",function(){e&&e.dragging.disable()});let N=x;E.on("drag",function($){const D=$.target.getLatLng(),Z=ft(D.lng-i.lng,i.lat),B=ut(D.lat-i.lat);let _=Math.atan2(B,Z)*180/Math.PI;_<0&&(_+=360),N=_;const H=[A(-u,-h,N),A(u,-h,N),A(u,h,N),A(-u,h,N)],f=H.map(([ye,me])=>M.latLng(i.lat+R(me),i.lng+k(ye,i.lat)));L.setLatLngs(f);const[j,O]=H[2],T=M.latLng(i.lat+R(O),i.lng+k(j,i.lat));E.setLatLng(T)}),E.on("dragend",function(){e&&e.dragging.enable(),l(o.id,{angle:N})})}else{const z=M.divIcon({className:"rotation-handle-icon",html:'<div style="width:8px;height:8px;background:#1976d2;border-radius:50%;opacity:0.5;"></div>',iconSize:[8,8],iconAnchor:[4,4]});E=M.marker(S,{icon:z,draggable:!1,interactive:!1,keyboard:!1,title:"Locked"})}d.addLayer(L),d.addLayer(E),d._markerLayers[o.id]={rectangle:L,handle:E}}}}),Object.values(d._markerLayers).forEach(({rectangle:o,handle:i})=>{r?(d.addLayer(o),d.addLayer(i)):(d.removeLayer(o),d.removeLayer(i))})}function gt(e){e&&e.zoomIn()}function pt(e){e&&e.zoomOut()}function yt(e,t,n){e&&e.setView(t,n)}function se(e,t){console.log("Analytics event:",e,t)}function mt(){const e=m.useCallback(n=>{se("marker_view",{markerId:n,timestamp:Date.now()})},[]),t=m.useCallback(n=>{se("map_interaction",{type:n,timestamp:Date.now()})},[]);return{trackMarkerView:e,trackMapInteraction:t}}const xt={appearance:"none",WebkitAppearance:"none",MozAppearance:"none",outline:"none",background:"#fff",border:"2px solid #1976d2",borderRadius:4,width:18,height:18,display:"inline-block",position:"relative",marginRight:8,cursor:"pointer",verticalAlign:"middle"},U=[{key:"carto",name:"Carto Voyager",attribution:'&copy; <a href="https://carto.com/attributions">Carto</a>',url:"https://cartodb-basemaps-{s}.global.ssl.fastly.net/rastertiles/voyager_nolabels/{z}/{x}/{y}.png"},{key:"esri",name:"Esri World Imagery",attribution:"Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community",url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}"}];function vt({isAdminView:e,markersState:t,updateMarker:n}){const[a,r]=m.useState({}),l=typeof window<"u"&&/Mobi|Android|iPhone|iPad|iPod|Opera Mini|IEMobile|WPDesktop/i.test(window.navigator.userAgent),s=I.useRef(null),{t:d}=ue(),[o,i]=m.useState(!1),[v,u]=m.useState(U[0].key),[h,x]=m.useState(!1),[y,w]=m.useState(null),[p,L]=m.useState(null),C=[51.898095078807025,5.772961378097534],g=17;mt();const b=I.useMemo(()=>Array.isArray(t)?t:[],[t]),S=[6,6],E=I.useRef(null);I.useEffect(()=>{b.forEach(f=>{if(f.logo){const j=new window.Image;j.src=K(f.logo)}})},[b]);function z(f){return e&&f&&f.coreLocked===!1}m.useEffect(()=>{ht({mapInstance:y,markers:b,rectangleSize:S,isAdminView:e,showRectanglesAndHandles:h,updateMarker:n,rectangleLayerRef:E})},[y,t,S,e,h]),m.useEffect(()=>{if(!y)return;let f=p;f||(f=M.layerGroup(),L(f)),f.clearLayers(),b.forEach(j=>{if(j.lat&&j.lng){const O=[j.name,j.boothNumber,j.label].filter(Boolean).join(" | "),T=M.marker([j.lat,j.lng],{opacity:0,interactive:!1});T.feature={type:"Feature",properties:{searchText:O}},T.bindPopup(j.name||j.label||""),f.addLayer(T)}})},[y,b,p]),m.useEffect(()=>{if(y&&p){const f=new M.Control.Search({layer:p,propertyName:"searchText",initial:!1,zoom:21,marker:{icon:!1,animate:!0},textPlaceholder:"Search for name or booth...",position:"topleft"});if(y.addControl(f),s.current=f,!y._minimapControl){const j=M.tileLayer(U[0].url,{attribution:"",minZoom:0,maxZoom:16}),O=new M.Control.MiniMap(j,{position:"bottomright",width:120,height:120,zoomLevelFixed:15,toggleDisplay:!0,centerFixed:C,aimingRectOptions:{color:"#1976d2",weight:2,opacity:.9,fillOpacity:.1,fill:!0},shadowRectOptions:{color:"#90caf9",weight:1,opacity:.5,fillOpacity:.05,fill:!0},strings:{hideText:"Hide MiniMap",showText:"Show MiniMap"}});O.addTo(y),y._minimapControl=O}return f.on("search:locationfound",function(j){if(j&&j.layer&&j.layer.getLatLng){const O=j.layer.getLatLng();y.flyTo(O,21,{animate:!0}),f._input&&f._input.blur(),f.hideAlert&&f.hideAlert(),f.collapse&&f.collapse()}}),()=>{y.removeControl(f),s.current=null}}},[y,p]);const N=C,$=g,D=14,Z=22,B=f=>{f&&f.target?w(f.target):w(f)},ee=()=>gt(y),_=()=>pt(y),H=()=>yt(y,N,$);return c.jsxs("div",{style:{height:"100svh",height:"100dvh",height:"100vh",width:"100vw",position:"fixed",inset:0,zIndex:0,touchAction:"pan-x pan-y",overflow:"hidden"},tabIndex:0,"aria-label":"Event Map",role:"region",children:[c.jsxs("div",{style:{position:"absolute",top:10,right:10,zIndex:1e3,display:"flex",flexDirection:"column",gap:"10px"},children:[c.jsxs("button",{onClick:H,"aria-label":"Home",className:"bg-white rounded-full shadow p-2 flex items-center justify-center",style:{width:44,height:44},children:[c.jsx(st,{size:28,color:"#1976d2","aria-hidden":"true"}),c.jsx("span",{className:"sr-only",children:"Home"})]}),c.jsxs("button",{onClick:ee,"aria-label":"Zoom in",className:"bg-white rounded-full shadow p-2 mb-2 flex items-center justify-center",style:{width:44,height:44},children:[c.jsx(lt,{size:28,color:"#1976d2","aria-hidden":"true"}),c.jsx("span",{className:"sr-only",children:"Zoom in"})]}),c.jsxs("button",{onClick:_,"aria-label":"Zoom out",className:"bg-white rounded-full shadow p-2 mb-2 flex items-center justify-center",style:{width:44,height:44},children:[c.jsx(ct,{size:28,color:"#1976d2","aria-hidden":"true"}),c.jsx("span",{className:"sr-only",children:"Zoom out"})]}),e&&c.jsxs("div",{style:{position:"relative"},children:[c.jsxs("button",{"aria-label":"Map layers",className:"bg-white rounded-full shadow p-2 flex items-center justify-center mt-0 hover:bg-gray-100 focus:outline-none",style:{width:44,height:44},onClick:()=>i(f=>!f),children:[c.jsx(Ae,{path:Pe,size:1.2,color:"#1976d2"}),c.jsx("span",{className:"sr-only",children:"Map layers"})]}),o&&c.jsxs("div",{className:"absolute right-0 mt-2 bg-white rounded shadow-lg border z-50",style:{minWidth:200,padding:8,color:"#1976d2"},role:"menu","aria-label":"Layer selection",children:[c.jsx("div",{className:"font-semibold mb-2",children:"Base Layers"}),U.map(f=>c.jsx("button",{className:`w-full text-left px-2 py-1 rounded hover:bg-blue-50 ${v===f.key?"bg-blue-50 font-bold":""}`,onClick:()=>u(f.key),role:"menuitem",style:{color:"#1976d2"},children:f.name},f.key)),c.jsx("div",{className:"font-semibold mt-4 mb-2",children:"Map Features"}),c.jsxs("label",{className:"flex items-center px-2 py-1 cursor-pointer hover:bg-blue-50 rounded",style:{color:"#1976d2"},children:[c.jsx("input",{type:"checkbox",checked:h,onChange:f=>x(f.target.checked),style:xt}),c.jsx("span",{style:{position:"relative",left:-26,width:18,height:18,pointerEvents:"none",display:h?"inline-block":"none"},children:c.jsx("svg",{width:"18",height:"18",viewBox:"0 0 18 18",style:{position:"absolute",top:0,left:0},children:c.jsx("polyline",{points:"4,9 8,13 14,5",stroke:"#1976d2",strokeWidth:"2.5",fill:"none"})})}),c.jsx("span",{style:{marginLeft:h?-8:0},children:"Booth Surface"})]})]})]})]}),e&&c.jsx(Ke,{isAdminView:e,mapInstance:y,updateMarker:n}),c.jsx("div",{id:"map-container",className:"fixed inset-0 w-full h-full",style:{zIndex:1,height:"100svh",height:"100dvh",height:"100vh",touchAction:"pan-x pan-y",overflow:"hidden"},"aria-label":d("map.ariaLabel"),children:c.jsxs(qe,{center:N,zoom:$,minZoom:D,maxZoom:Z,zoomDelta:.5,zoomSnap:.5,zoomControl:!1,style:{width:"100vw",height:"100vh"},className:"focus:outline-none focus:ring-2 focus:ring-primary",whenReady:B,attributionControl:!1,children:[U.filter(f=>f.key===v).map(f=>c.jsx(Xe,{attribution:f.attribution,url:f.url,maxZoom:22},f.key)),c.jsx(Ve,{safeMarkers:b,infoButtonToggled:a,setInfoButtonToggled:r,isMobile:l,updateMarker:n,isMarkerDraggable:z,iconCreateFunction:Qe}),c.jsx(Ye,{safeMarkers:b,infoButtonToggled:a,setInfoButtonToggled:r,isMobile:l,updateMarker:n,isMarkerDraggable:z})]})})]})}export{vt as default};
