const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-BJ82T7X0.js","assets/index-De1pT-J8.css"])))=>i.map(i=>d[i]);
import{r as y,a as Me,g as Oe,b as Se,l as z,c as Ee,R as _,L as Ce,d as Ne,e as G,f as _e,h as re,i as Ie,w as je,j as E,k as s,m as B,n as k,M as Ae,I as Te,o as Pe,_ as Re,p as ze,q as De}from"./index-BJ82T7X0.js";const He=(e,t,n,o)=>{const l=[n,{code:t,...o||{}}];if(e?.services?.logger?.forward)return e.services.logger.forward(l,"warn","react-i18next::",!0);A(l[0])&&(l[0]=`react-i18next:: ${l[0]}`),e?.services?.logger?.warn?e.services.logger.warn(...l):console?.warn&&console.warn(...l)},J={},se=(e,t,n,o)=>{A(n)&&J[n]||(A(n)&&(J[n]=new Date),He(e,t,n,o))},le=(e,t)=>()=>{if(e.isInitialized)t();else{const n=()=>{setTimeout(()=>{e.off("initialized",n)},0),t()};e.on("initialized",n)}},X=(e,t,n)=>{e.loadNamespaces(t,le(e,n))},Q=(e,t,n,o)=>{if(A(n)&&(n=[n]),e.options.preload&&e.options.preload.indexOf(t)>-1)return X(e,n,o);n.forEach(l=>{e.options.ns.indexOf(l)<0&&e.options.ns.push(l)}),e.loadLanguages(t,le(e,o))},Ze=(e,t,n={})=>!t.languages||!t.languages.length?(se(t,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:t.languages}),!0):t.hasLoadedNamespace(e,{lng:n.lng,precheck:(o,l)=>{if(n.bindI18n&&n.bindI18n.indexOf("languageChanging")>-1&&o.services.backendConnector.backend&&o.isLanguageChangingTo&&!l(o.isLanguageChangingTo,e))return!1}}),A=e=>typeof e=="string",Ue=e=>typeof e=="object"&&e!==null,Ge=y.createContext();class ke{constructor(){this.usedNamespaces={}}addUsedNamespaces(t){t.forEach(n=>{this.usedNamespaces[n]||(this.usedNamespaces[n]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}var $={exports:{}},F={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ee;function We(){if(ee)return F;ee=1;var e=Me();function t(a,u){return a===u&&(a!==0||1/a===1/u)||a!==a&&u!==u}var n=typeof Object.is=="function"?Object.is:t,o=e.useState,l=e.useEffect,c=e.useLayoutEffect,i=e.useDebugValue;function f(a,u){var h=u(),v=o({inst:{value:h,getSnapshot:u}}),m=v[0].inst,b=v[1];return c(function(){m.value=h,m.getSnapshot=u,d(m)&&b({inst:m})},[a,h,u]),l(function(){return d(m)&&b({inst:m}),a(function(){d(m)&&b({inst:m})})},[a]),i(h),h}function d(a){var u=a.getSnapshot;a=a.value;try{var h=u();return!n(a,h)}catch{return!0}}function r(a,u){return u()}var x=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?r:f;return F.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:x,F}var te;function $e(){return te||(te=1,$.exports=We()),$.exports}var Fe=$e();const Be=(e,t)=>A(t)?t:Ue(t)&&A(t.defaultValue)?t.defaultValue:Array.isArray(e)?e[e.length-1]:e,Xe={t:Be,ready:!1},Ye=()=>()=>{},ce=(e,t={})=>{const{i18n:n}=t,{i18n:o,defaultNS:l}=y.useContext(Ge)||{},c=n||o||Oe();c&&!c.reportNamespaces&&(c.reportNamespaces=new ke),c||se(c,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const i=y.useMemo(()=>({...Se(),...c?.options?.react,...t}),[c,t]),{useSuspense:f,keyPrefix:d}=i,r=y.useMemo(()=>{const p=l||c?.options?.defaultNS;return A(p)?[p]:p||["translation"]},[e,l,c]);c?.reportNamespaces?.addUsedNamespaces?.(r);const x=y.useCallback(p=>{if(!c)return Ye;const{bindI18n:w,bindI18nStore:O}=i;return w&&c.on(w,p),O&&c.store.on(O,p),()=>{w&&w.split(" ").forEach(g=>c.off(g,p)),O&&O.split(" ").forEach(g=>c.store.off(g,p))}},[c,i]),a=y.useRef(),u=y.useCallback(()=>{if(!c)return Xe;const p=!!(c.isInitialized||c.initializedStoreOnce)&&r.every(L=>Ze(L,c,i)),w=c.getFixedT(t.lng||c.language,i.nsMode==="fallback"?r:r[0],d),O=a.current;if(O&&O.ready===p&&O.lng===(t.lng||c.language)&&O.keyPrefix===d)return O;const g={t:w,ready:p,lng:t.lng||c.language,keyPrefix:d};return a.current=g,g},[c,r,d,i,t.lng]),[h,v]=y.useState(0),{t:m,ready:b}=Fe.useSyncExternalStore(x,u,u);y.useEffect(()=>{if(c&&!b&&!f){const p=()=>v(w=>w+1);t.lng?Q(c,t.lng,r,p):X(c,r,p)}},[c,t.lng,r,b,f,h]);const M=c||{},C=y.useMemo(()=>{const p=[m,M,b];return p.t=m,p.i18n=M,p.ready=b,p},[m,M,b]);if(c&&f&&!b)throw new Promise(p=>{const w=()=>p();t.lng?Q(c,t.lng,r,w):X(c,r,w)});return C};function Ve(e,t,n){const{opacity:o,zIndex:l}=t;o!=null&&o!==n.opacity&&e.setOpacity(o),l!=null&&l!==n.zIndex&&e.setZIndex(l)}function qe({bounds:e,boundsOptions:t,center:n,children:o,className:l,id:c,placeholder:i,style:f,whenReady:d,zoom:r,...x},a){const[u]=y.useState({className:l,id:c,style:f}),[h,v]=y.useState(null),m=y.useRef(void 0);y.useImperativeHandle(a,()=>h?.map??null,[h]);const b=y.useCallback(C=>{if(C!==null&&!m.current){const p=new z.Map(C,x);m.current=p,n!=null&&r!=null?p.setView(n,r):e!=null&&p.fitBounds(e,t),d!=null&&p.whenReady(d),v(Ee(p))}},[]);y.useEffect(()=>()=>{h?.map.remove()},[h]);const M=h?_.createElement(Ce,{value:h},o):i??null;return _.createElement("div",{...u,ref:b},M)}const Ke=y.forwardRef(qe),de=Ne(function({position:t,...n},o){const l=new z.Marker(t,n);return G(l,_e(o,{overlayContainer:l}))},function(t,n,o){n.position!==o.position&&t.setLatLng(n.position),n.icon!=null&&n.icon!==o.icon&&t.setIcon(n.icon),n.zIndexOffset!=null&&n.zIndexOffset!==o.zIndexOffset&&t.setZIndexOffset(n.zIndexOffset),n.opacity!=null&&n.opacity!==o.opacity&&t.setOpacity(n.opacity),t.dragging!=null&&n.draggable!==o.draggable&&(n.draggable===!0?t.dragging.enable():t.dragging.disable())}),Je=re(function(t,n){const o=new z.Popup(t,n.overlayContainer);return G(o,n)},function(t,n,{position:o},l){y.useEffect(function(){const{instance:i}=t;function f(r){r.popup===i&&(i.update(),l(!0))}function d(r){r.popup===i&&l(!1)}return n.map.on({popupopen:f,popupclose:d}),n.overlayContainer==null?(o!=null&&i.setLatLng(o),i.openOn(n.map)):n.overlayContainer.bindPopup(i),function(){n.map.off({popupopen:f,popupclose:d}),n.overlayContainer?.unbindPopup(),n.map.removeLayer(i)}},[t,n,l,o])}),Qe=Ie(function({url:t,...n},o){const l=new z.TileLayer(t,je(n,o));return G(l,o)},function(t,n,o){Ve(t,n,o);const{url:l}=n;l!=null&&l!==o.url&&t.setUrl(l)}),ue=re(function(t,n){const o=new z.Tooltip(t,n.overlayContainer);return G(o,n)},function(t,n,{position:o},l){y.useEffect(function(){const i=n.overlayContainer;if(i==null)return;const{instance:f}=t,d=x=>{x.tooltip===f&&(o!=null&&f.setLatLng(o),f.update(),l(!0))},r=x=>{x.tooltip===f&&l(!1)};return i.on({tooltipopen:d,tooltipclose:r}),i.bindTooltip(f),function(){i.off({tooltipopen:d,tooltipclose:r}),i._map!=null&&i.unbindTooltip()}},[t,n,l,o])});function Y({glyph:e,glyphColor:t="white",bgColor:n="white",glyphSize:o="8px",iconUrl:l="/Map/assets/icons/glyph-marker-icon-blue.svg",className:c,iconSize:i,prefix:f,glyphAnchor:d}){let r=o;typeof r=="number"?r=`${r}px`:typeof r=="string"&&!r.endsWith("px")?r=`${r}px`:r||(r="8px");const x=i||[25,41],a=Math.round(x[0]*(41/25)),u=Math.round(x[1]*(41/41)),h=Math.round(a*12/41),v=u;return E.icon.glyph({iconUrl:l||"/Map/assets/icons/glyph-marker-icon-blue.svg",iconSize:x,iconAnchor:[Math.round(x[0]/2),x[1]],popupAnchor:[1,-34],tooltipAnchor:[0,0],shadowUrl:"/Map/assets/icons/marker-shadow.png",shadowSize:[a,u],shadowAnchor:[h,v],prefix:f||"",glyph:e||"",glyphColor:t||"white",bgColor:n,glyphSize:r,glyphAnchor:d||[0,0],className:c||""})}function et({safeMarkers:e,infoButtonToggled:t,setInfoButtonToggled:n,isMobile:o,updateMarker:l,isMarkerDraggable:c}){return s.jsx(s.Fragment,{children:e.filter(i=>i.id>=1001).map(i=>{const f=t[i.id];let d=[i.lat,i.lng],r=i.iconUrl;r||(r=`${i.type||"glyph-marker-icon-blue"}.svg`),r=B(r);const x=Y({className:i.type?`marker-icon marker-type-${i.type}`:"marker-icon",prefix:i.prefix,iconUrl:r,iconSize:Array.isArray(i.iconSize)?i.iconSize:[17,28],glyph:i.glyph||"?",glyphColor:i.glyphColor||"white",glyphSize:i.glyphSize||"12px",glyphAnchor:i.glyphAnchor||[0,-5]}),a=i.logo?k(i.logo):null,u=c(i),h={...u?{dragend:v=>{const{lat:m,lng:b}=v.target.getLatLng();l(i.id,{lat:m,lng:b})}}:{}};return s.jsx(de,{position:d,icon:x,draggable:u,eventHandlers:h,children:s.jsx(ue,{direction:"top",offset:[0,-32],opacity:1,permanent:!1,interactive:!0,children:s.jsxs("div",{className:"flex flex-col items-center",children:[a&&s.jsx("img",{src:a,alt:i.name||"Logo",style:{maxWidth:120,maxHeight:80,objectFit:"contain",borderRadius:0}}),s.jsx("span",{style:{fontWeight:600,color:"#1976d2"},children:i.name}),o&&s.jsx("button",{className:`mt-2 px-2 py-1 text-xs rounded ${f?"bg-green-500 text-white":"bg-blue-500 text-white"}`,onClick:()=>{n(v=>({...v,[i.id]:!v[i.id]}))},children:"More info"})]})})},`${i.id}-${i.coreLocked}-${i.appearanceLocked}-${i.contentLocked}-${i.adminLocked}`)})})}function fe(e="md"){const t={sm:"(max-width: 639px)",md:"(max-width: 767px)",lg:"(max-width: 1023px)",xl:"(max-width: 1279px)","2xl":"(max-width: 1535px)"},n=t[e]||t.md,[o,l]=y.useState(()=>typeof window<"u"?window.matchMedia(n).matches:!1);return y.useEffect(()=>{if(typeof window>"u")return;const c=window.matchMedia(n),i=()=>l(c.matches);return c.addEventListener("change",i),()=>c.removeEventListener("change",i)},[n]),o}const j={CHUNKED_LOADING:!0,SHOW_COVERAGE_ON_HOVER:!0,SPIDERFY_ON_MAX_ZOOM:!1,REMOVE_OUTSIDE_VISIBLE_BOUNDS:!0,DISABLE_CLUSTERING_AT_ZOOM:18,MAX_CLUSTER_RADIUS:400,MAX_MARKER_ID:1001},D={SIZE:[15,25],GLYPH_COLOR:"white",GLYPH_SIZE:"9px",GLYPH_ANCHOR:[0,-4]},tt=e=>e.iconUrl?B(e.iconUrl):B(`${e.type||"default"}.svg`),nt=e=>Y({className:e.type?`marker-icon marker-type-${e.type}`:"marker-icon",prefix:e.prefix,iconUrl:tt(e),iconSize:Array.isArray(e.iconSize)?e.iconSize:D.SIZE,glyph:e.glyph||"",glyphColor:e.glyphColor||D.GLYPH_COLOR,glyphSize:e.glyphSize||D.GLYPH_SIZE,glyphAnchor:e.glyphAnchor||D.GLYPH_ANCHOR}),ot=e=>`${e.id}-${e.coreLocked}-${e.appearanceLocked}-${e.contentLocked}-${e.adminLocked}`,at=({marker:e})=>s.jsxs("div",{className:"flex items-center gap-2 p-1",children:[e.logo&&s.jsx("img",{src:k(e.logo),alt:"",className:"w-8 h-8 object-contain flex-shrink-0"}),s.jsxs("div",{className:"flex flex-col min-w-0",children:[e.boothNumber&&s.jsxs("div",{className:"text-xs font-semibold text-gray-700",children:["Booth ",e.boothNumber]}),e.name&&s.jsx("div",{className:"text-sm font-medium text-gray-900 truncate",children:e.name})]})]}),it=({marker:e})=>s.jsxs("div",{className:"p-2 min-w-[200px]",children:[e.logo&&s.jsx("img",{src:k(e.logo),alt:e.name||"Logo",className:"w-20 h-20 object-contain mx-auto mb-3"}),s.jsxs("div",{className:"space-y-2",children:[e.boothNumber&&s.jsxs("div",{className:"text-sm",children:[s.jsx("span",{className:"font-semibold text-gray-700",children:"Booth:"})," ",s.jsx("span",{className:"text-gray-900",children:e.boothNumber})]}),e.name&&s.jsx("div",{className:"text-base font-semibold text-gray-900",children:e.name}),e.website&&s.jsxs("div",{className:"text-sm",children:[s.jsx("span",{className:"font-semibold text-gray-700",children:"Website:"})," ",s.jsx("a",{href:e.website.startsWith("http")?e.website:`https://${e.website}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline",children:e.website})]}),e.info&&s.jsx("div",{className:"text-sm text-gray-600 mt-2 pt-2 border-t border-gray-200",children:e.info}),e.label&&!e.name&&s.jsx("div",{className:"text-sm text-gray-600",children:e.label})]})]});function rt({safeMarkers:e,updateMarker:t,isMarkerDraggable:n,iconCreateFunction:o}){const l=y.useRef({}),c=y.useRef({}),i=fe("md"),f=y.useMemo(()=>e.filter(a=>a.id<j.MAX_MARKER_ID),[e]),d=y.useCallback(a=>u=>{const{lat:h,lng:v}=u.target.getLatLng();t(a,{lat:h,lng:v})},[t]),r=y.useCallback(a=>(l.current[a]||(l.current[a]=_.createRef()),l.current[a]),[]),x=y.useCallback(a=>({dragend:n?d(a):void 0,mouseover:u=>{i||u.target.openTooltip()},mouseout:u=>{i||u.target.closeTooltip()},click:u=>{if(!i){const h=u.target;h.isPopupOpen()?h.closePopup():h.openPopup()}},touchstart:u=>{if(!i)return;const h=u.target,v=Date.now(),m=c.current[a]||0,b=v-m;c.current[a]=v,b<600?(h.closeTooltip(),h.openPopup()):h.isPopupOpen()||(h.openTooltip(),setTimeout(()=>h.closeTooltip(),1500)),h.__justTouched=!0,u.originalEvent.preventDefault(),u.originalEvent.stopPropagation()},click:u=>{const h=u.target;if(i&&h.__justTouched){h.__justTouched=!1;return}},popupopen:u=>u.target.closeTooltip()}),[i,n,d]);return s.jsx(Ae,{chunkedLoading:j.CHUNKED_LOADING,showCoverageOnHover:j.SHOW_COVERAGE_ON_HOVER,spiderfyOnMaxZoom:j.SPIDERFY_ON_MAX_ZOOM,removeOutsideVisibleBounds:j.REMOVE_OUTSIDE_VISIBLE_BOUNDS,disableClusteringAtZoom:j.DISABLE_CLUSTERING_AT_ZOOM,maxClusterRadius:j.MAX_CLUSTER_RADIUS,iconCreateFunction:o,children:f.map(a=>{const u=[a.lat,a.lng],h=nt(a),v=n(a);return s.jsxs(de,{position:u,icon:h,draggable:v,eventHandlers:x(a.id),ref:r(a.id),children:[s.jsx(ue,{direction:"top",offset:[0,-10],opacity:.95,permanent:!1,interactive:!1,className:"marker-tooltip",children:s.jsx(at,{marker:a})}),s.jsx(Je,{closeButton:!0,maxWidth:320,minWidth:200,className:"marker-popup",autoPan:!0,keepInView:!0,children:s.jsx(it,{marker:a})})]},ot(a))})})}function st({isAdminView:e,mapInstance:t,updateMarker:n}){const{t:o}=ce(),[l,c]=y.useState(!1),[i,f]=y.useState(!1),[d,r]=y.useState(""),[x,a]=y.useState(""),u=()=>{f(!0),r(""),a("")},h=async()=>{if(!d||isNaN(Number(d))){a("Please enter a valid numeric ID.");return}if(await m(d)){a("ID already exists. Please choose another.");return}f(!1),c(!0),a("")},v=()=>{f(!1),r(""),a("")};y.useEffect(()=>{if(!l||!t||!d)return;const b=M=>{const C=M.latlng,p={...lt({lat:C.lat,lng:C.lng}),id:Number(d)};typeof n=="function"&&n(p.id,p,{add:!0}),c(!1),r(""),t.off("click",b)};return t.on("click",b),()=>{t.off("click",b)}},[l,t,n,d]);async function m(b){try{const{supabase:M}=await Re(async()=>{const{supabase:p}=await import("./index-BJ82T7X0.js").then(w=>w.s);return{supabase:p}},__vite__mapDeps([0,1])),C=["Markers_Core","Markers_Appearance","Markers_Content","Markers_Admin"];for(const p of C){const{data:w,error:O}=await M.from(p).select("id").eq("id",Number(b));if(O)return!1;if(w&&w.length>0)return!0}return!1}catch{return!1}}return e?s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:u,"aria-label":"Add marker",className:"bg-white rounded-full shadow p-2 flex items-center justify-center",style:{position:"absolute",left:10,top:60,zIndex:1001,width:44,height:44,border:"none",cursor:l?"crosshair":"pointer",background:l?"#e3f2fd":"white"},title:l?"Click on map to place marker":"Add marker",children:[s.jsx(Te.Icon,{path:Pe,size:1.5,color:"#1976d2","aria-hidden":"true",style:{width:"42px",height:"42px"}}),s.jsx("span",{className:"sr-only",children:"Add marker"})]}),i&&s.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0,0,0,0.3)",zIndex:2e3,display:"flex",alignItems:"center",justifyContent:"center"},children:s.jsxs("div",{style:{background:"white",borderRadius:8,boxShadow:"0 2px 16px rgba(25,118,210,0.15)",padding:32,minWidth:320,display:"flex",flexDirection:"column",alignItems:"center"},children:[s.jsx("h2",{style:{color:"#1976d2",fontWeight:700,marginBottom:16},children:"Enter Marker ID"}),s.jsx("input",{type:"number",value:d,onChange:b=>r(b.target.value),style:{fontSize:18,padding:"8px 12px",border:"2px solid #1976d2",borderRadius:4,marginBottom:12,width:"100%"},placeholder:"Marker ID (integer)",min:1}),x&&s.jsx("div",{style:{color:"red",marginBottom:8},children:x}),s.jsxs("div",{style:{display:"flex",gap:12},children:[s.jsx("button",{onClick:h,style:{background:"#1976d2",color:"white",border:"none",borderRadius:4,padding:"8px 20px",fontWeight:600,cursor:"pointer"},children:"Confirm"}),s.jsx("button",{onClick:v,style:{background:"#eee",color:"#1976d2",border:"none",borderRadius:4,padding:"8px 20px",fontWeight:600,cursor:"pointer"},children:"Cancel"})]})]})})]}):null}function lt({lat:e,lng:t}){return{id:null,lat:e,lng:t,name:"",label:"",logo:"",boothNumber:"",coreLocked:!1}}var he={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},ne=_.createContext&&_.createContext(he),ct=["attr","size","title"];function dt(e,t){if(e==null)return{};var n=ut(e,t),o,l;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(l=0;l<c.length;l++)o=c[l],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}function ut(e,t){if(e==null)return{};var n={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;n[o]=e[o]}return n}function Z(){return Z=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},Z.apply(this,arguments)}function oe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,o)}return n}function U(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?oe(Object(n),!0).forEach(function(o){ft(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oe(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function ft(e,t,n){return t=ht(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ht(e){var t=pt(e,"string");return typeof t=="symbol"?t:t+""}function pt(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pe(e){return e&&e.map((t,n)=>_.createElement(t.tag,U({key:n},t.attr),pe(t.child)))}function V(e){return t=>_.createElement(gt,Z({attr:U({},e.attr)},t),pe(e.child))}function gt(e){var t=n=>{var{attr:o,size:l,title:c}=e,i=dt(e,ct),f=l||n.size||"1em",d;return n.className&&(d=n.className),e.className&&(d=(d?d+" ":"")+e.className),_.createElement("svg",Z({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,o,i,{className:d,style:U(U({color:e.color||n.color},n.style),e.style),height:f,width:f,xmlns:"http://www.w3.org/2000/svg"}),c&&_.createElement("title",null,c),e.children)};return ne!==void 0?_.createElement(ne.Consumer,null,n=>t(n)):t(he)}function yt(e){return V({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"},child:[]}]})(e)}function mt(e){return V({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"},child:[]}]})(e)}function xt(e){return V({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M19 13H5v-2h14v2z"},child:[]}]})(e)}function bt(e){e&&e.zoomIn()}function vt(e){e&&e.zoomOut()}function wt(e,t,n){e&&e.setView(t,n)}const Lt={appearance:"none",WebkitAppearance:"none",MozAppearance:"none",outline:"none",background:"#fff",border:"2px solid #1976d2",borderRadius:4,width:18,height:18,display:"inline-block",position:"relative",marginRight:8,cursor:"pointer",verticalAlign:"middle"};function Mt({mapInstance:e,mapCenter:t,mapZoom:n,searchControlRef:o,isAdminView:l,showLayersMenu:c,setShowLayersMenu:i,activeLayer:f,setActiveLayer:d,showRectanglesAndHandles:r,setShowRectanglesAndHandles:x,MAP_LAYERS:a}){const u=()=>bt(e),h=()=>vt(e),v=()=>wt(e,t,n);return s.jsxs("div",{style:{position:"absolute",top:10,right:10,zIndex:1e3,display:"flex",flexDirection:"column",gap:"10px"},children:[s.jsxs("button",{onClick:v,"aria-label":"Home",className:"bg-white rounded-full shadow p-2 flex items-center justify-center",style:{width:44,height:44},children:[s.jsx(yt,{size:28,color:"#1976d2","aria-hidden":"true"}),s.jsx("span",{className:"sr-only",children:"Home"})]}),s.jsxs("button",{onClick:u,"aria-label":"Zoom in",className:"bg-white rounded-full shadow p-2 mb-2 flex items-center justify-center",style:{width:44,height:44},children:[s.jsx(mt,{size:28,color:"#1976d2","aria-hidden":"true"}),s.jsx("span",{className:"sr-only",children:"Zoom in"})]}),s.jsxs("button",{onClick:h,"aria-label":"Zoom out",className:"bg-white rounded-full shadow p-2 mb-2 flex items-center justify-center",style:{width:44,height:44},children:[s.jsx(xt,{size:28,color:"#1976d2","aria-hidden":"true"}),s.jsx("span",{className:"sr-only",children:"Zoom out"})]}),l&&s.jsxs("div",{style:{position:"relative"},children:[s.jsxs("button",{"aria-label":"Map layers",className:"bg-white rounded-full shadow p-2 flex items-center justify-center mt-0 hover:bg-gray-100 focus:outline-none",style:{width:44,height:44},onClick:()=>i(m=>!m),children:[s.jsx(ze,{path:De,size:1.2,color:"#1976d2"}),s.jsx("span",{className:"sr-only",children:"Map layers"})]}),c&&s.jsxs("div",{className:"absolute right-0 mt-2 bg-white rounded shadow-lg border z-50",style:{minWidth:200,padding:8,color:"#1976d2"},role:"menu","aria-label":"Layer selection",children:[s.jsx("div",{className:"font-semibold mb-2",children:"Base Layers"}),a.map(m=>s.jsx("button",{className:`w-full text-left px-2 py-1 rounded hover:bg-blue-50 ${f===m.key?"bg-blue-50 font-bold":""}`,onClick:()=>d(m.key),role:"menuitem",style:{color:"#1976d2"},children:m.name},m.key)),s.jsx("div",{className:"font-semibold mt-4 mb-2",children:"Map Features"}),s.jsxs("label",{className:"flex items-center px-2 py-1 cursor-pointer hover:bg-blue-50 rounded",style:{color:"#1976d2"},children:[s.jsx("input",{type:"checkbox",checked:r,onChange:m=>x(m.target.checked),style:Lt}),s.jsx("span",{style:{position:"relative",left:-26,width:18,height:18,pointerEvents:"none",display:r?"inline-block":"none"},children:s.jsx("svg",{width:"18",height:"18",viewBox:"0 0 18 18",style:{position:"absolute",top:0,left:0},children:s.jsx("polyline",{points:"4,9 8,13 14,5",stroke:"#1976d2",strokeWidth:"2.5",fill:"none"})})}),s.jsx("span",{style:{marginLeft:r?-8:0},children:"Booth Surface"})]})]})]})]})}function Ot(e){return e.getChildCount(),Y({iconUrl:"/Map/assets/icons/glyph-marker-icon-orange.svg",iconSize:[50,82],glyph:`<div style='display:flex;align-items:center;justify-content:center;width:100%;height:100%;'>
  <img src='/Map/assets/logos/4x4Vakantiebeurs.png' alt='logo' style='width:40px;height:40px;object-fit:contain;display:block;margin:auto;position:relative;left:1px;top:10px;' />
      </div>`,glyphColor:"white",glyphSize:"40px",className:"custom-cluster-icon"})}function St(e){return e.angle||0}function I(e,t,n){const o=n*Math.PI/180,l=e*Math.cos(o)-t*Math.sin(o),c=e*Math.sin(o)+t*Math.cos(o);return[l,c]}function P(e){return e/111320}function R(e,t){return e/(40075e3*Math.cos(t*Math.PI/180)/360)}function Et(e){return e*111320}function Ct(e,t){return e*(40075e3*Math.cos(t*Math.PI/180)/360)}function Nt({mapInstance:e,markers:t,rectangleSize:n,isAdminView:o,showRectanglesAndHandles:l,updateMarker:c,rectangleLayerRef:i}){if(!e)return;i.current||(i.current=E.layerGroup(),i.current.addTo(e));const f=i.current;f._markerLayers||(f._markerLayers={}),Object.keys(f._markerLayers).forEach(d=>{t.find(r=>r.id===d)||(f.removeLayer(f._markerLayers[d].rectangle),f.removeLayer(f._markerLayers[d].handle),delete f._markerLayers[d])}),t.forEach(d=>{if(d.lat&&d.lng){const r=E.latLng(d.lat,d.lng),x=Array.isArray(d.rectangle)&&d.rectangle.length===2?d.rectangle:n,a=Number(x[0])/2,u=Number(x[1])/2,h=St(d),v="#1976d2",m=[I(-a,-u,h),I(a,-u,h),I(a,u,h),I(-a,u,h)],b=m.map(([p,w])=>E.latLng(r.lat+P(w),r.lng+R(p,r.lat)));let M,C;if(f._markerLayers[d.id]){M=f._markerLayers[d.id].rectangle,M.setLatLngs(b),C=f._markerLayers[d.id].handle;const[p,w]=m[2],O=E.latLng(r.lat+P(w),r.lng+R(p,r.lat));C.setLatLng(O)}else{M=E.polygon(b,{color:v,weight:1});const[p,w]=m[2],O=E.latLng(r.lat+P(w),r.lng+R(p,r.lat));let g;if(o&&!d.coreLocked){const L=E.divIcon({className:"rotation-handle-icon",html:'<div style="width:8px;height:8px;background:#1976d2;border-radius:50%;"></div>',iconSize:[8,8],iconAnchor:[4,4]});g=E.marker(O,{icon:L,draggable:!0,interactive:!0,keyboard:!0,title:"Drag to rotate"}),g.on("dragstart",function(){e&&e.dragging.disable()});let N=h;g.on("drag",function(T){const q=T.target.getLatLng(),ge=Ct(q.lng-r.lng,r.lat),ye=Et(q.lat-r.lat);let W=Math.atan2(ye,ge)*180/Math.PI;W<0&&(W+=360),N=W;const K=[I(-a,-u,N),I(a,-u,N),I(a,u,N),I(-a,u,N)],me=K.map(([we,Le])=>E.latLng(r.lat+P(Le),r.lng+R(we,r.lat)));M.setLatLngs(me);const[xe,be]=K[2],ve=E.latLng(r.lat+P(be),r.lng+R(xe,r.lat));g.setLatLng(ve)}),g.on("dragend",function(){e&&e.dragging.enable(),c(d.id,{angle:N})})}else{const L=E.divIcon({className:"rotation-handle-icon",html:'<div style="width:8px;height:8px;background:#1976d2;border-radius:50%;opacity:0.5;"></div>',iconSize:[8,8],iconAnchor:[4,4]});g=E.marker(O,{icon:L,draggable:!1,interactive:!1,keyboard:!1,title:"Locked"})}f.addLayer(M),f.addLayer(g),f._markerLayers[d.id]={rectangle:M,handle:g}}}}),Object.values(f._markerLayers).forEach(({rectangle:d,handle:r})=>{l?(f.addLayer(d),f.addLayer(r)):(f.removeLayer(d),f.removeLayer(r))})}function ae(e,t){console.log("Analytics event:",e,t)}function _t(){const e=y.useCallback(n=>{ae("marker_view",{markerId:n,timestamp:Date.now()})},[]),t=y.useCallback(n=>{ae("map_interaction",{type:n,timestamp:Date.now()})},[]);return{trackMarkerView:e,trackMapInteraction:t}}const S={DEFAULT_POSITION:[51.898095078807025,5.772961378097534],DEFAULT_ZOOM:17,MIN_ZOOM:14,MAX_ZOOM:22,SEARCH_ZOOM:21,ZOOM_DELTA:.5,ZOOM_SNAP:.5,RECTANGLE_SIZE:[6,6],MINIMAP:{WIDTH:120,HEIGHT:120,ZOOM_LEVEL:15,AIMING_COLOR:"#1976d2",SHADOW_COLOR:"#90caf9"}},H=[{key:"carto",name:"Carto Voyager",attribution:'&copy; <a href="https://carto.com/attributions">Carto</a>',url:"https://cartodb-basemaps-{s}.global.ssl.fastly.net/rastertiles/voyager_nolabels/{z}/{x}/{y}.png"},{key:"esri",name:"Esri World Imagery",attribution:"Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community",url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}"}],It=e=>[e.name,e.boothNumber,e.label].filter(Boolean).join(" | "),ie=(e,t)=>t&&e&&e.coreLocked===!1;function Tt({isAdminView:e,markersState:t,updateMarker:n}){const[o,l]=y.useState({}),[c,i]=y.useState(!1),[f,d]=y.useState(H[0].key),[r,x]=y.useState(!1),[a,u]=y.useState(null),[h,v]=y.useState(null),m=y.useRef(null),b=y.useRef(null),{t:M}=ce(),C=fe();_t();const p=y.useMemo(()=>Array.isArray(t)?t:[],[t]);y.useEffect(()=>{p.forEach(g=>{if(g.logo){const L=new window.Image;L.src=k(g.logo)}})},[p]),y.useEffect(()=>{a&&Nt({mapInstance:a,markers:p,rectangleSize:S.RECTANGLE_SIZE,isAdminView:e,showRectanglesAndHandles:r,updateMarker:n,rectangleLayerRef:b})},[a,p,e,r,n]),y.useEffect(()=>{if(!a)return;const g=E.layerGroup();p.forEach(L=>{if(L.lat&&L.lng){const N=It(L),T=E.marker([L.lat,L.lng],{opacity:0,interactive:!1});T.feature={type:"Feature",properties:{searchText:N}},T.bindPopup(L.name||L.label||""),g.addLayer(T)}}),v(g)},[a,p]),y.useEffect(()=>{if(!a||!h)return;const g=new E.Control.Search({layer:h,propertyName:"searchText",initial:!1,zoom:S.SEARCH_ZOOM,marker:{icon:!1,animate:!0},textPlaceholder:"Search for name or booth...",position:"topleft"});return a.addControl(g),m.current=g,g.on("search:locationfound",L=>{if(L?.layer?.getLatLng){const N=L.layer.getLatLng();a.flyTo(N,S.SEARCH_ZOOM,{animate:!0}),g._input&&g._input.blur(),g.hideAlert&&g.hideAlert(),g.collapse&&g.collapse()}}),()=>{a&&g&&(a.removeControl(g),m.current=null)}},[a,h]),y.useEffect(()=>{if(a&&!a._minimapControl){const g=E.tileLayer(H[0].url,{attribution:"",minZoom:0,maxZoom:16}),L=new E.Control.MiniMap(g,{position:"bottomright",width:S.MINIMAP.WIDTH,height:S.MINIMAP.HEIGHT,zoomLevelFixed:S.MINIMAP.ZOOM_LEVEL,toggleDisplay:!0,centerFixed:S.DEFAULT_POSITION,aimingRectOptions:{color:S.MINIMAP.AIMING_COLOR,weight:2,opacity:.9,fillOpacity:.1,fill:!0},shadowRectOptions:{color:S.MINIMAP.SHADOW_COLOR,weight:1,opacity:.5,fillOpacity:.05,fill:!0},strings:{hideText:"Hide MiniMap",showText:"Show MiniMap"}});L.addTo(a),a._minimapControl=L}},[a]);const w=g=>{const L=g?.target||g;u(L)},O={height:"100vh",width:"100vw",position:"fixed",inset:0,zIndex:0,touchAction:"pan-x pan-y",overflow:"hidden"};return s.jsxs("div",{style:O,tabIndex:0,"aria-label":"Event Map",role:"region",children:[s.jsx(Mt,{mapInstance:a,mapCenter:S.DEFAULT_POSITION,mapZoom:S.DEFAULT_ZOOM,searchControlRef:m,isAdminView:e,showLayersMenu:c,setShowLayersMenu:i,activeLayer:f,setActiveLayer:d,showRectanglesAndHandles:r,setShowRectanglesAndHandles:x,MAP_LAYERS:H}),e&&s.jsx(st,{mapInstance:a,isAdminView:e,updateMarker:n}),s.jsx("div",{id:"map-container",className:"fixed inset-0 w-full h-full",style:{zIndex:1,height:"100vh",touchAction:"pan-x pan-y",overflow:"hidden"},"aria-label":M("map.ariaLabel"),children:s.jsxs(Ke,{center:S.DEFAULT_POSITION,zoom:S.DEFAULT_ZOOM,minZoom:S.MIN_ZOOM,maxZoom:S.MAX_ZOOM,zoomDelta:S.ZOOM_DELTA,zoomSnap:S.ZOOM_SNAP,zoomControl:!1,style:{width:"100vw",height:"100vh"},className:"focus:outline-none focus:ring-2 focus:ring-primary",whenReady:w,attributionControl:!1,children:[H.filter(g=>g.key===f).map(g=>s.jsx(Qe,{attribution:g.attribution,url:g.url,maxZoom:S.MAX_ZOOM},g.key)),s.jsx(rt,{safeMarkers:p,infoButtonToggled:o,setInfoButtonToggled:l,isMobile:C,updateMarker:n,isMarkerDraggable:g=>ie(g,e),iconCreateFunction:Ot}),s.jsx(et,{safeMarkers:p,infoButtonToggled:o,setInfoButtonToggled:l,isMobile:C,updateMarker:n,isMarkerDraggable:g=>ie(g,e)})]})})]})}export{Tt as default};
