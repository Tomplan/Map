const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-RjQXOmyZ.js","assets/index-ChIh_S_U.css"])))=>i.map(i=>d[i]);
import{r as g,a as xe,g as be,b as ve,l as G,c as we,R as I,L as Le,d as Se,e as F,f as Me,h as Ce,w as je,i as Ee,j as E,k as u,m as ae,n as q,M as Ie,I as Ne,o as ze,_ as Oe,p as Ae,q as _e}from"./index-RjQXOmyZ.js";const Te=(e,t,n,o)=>{const s=[n,{code:t,...o||{}}];if(e?.services?.logger?.forward)return e.services.logger.forward(s,"warn","react-i18next::",!0);T(s[0])&&(s[0]=`react-i18next:: ${s[0]}`),e?.services?.logger?.warn?e.services.logger.warn(...s):console?.warn&&console.warn(...s)},K={},ie=(e,t,n,o)=>{T(n)&&K[n]||(T(n)&&(K[n]=new Date),Te(e,t,n,o))},re=(e,t)=>()=>{if(e.isInitialized)t();else{const n=()=>{setTimeout(()=>{e.off("initialized",n)},0),t()};e.on("initialized",n)}},Z=(e,t,n)=>{e.loadNamespaces(t,re(e,n))},J=(e,t,n,o)=>{if(T(n)&&(n=[n]),e.options.preload&&e.options.preload.indexOf(t)>-1)return Z(e,n,o);n.forEach(s=>{e.options.ns.indexOf(s)<0&&e.options.ns.push(s)}),e.loadLanguages(t,re(e,o))},Pe=(e,t,n={})=>!t.languages||!t.languages.length?(ie(t,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:t.languages}),!0):t.hasLoadedNamespace(e,{lng:n.lng,precheck:(o,s)=>{if(n.bindI18n&&n.bindI18n.indexOf("languageChanging")>-1&&o.services.backendConnector.backend&&o.isLanguageChangingTo&&!s(o.isLanguageChangingTo,e))return!1}}),T=e=>typeof e=="string",ke=e=>typeof e=="object"&&e!==null,Re=g.createContext();class $e{constructor(){this.usedNamespaces={}}addUsedNamespaces(t){t.forEach(n=>{this.usedNamespaces[n]||(this.usedNamespaces[n]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}var W={exports:{}},B={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Q;function De(){if(Q)return B;Q=1;var e=xe();function t(d,f){return d===f&&(d!==0||1/d===1/f)||d!==d&&f!==f}var n=typeof Object.is=="function"?Object.is:t,o=e.useState,s=e.useEffect,l=e.useLayoutEffect,r=e.useDebugValue;function a(d,f){var p=f(),w=o({inst:{value:p,getSnapshot:f}}),y=w[0].inst,b=w[1];return l(function(){y.value=p,y.getSnapshot=f,c(y)&&b({inst:y})},[d,p,f]),s(function(){return c(y)&&b({inst:y}),d(function(){c(y)&&b({inst:y})})},[d]),r(p),p}function c(d){var f=d.getSnapshot;d=d.value;try{var p=f();return!n(d,p)}catch{return!0}}function i(d,f){return f()}var x=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?i:a;return B.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:x,B}var ee;function He(){return ee||(ee=1,W.exports=De()),W.exports}var Ue=He();const Ge=(e,t)=>T(t)?t:ke(t)&&T(t.defaultValue)?t.defaultValue:Array.isArray(e)?e[e.length-1]:e,We={t:Ge,ready:!1},Be=()=>()=>{},se=(e,t={})=>{const{i18n:n}=t,{i18n:o,defaultNS:s}=g.useContext(Re)||{},l=n||o||be();l&&!l.reportNamespaces&&(l.reportNamespaces=new $e),l||ie(l,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const r=g.useMemo(()=>({...ve(),...l?.options?.react,...t}),[l,t]),{useSuspense:a,keyPrefix:c}=r,i=g.useMemo(()=>{const h=s||l?.options?.defaultNS;return T(h)?[h]:h||["translation"]},[e,s,l]);l?.reportNamespaces?.addUsedNamespaces?.(i);const x=g.useCallback(h=>{if(!l)return Be;const{bindI18n:v,bindI18nStore:M}=r;return v&&l.on(v,h),M&&l.store.on(M,h),()=>{v&&v.split(" ").forEach(j=>l.off(j,h)),M&&M.split(" ").forEach(j=>l.store.off(j,h))}},[l,r]),d=g.useRef(),f=g.useCallback(()=>{if(!l)return We;const h=!!(l.isInitialized||l.initializedStoreOnce)&&i.every(O=>Pe(O,l,r)),v=l.getFixedT(t.lng||l.language,r.nsMode==="fallback"?i:i[0],c),M=d.current;if(M&&M.ready===h&&M.lng===(t.lng||l.language)&&M.keyPrefix===c)return M;const j={t:v,ready:h,lng:t.lng||l.language,keyPrefix:c};return d.current=j,j},[l,i,c,r,t.lng]),[p,w]=g.useState(0),{t:y,ready:b}=Ue.useSyncExternalStore(x,f,f);g.useEffect(()=>{if(l&&!b&&!a){const h=()=>w(v=>v+1);t.lng?J(l,t.lng,i,h):Z(l,i,h)}},[l,t.lng,i,b,a,p]);const L=l||{},S=g.useMemo(()=>{const h=[y,L,b];return h.t=y,h.i18n=L,h.ready=b,h},[y,L,b]);if(l&&a&&!b)throw new Promise(h=>{const v=()=>h();t.lng?J(l,t.lng,i,v):Z(l,i,v)});return S};function Ze(e,t,n){const{opacity:o,zIndex:s}=t;o!=null&&o!==n.opacity&&e.setOpacity(o),s!=null&&s!==n.zIndex&&e.setZIndex(s)}function Fe({bounds:e,boundsOptions:t,center:n,children:o,className:s,id:l,placeholder:r,style:a,whenReady:c,zoom:i,...x},d){const[f]=g.useState({className:s,id:l,style:a}),[p,w]=g.useState(null),y=g.useRef(void 0);g.useImperativeHandle(d,()=>p?.map??null,[p]);const b=g.useCallback(S=>{if(S!==null&&!y.current){const h=new G.Map(S,x);y.current=h,n!=null&&i!=null?h.setView(n,i):e!=null&&h.fitBounds(e,t),c!=null&&h.whenReady(c),w(we(h))}},[]);g.useEffect(()=>()=>{p?.map.remove()},[p]);const L=p?I.createElement(Le,{value:p},o):r??null;return I.createElement("div",{...f,ref:b},L)}const qe=g.forwardRef(Fe),le=Se(function({position:t,...n},o){const s=new G.Marker(t,n);return F(s,Me(o,{overlayContainer:s}))},function(t,n,o){n.position!==o.position&&t.setLatLng(n.position),n.icon!=null&&n.icon!==o.icon&&t.setIcon(n.icon),n.zIndexOffset!=null&&n.zIndexOffset!==o.zIndexOffset&&t.setZIndexOffset(n.zIndexOffset),n.opacity!=null&&n.opacity!==o.opacity&&t.setOpacity(n.opacity),t.dragging!=null&&n.draggable!==o.draggable&&(n.draggable===!0?t.dragging.enable():t.dragging.disable())}),Xe=Ce(function({url:t,...n},o){const s=new G.TileLayer(t,je(n,o));return F(s,o)},function(t,n,o){Ze(t,n,o);const{url:s}=n;s!=null&&s!==o.url&&t.setUrl(s)}),Ye=Ee(function(t,n){const o=new G.Tooltip(t,n.overlayContainer);return F(o,n)},function(t,n,{position:o},s){g.useEffect(function(){const r=n.overlayContainer;if(r==null)return;const{instance:a}=t,c=x=>{x.tooltip===a&&(o!=null&&a.setLatLng(o),a.update(),s(!0))},i=x=>{x.tooltip===a&&s(!1)};return r.on({tooltipopen:c,tooltipclose:i}),r.bindTooltip(a),function(){r.off({tooltipopen:c,tooltipclose:i}),r._map!=null&&r.unbindTooltip()}},[t,n,s,o])});function X({glyph:e,glyphColor:t="white",bgColor:n="white",glyphSize:o="8px",iconUrl:s="/Map/assets/icons/glyph-marker-icon-blue.svg",className:l,iconSize:r,prefix:a,glyphAnchor:c}){let i=o;typeof i=="number"?i=`${i}px`:typeof i=="string"&&!i.endsWith("px")?i=`${i}px`:i||(i="8px");const x=r||[25,41],d=Math.round(x[0]*(41/25)),f=Math.round(x[1]*(41/41)),p=Math.round(d*12/41),w=f;return E.icon.glyph({iconUrl:s||"/Map/assets/icons/glyph-marker-icon-blue.svg",iconSize:x,iconAnchor:[Math.round(x[0]/2),x[1]],popupAnchor:[1,-34],tooltipAnchor:[0,0],shadowUrl:"/Map/assets/icons/marker-shadow.png",shadowSize:[d,f],shadowAnchor:[p,w],prefix:a||"",glyph:e||"",glyphColor:t||"white",bgColor:n,glyphSize:i,glyphAnchor:c||[0,0],className:l||""})}function Ve({safeMarkers:e,infoButtonToggled:t,setInfoButtonToggled:n,isMobile:o,updateMarker:s,isMarkerDraggable:l}){return u.jsx(u.Fragment,{children:e.filter(r=>r.id>=1001).map(r=>{const a=t[r.id];let c=[r.lat,r.lng],i=r.iconUrl;i||(i=`${r.type||"glyph-marker-icon-blue"}.svg`),i=ae(i);const x=X({className:r.type?`marker-icon marker-type-${r.type}`:"marker-icon",prefix:r.prefix,iconUrl:i,iconSize:Array.isArray(r.iconSize)?r.iconSize:[17,28],glyph:r.glyph||"?",glyphColor:r.glyphColor||"white",glyphSize:r.glyphSize||"12px",glyphAnchor:r.glyphAnchor||[0,-5]}),d=r.logo?q(r.logo):null,f=l(r),p={...f?{dragend:w=>{const{lat:y,lng:b}=w.target.getLatLng();s(r.id,{lat:y,lng:b})}}:{}};return u.jsx(le,{position:c,icon:x,draggable:f,eventHandlers:p,children:u.jsx(Ye,{direction:"top",offset:[0,-32],opacity:1,permanent:!1,interactive:!0,children:u.jsxs("div",{className:"flex flex-col items-center",children:[d&&u.jsx("img",{src:d,alt:r.name||"Logo",style:{maxWidth:120,maxHeight:80,objectFit:"contain",borderRadius:0}}),u.jsx("span",{style:{fontWeight:600,color:"#1976d2"},children:r.name}),o&&u.jsx("button",{className:`mt-2 px-2 py-1 text-xs rounded ${a?"bg-green-500 text-white":"bg-blue-500 text-white"}`,onClick:()=>{n(w=>({...w,[r.id]:!w[r.id]}))},children:"More info"})]})})},`${r.id}-${r.coreLocked}-${r.appearanceLocked}-${r.contentLocked}-${r.adminLocked}`)})})}function ce(e="md"){const t={sm:"(max-width: 639px)",md:"(max-width: 767px)",lg:"(max-width: 1023px)",xl:"(max-width: 1279px)","2xl":"(max-width: 1535px)"},n=t[e]||t.md,[o,s]=g.useState(()=>typeof window<"u"?window.matchMedia(n).matches:!1);return g.useEffect(()=>{if(typeof window>"u")return;const l=window.matchMedia(n),r=()=>s(l.matches);return l.addEventListener("change",r),()=>l.removeEventListener("change",r)},[n]),o}function Ke({safeMarkers:e,infoButtonToggled:t,setInfoButtonToggled:n,updateMarker:o,isMarkerDraggable:s,iconCreateFunction:l}){const r=I.useRef({});return ce("md"),u.jsx(Ie,{chunkedLoading:!0,showCoverageOnHover:!0,spiderfyOnMaxZoom:!1,removeOutsideVisibleBounds:!0,disableClusteringAtZoom:18,maxClusterRadius:400,iconCreateFunction:l,children:e.filter(a=>a.id<1001).map(a=>{t[a.id];let c=[a.lat,a.lng],i=a.iconUrl;i||(i=`${a.type||"default"}.svg`),i=ae(i);const x=X({className:a.type?`marker-icon marker-type-${a.type}`:"marker-icon",prefix:a.prefix,iconUrl:i,iconSize:Array.isArray(a.iconSize)?a.iconSize:[15,25],glyph:a.glyph||"",glyphColor:a.glyphColor||"white",glyphSize:a.glyphSize||"9px",glyphAnchor:a.glyphAnchor||[0,-4]});a.logo&&q(a.logo);const d=s(a),f={...d?{dragend:p=>{const{lat:w,lng:y}=p.target.getLatLng();o(a.id,{lat:w,lng:y})}}:{}};return r.current[a.id]||(r.current[a.id]=I.createRef()),u.jsx(le,{position:c,icon:x,draggable:d,eventHandlers:f,ref:r.current[a.id]},`${a.id}-${a.coreLocked}-${a.appearanceLocked}-${a.contentLocked}-${a.adminLocked}`)})})}function Je({isAdminView:e,mapInstance:t,updateMarker:n}){const{t:o}=se(),[s,l]=g.useState(!1),[r,a]=g.useState(!1),[c,i]=g.useState(""),[x,d]=g.useState(""),f=()=>{a(!0),i(""),d("")},p=async()=>{if(!c||isNaN(Number(c))){d("Please enter a valid numeric ID.");return}if(await y(c)){d("ID already exists. Please choose another.");return}a(!1),l(!0),d("")},w=()=>{a(!1),i(""),d("")};g.useEffect(()=>{if(!s||!t||!c)return;const b=L=>{const S=L.latlng,h={...Qe({lat:S.lat,lng:S.lng}),id:Number(c)};typeof n=="function"&&n(h.id,h,{add:!0}),l(!1),i(""),t.off("click",b)};return t.on("click",b),()=>{t.off("click",b)}},[s,t,n,c]);async function y(b){try{const{supabase:L}=await Oe(async()=>{const{supabase:h}=await import("./index-RjQXOmyZ.js").then(v=>v.s);return{supabase:h}},__vite__mapDeps([0,1])),S=["Markers_Core","Markers_Appearance","Markers_Content","Markers_Admin"];for(const h of S){const{data:v,error:M}=await L.from(h).select("id").eq("id",Number(b));if(M)return!1;if(v&&v.length>0)return!0}return!1}catch{return!1}}return e?u.jsxs(u.Fragment,{children:[u.jsxs("button",{onClick:f,"aria-label":"Add marker",className:"bg-white rounded-full shadow p-2 flex items-center justify-center",style:{position:"absolute",left:10,top:60,zIndex:1001,width:44,height:44,border:"none",cursor:s?"crosshair":"pointer",background:s?"#e3f2fd":"white"},title:s?"Click on map to place marker":"Add marker",children:[u.jsx(Ne.Icon,{path:ze,size:1.5,color:"#1976d2","aria-hidden":"true",style:{width:"42px",height:"42px"}}),u.jsx("span",{className:"sr-only",children:"Add marker"})]}),r&&u.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0,0,0,0.3)",zIndex:2e3,display:"flex",alignItems:"center",justifyContent:"center"},children:u.jsxs("div",{style:{background:"white",borderRadius:8,boxShadow:"0 2px 16px rgba(25,118,210,0.15)",padding:32,minWidth:320,display:"flex",flexDirection:"column",alignItems:"center"},children:[u.jsx("h2",{style:{color:"#1976d2",fontWeight:700,marginBottom:16},children:"Enter Marker ID"}),u.jsx("input",{type:"number",value:c,onChange:b=>i(b.target.value),style:{fontSize:18,padding:"8px 12px",border:"2px solid #1976d2",borderRadius:4,marginBottom:12,width:"100%"},placeholder:"Marker ID (integer)",min:1}),x&&u.jsx("div",{style:{color:"red",marginBottom:8},children:x}),u.jsxs("div",{style:{display:"flex",gap:12},children:[u.jsx("button",{onClick:p,style:{background:"#1976d2",color:"white",border:"none",borderRadius:4,padding:"8px 20px",fontWeight:600,cursor:"pointer"},children:"Confirm"}),u.jsx("button",{onClick:w,style:{background:"#eee",color:"#1976d2",border:"none",borderRadius:4,padding:"8px 20px",fontWeight:600,cursor:"pointer"},children:"Cancel"})]})]})})]}):null}function Qe({lat:e,lng:t}){return{id:null,lat:e,lng:t,name:"",label:"",logo:"",boothNumber:"",coreLocked:!1}}function et(e){return e.getChildCount(),X({iconUrl:"/Map/assets/icons/glyph-marker-icon-orange.svg",iconSize:[50,82],glyph:`<div style='display:flex;align-items:center;justify-content:center;width:100%;height:100%;'>
  <img src='/Map/assets/logos/4x4Vakantiebeurs.png' alt='logo' style='width:40px;height:40px;object-fit:contain;display:block;margin:auto;position:relative;left:1px;top:10px;' />
      </div>`,glyphColor:"white",glyphSize:"40px",className:"custom-cluster-icon"})}var de={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},te=I.createContext&&I.createContext(de),tt=["attr","size","title"];function nt(e,t){if(e==null)return{};var n=ot(e,t),o,s;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(s=0;s<l.length;s++)o=l[s],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}function ot(e,t){if(e==null)return{};var n={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;n[o]=e[o]}return n}function H(){return H=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},H.apply(this,arguments)}function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,o)}return n}function U(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ne(Object(n),!0).forEach(function(o){at(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function at(e,t,n){return t=it(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function it(e){var t=rt(e,"string");return typeof t=="symbol"?t:t+""}function rt(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ue(e){return e&&e.map((t,n)=>I.createElement(t.tag,U({key:n},t.attr),ue(t.child)))}function Y(e){return t=>I.createElement(st,H({attr:U({},e.attr)},t),ue(e.child))}function st(e){var t=n=>{var{attr:o,size:s,title:l}=e,r=nt(e,tt),a=s||n.size||"1em",c;return n.className&&(c=n.className),e.className&&(c=(c?c+" ":"")+e.className),I.createElement("svg",H({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,o,r,{className:c,style:U(U({color:e.color||n.color},n.style),e.style),height:a,width:a,xmlns:"http://www.w3.org/2000/svg"}),l&&I.createElement("title",null,l),e.children)};return te!==void 0?I.createElement(te.Consumer,null,n=>t(n)):t(de)}function lt(e){return Y({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"},child:[]}]})(e)}function ct(e){return Y({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"},child:[]}]})(e)}function dt(e){return Y({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M19 13H5v-2h14v2z"},child:[]}]})(e)}function ut(e){return e.angle||0}function z(e,t,n){const o=n*Math.PI/180,s=e*Math.cos(o)-t*Math.sin(o),l=e*Math.sin(o)+t*Math.cos(o);return[s,l]}function P(e){return e/111320}function k(e,t){return e/(40075e3*Math.cos(t*Math.PI/180)/360)}function ft(e){return e*111320}function ht(e,t){return e*(40075e3*Math.cos(t*Math.PI/180)/360)}function gt({mapInstance:e,markers:t,rectangleSize:n,isAdminView:o,showRectanglesAndHandles:s,updateMarker:l,rectangleLayerRef:r}){if(!e)return;r.current||(r.current=E.layerGroup(),r.current.addTo(e));const a=r.current;a._markerLayers||(a._markerLayers={}),Object.keys(a._markerLayers).forEach(c=>{t.find(i=>i.id===c)||(a.removeLayer(a._markerLayers[c].rectangle),a.removeLayer(a._markerLayers[c].handle),delete a._markerLayers[c])}),t.forEach(c=>{if(c.lat&&c.lng){const i=E.latLng(c.lat,c.lng),x=Array.isArray(c.rectangle)&&c.rectangle.length===2?c.rectangle:n,d=Number(x[0])/2,f=Number(x[1])/2,p=ut(c),w="#1976d2",y=[z(-d,-f,p),z(d,-f,p),z(d,f,p),z(-d,f,p)],b=y.map(([h,v])=>E.latLng(i.lat+P(v),i.lng+k(h,i.lat)));let L,S;if(a._markerLayers[c.id]){L=a._markerLayers[c.id].rectangle,L.setLatLngs(b),S=a._markerLayers[c.id].handle;const[h,v]=y[2],M=E.latLng(i.lat+P(v),i.lng+k(h,i.lat));S.setLatLng(M)}else{L=E.polygon(b,{color:w,weight:1});const[h,v]=y[2],M=E.latLng(i.lat+P(v),i.lng+k(h,i.lat));let j;if(o&&!c.coreLocked){const O=E.divIcon({className:"rotation-handle-icon",html:'<div style="width:8px;height:8px;background:#1976d2;border-radius:50%;"></div>',iconSize:[8,8],iconAnchor:[4,4]});j=E.marker(M,{icon:O,draggable:!0,interactive:!0,keyboard:!0,title:"Drag to rotate"}),j.on("dragstart",function(){e&&e.dragging.disable()});let N=p;j.on("drag",function(R){const $=R.target.getLatLng(),m=ht($.lng-i.lng,i.lat),C=ft($.lat-i.lat);let _=Math.atan2(C,m)*180/Math.PI;_<0&&(_+=360),N=_;const V=[z(-d,-f,N),z(d,-f,N),z(d,f,N),z(-d,f,N)],fe=V.map(([ye,me])=>E.latLng(i.lat+P(me),i.lng+k(ye,i.lat)));L.setLatLngs(fe);const[he,ge]=V[2],pe=E.latLng(i.lat+P(ge),i.lng+k(he,i.lat));j.setLatLng(pe)}),j.on("dragend",function(){e&&e.dragging.enable(),l(c.id,{angle:N})})}else{const O=E.divIcon({className:"rotation-handle-icon",html:'<div style="width:8px;height:8px;background:#1976d2;border-radius:50%;opacity:0.5;"></div>',iconSize:[8,8],iconAnchor:[4,4]});j=E.marker(M,{icon:O,draggable:!1,interactive:!1,keyboard:!1,title:"Locked"})}a.addLayer(L),a.addLayer(j),a._markerLayers[c.id]={rectangle:L,handle:j}}}}),Object.values(a._markerLayers).forEach(({rectangle:c,handle:i})=>{s?(a.addLayer(c),a.addLayer(i)):(a.removeLayer(c),a.removeLayer(i))})}function oe(e,t){console.log("Analytics event:",e,t)}function pt(){const e=g.useCallback(n=>{oe("marker_view",{markerId:n,timestamp:Date.now()})},[]),t=g.useCallback(n=>{oe("map_interaction",{type:n,timestamp:Date.now()})},[]);return{trackMarkerView:e,trackMapInteraction:t}}function yt(e){e&&e.zoomIn()}function mt(e){e&&e.zoomOut()}function xt(e,t,n){e&&e.setView(t,n)}const bt={appearance:"none",WebkitAppearance:"none",MozAppearance:"none",outline:"none",background:"#fff",border:"2px solid #1976d2",borderRadius:4,width:18,height:18,display:"inline-block",position:"relative",marginRight:8,cursor:"pointer",verticalAlign:"middle"};function vt({mapInstance:e,mapCenter:t,mapZoom:n,searchControlRef:o,isAdminView:s,showLayersMenu:l,setShowLayersMenu:r,activeLayer:a,setActiveLayer:c,showRectanglesAndHandles:i,setShowRectanglesAndHandles:x,MAP_LAYERS:d}){const f=()=>yt(e),p=()=>mt(e),w=()=>xt(e,t,n);return u.jsxs("div",{style:{position:"absolute",top:10,right:10,zIndex:1e3,display:"flex",flexDirection:"column",gap:"10px"},children:[u.jsxs("button",{onClick:w,"aria-label":"Home",className:"bg-white rounded-full shadow p-2 flex items-center justify-center",style:{width:44,height:44},children:[u.jsx(lt,{size:28,color:"#1976d2","aria-hidden":"true"}),u.jsx("span",{className:"sr-only",children:"Home"})]}),u.jsxs("button",{onClick:f,"aria-label":"Zoom in",className:"bg-white rounded-full shadow p-2 mb-2 flex items-center justify-center",style:{width:44,height:44},children:[u.jsx(ct,{size:28,color:"#1976d2","aria-hidden":"true"}),u.jsx("span",{className:"sr-only",children:"Zoom in"})]}),u.jsxs("button",{onClick:p,"aria-label":"Zoom out",className:"bg-white rounded-full shadow p-2 mb-2 flex items-center justify-center",style:{width:44,height:44},children:[u.jsx(dt,{size:28,color:"#1976d2","aria-hidden":"true"}),u.jsx("span",{className:"sr-only",children:"Zoom out"})]}),s&&u.jsxs("div",{style:{position:"relative"},children:[u.jsxs("button",{"aria-label":"Map layers",className:"bg-white rounded-full shadow p-2 flex items-center justify-center mt-0 hover:bg-gray-100 focus:outline-none",style:{width:44,height:44},onClick:()=>r(y=>!y),children:[u.jsx(Ae,{path:_e,size:1.2,color:"#1976d2"}),u.jsx("span",{className:"sr-only",children:"Map layers"})]}),l&&u.jsxs("div",{className:"absolute right-0 mt-2 bg-white rounded shadow-lg border z-50",style:{minWidth:200,padding:8,color:"#1976d2"},role:"menu","aria-label":"Layer selection",children:[u.jsx("div",{className:"font-semibold mb-2",children:"Base Layers"}),d.map(y=>u.jsx("button",{className:`w-full text-left px-2 py-1 rounded hover:bg-blue-50 ${a===y.key?"bg-blue-50 font-bold":""}`,onClick:()=>c(y.key),role:"menuitem",style:{color:"#1976d2"},children:y.name},y.key)),u.jsx("div",{className:"font-semibold mt-4 mb-2",children:"Map Features"}),u.jsxs("label",{className:"flex items-center px-2 py-1 cursor-pointer hover:bg-blue-50 rounded",style:{color:"#1976d2"},children:[u.jsx("input",{type:"checkbox",checked:i,onChange:y=>x(y.target.checked),style:bt}),u.jsx("span",{style:{position:"relative",left:-26,width:18,height:18,pointerEvents:"none",display:i?"inline-block":"none"},children:u.jsx("svg",{width:"18",height:"18",viewBox:"0 0 18 18",style:{position:"absolute",top:0,left:0},children:u.jsx("polyline",{points:"4,9 8,13 14,5",stroke:"#1976d2",strokeWidth:"2.5",fill:"none"})})}),u.jsx("span",{style:{marginLeft:i?-8:0},children:"Booth Surface"})]})]})]})]})}const D=[{key:"carto",name:"Carto Voyager",attribution:'&copy; <a href="https://carto.com/attributions">Carto</a>',url:"https://cartodb-basemaps-{s}.global.ssl.fastly.net/rastertiles/voyager_nolabels/{z}/{x}/{y}.png"},{key:"esri",name:"Esri World Imagery",attribution:"Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community",url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}"}];function Lt({isAdminView:e,markersState:t,updateMarker:n}){const[o,s]=g.useState({}),[l,r]=g.useState(!1),[a,c]=g.useState(D[0].key),[i,x]=g.useState(!1),[d,f]=g.useState(null),[p,w]=g.useState(null),y=g.useRef(null),{t:b}=se(),L=ce();pt();const S=g.useMemo(()=>Array.isArray(t)?t:[],[t]),h=g.useRef(null),v=[51.898095078807025,5.772961378097534],M=17,j=v,O=M,N=[6,6];g.useEffect(()=>{S.forEach(m=>{if(m.logo){const C=new window.Image;C.src=q(m.logo)}})},[S]);function R(m){return e&&m&&m.coreLocked===!1}g.useEffect(()=>{gt({mapInstance:d,markers:S,rectangleSize:N,isAdminView:e,showRectanglesAndHandles:i,updateMarker:n,rectangleLayerRef:h})},[d,t,N,e,i]),g.useEffect(()=>{if(!d)return;let m=p;m||(m=window.L.layerGroup(),w(m)),m.clearLayers(),S.forEach(C=>{if(C.lat&&C.lng){const A=[C.name,C.boothNumber,C.label].filter(Boolean).join(" | "),_=window.L.marker([C.lat,C.lng],{opacity:0,interactive:!1});_.feature={type:"Feature",properties:{searchText:A}},_.bindPopup(C.name||C.label||""),m.addLayer(_)}})},[d,S,p]),g.useEffect(()=>{if(d&&p){const m=new E.Control.Search({layer:p,propertyName:"searchText",initial:!1,zoom:21,marker:{icon:!1,animate:!0},textPlaceholder:"Search for name or booth...",position:"topleft"});if(d.addControl(m),y.current=m,!d._minimapControl){const C=E.tileLayer(D[0].url,{attribution:"",minZoom:0,maxZoom:16}),A=new E.Control.MiniMap(C,{position:"bottomright",width:120,height:120,zoomLevelFixed:15,toggleDisplay:!0,centerFixed:v,aimingRectOptions:{color:"#1976d2",weight:2,opacity:.9,fillOpacity:.1,fill:!0},shadowRectOptions:{color:"#90caf9",weight:1,opacity:.5,fillOpacity:.05,fill:!0},strings:{hideText:"Hide MiniMap",showText:"Show MiniMap"}});A.addTo(d),d._minimapControl=A}return m.on("search:locationfound",function(C){if(C&&C.layer&&C.layer.getLatLng){const A=C.layer.getLatLng();d.flyTo(A,21,{animate:!0}),m._input&&m._input.blur(),m.hideAlert&&m.hideAlert(),m.collapse&&m.collapse()}}),()=>{d.removeControl(m),y.current=null}}},[d,p]);const $=m=>{m&&m.target?f(m.target):f(m)};return u.jsxs("div",{style:{height:"100svh",height:"100dvh",height:"100vh",width:"100vw",position:"fixed",inset:0,zIndex:0,touchAction:"pan-x pan-y",overflow:"hidden"},tabIndex:0,"aria-label":"Event Map",role:"region",children:[u.jsx(vt,{mapInstance:d,mapCenter:j,mapZoom:O,searchControlRef:y,isAdminView:e,showLayersMenu:l,setShowLayersMenu:r,activeLayer:a,setActiveLayer:c,showRectanglesAndHandles:i,setShowRectanglesAndHandles:x,MAP_LAYERS:D}),e&&u.jsx(Je,{mapInstance:d,isAdminView:e,updateMarker:n}),u.jsx("div",{id:"map-container",className:"fixed inset-0 w-full h-full",style:{zIndex:1,height:"100svh",height:"100dvh",height:"100vh",touchAction:"pan-x pan-y",overflow:"hidden"},"aria-label":b("map.ariaLabel"),children:u.jsxs(qe,{center:v,zoom:M,minZoom:14,maxZoom:22,zoomDelta:.5,zoomSnap:.5,zoomControl:!1,style:{width:"100vw",height:"100vh"},className:"focus:outline-none focus:ring-2 focus:ring-primary",whenReady:$,attributionControl:!1,children:[D.filter(m=>m.key===a).map(m=>u.jsx(Xe,{attribution:m.attribution,url:m.url,maxZoom:22},m.key)),u.jsx(Ke,{safeMarkers:S,infoButtonToggled:o,setInfoButtonToggled:s,isMobile:L,updateMarker:n,isMarkerDraggable:R,iconCreateFunction:et}),u.jsx(Ve,{safeMarkers:S,infoButtonToggled:o,setInfoButtonToggled:s,isMobile:L,updateMarker:n,isMarkerDraggable:R})]})})]})}export{Lt as default};
