import{r as n,j as e}from"./index-f3aaddb5.js";import{r as f,u as b}from"./exceljs.min-df4f794b.js";function y(){const[t,i]=n.useState([]),[a,o]=n.useState(!1),[h,s]=n.useState(""),p=async r=>{var x;const d=(x=r.target.files)==null?void 0:x[0];if(d){o(!0),s("Reading file..."),i([]);try{s("Parsing Excel data...");const l=await d.arrayBuffer();s("Processing workbook...");const m=f(l,{type:"array"});s("Extracting data...");const u=m.Sheets[m.SheetNames[0]],g=b.sheet_to_json(u,{defval:""});i(g),o(!1),s("")}catch(l){console.error("Error parsing Excel file:",l),o(!1),s("Error loading file"),setTimeout(()=>s(""),3e3)}}},c=async()=>{t!=null&&t.length&&(Object.keys(t[0]||{}).map(r=>({key:r,header:r,type:"text"})),await c())};return e.jsxs("div",{className:"p-4 space-y-4 bg-white rounded shadow-sm",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Upload Excel"}),e.jsx("input",{"data-testid":"file-input",className:"block w-full text-sm text-gray-900 border rounded p-2",type:"file",accept:".xlsx,.xls,.csv",onChange:p,disabled:a}),a&&e.jsxs("div",{className:"flex items-center space-x-2 p-3 bg-blue-50 rounded border border-blue-200",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),e.jsx("span",{className:"text-sm text-blue-700",children:h})]}),t.length>0&&!a&&e.jsx("div",{className:"flex gap-3 pt-2",children:e.jsx("button",{"data-testid":"export-btn",onClick:c,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors",children:"Export to Excel"})}),t.length>0&&!a&&e.jsxs("div",{className:"transition-all duration-300 ease-in-out",children:[e.jsxs("h3",{className:"text-sm font-semibold mb-2",children:["Preview (",t.length," rows)"]}),e.jsx("div",{className:"bg-gray-50 rounded border",children:e.jsx("pre",{"data-testid":"preview",className:"text-xs p-3 max-h-48 overflow-auto",style:{maxHeight:"12rem",transition:"max-height 0.3s ease-in-out"},children:JSON.stringify(t.slice(0,20),null,2)})}),t.length>20&&e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Showing first 20 rows of ",t.length," total"]})]}),t.length===0&&!a&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48",children:e.jsx("path",{d:"M34 40h10v-4a6 6 0 00-10.712-3.714M34 40H14m20 0v-4a9.971 9.971 0 00-.712-3.714M14 40H4v-4a6 6 0 0110.713-3.714M14 40v-4a9.971 9.971 0 01.712-3.714M34 40v-4c0-1.313.253-2.566.713-3.714m0 0A10.003 10.003 0 0124 36c-2.186 0-4.216.682-5.713 1.843",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2"})}),e.jsx("p",{className:"mt-2",children:"Upload an Excel file to see preview"})]})]})}export{y as default};
