import{r as c,s as u,u as ae,a1 as ge,R as e,M as fe,I as E,aQ as te,aR as se,aS as re,aT as ne,am as be,aU as pe,aV as ce,a3 as le,aW as oe,au as ie,ap as xe,ak as ye,i as he}from"./index-1e4c7e6c.js";import{u as me}from"./useUserRole-6e97074a.js";function de(){const[s,R]=c.useState([]),[M,r]=c.useState(!0),[k,_]=c.useState(null),[v,L]=c.useState(null),[U,$]=c.useState(new Set);c.useEffect(()=>{(async()=>{const{data:{user:a}}=await u.auth.getUser();L((a==null?void 0:a.id)||null)})()},[]);const h=c.useCallback(async(l={})=>{try{r(!0),_(null);let a=u.from("feedback_requests").select("*").order("created_at",{ascending:!1});l.type&&(a=a.eq("type",l.type)),l.status&&(a=a.eq("status",l.status)),l.userId&&(a=a.eq("user_id",l.userId));const{data:o,error:n}=await a;if(n)throw n;if(R(o||[]),v){const{data:i}=await u.from("feedback_votes").select("request_id").eq("user_id",v);$(new Set((i==null?void 0:i.map(p=>p.request_id))||[]))}}catch(a){console.error("Error loading feedback requests:",a),_(a.message)}finally{r(!1)}},[v]),D=async l=>{try{const{data:{user:a}}=await u.auth.getUser();if(!a)throw new Error("User not authenticated");const{data:o,error:n}=await u.from("feedback_requests").insert({user_id:a.id,user_email:a.email,type:l.type,title:l.title,description:l.description||""}).select().single();if(n)throw n;return await h(),{data:o,error:null}}catch(a){return console.error("Error creating request:",a),{data:null,error:a.message}}},A=async(l,a)=>{try{const{data:o,error:n}=await u.from("feedback_requests").update(a).eq("id",l).select().single();if(n)throw n;return await h(),{data:o,error:null}}catch(o){return console.error("Error updating request:",o),{data:null,error:o.message}}},K=async l=>{try{const{error:a}=await u.from("feedback_requests").delete().eq("id",l);if(a)throw a;return await h(),{error:null}}catch(a){return console.error("Error deleting request:",a),{error:a.message}}},B=async l=>{try{const{data:{user:a}}=await u.auth.getUser();if(!a)throw new Error("User not authenticated");const{error:o}=await u.from("feedback_votes").insert({request_id:l,user_id:a.id});if(o)throw o;return $(n=>new Set([...n,l])),R(n=>n.map(i=>i.id===l?{...i,votes:i.votes+1}:i)),{error:null}}catch(a){return console.error("Error adding vote:",a),{error:a.message}}},z=async l=>{try{const{data:{user:a}}=await u.auth.getUser();if(!a)throw new Error("User not authenticated");const{error:o}=await u.from("feedback_votes").delete().eq("request_id",l).eq("user_id",a.id);if(o)throw o;return $(n=>{const i=new Set(n);return i.delete(l),i}),R(n=>n.map(i=>i.id===l?{...i,votes:Math.max(0,i.votes-1)}:i)),{error:null}}catch(a){return console.error("Error removing vote:",a),{error:a.message}}},b=async l=>{try{const{data:a,error:o}=await u.from("feedback_comments").select("*").eq("request_id",l).order("created_at",{ascending:!0});if(o)throw o;return{data:a||[],error:null}}catch(a){return console.error("Error loading comments:",a),{data:[],error:a.message}}},w=async(l,a)=>{try{const{data:{user:o}}=await u.auth.getUser();if(!o)throw new Error("User not authenticated");const{data:n,error:i}=await u.from("feedback_comments").insert({request_id:l,user_id:o.id,user_email:o.email,comment:a}).select().single();if(i)throw i;return R(p=>p.map(x=>x.id===l?{...x,comments_count:x.comments_count+1}:x)),{data:n,error:null}}catch(o){return console.error("Error adding comment:",o),{data:null,error:o.message}}},g=async(l,a)=>{try{const{error:o}=await u.from("feedback_comments").delete().eq("id",l);if(o)throw o;return R(n=>n.map(i=>i.id===a?{...i,comments_count:Math.max(0,i.comments_count-1)}:i)),{error:null}}catch(o){return console.error("Error deleting comment:",o),{error:o.message}}};return c.useEffect(()=>{const l=u.channel("feedback_requests_changes").on("postgres_changes",{event:"*",schema:"public",table:"feedback_requests"},()=>{h()}).subscribe(),a=u.channel("feedback_votes_changes").on("postgres_changes",{event:"*",schema:"public",table:"feedback_votes"},n=>{(n!=null&&n.new||n!=null&&n.old)&&R(i=>{var N,P;const p=[...i],x=((N=n.new)==null?void 0:N.request_id)||((P=n.old)==null?void 0:P.request_id);return p.findIndex(F=>F.id===x)!==-1&&h(),p})}).subscribe(),o=u.channel("feedback_comments_changes").on("postgres_changes",{event:"*",schema:"public",table:"feedback_comments"},n=>{var i,p;if(n!=null&&n.new||n!=null&&n.old){const x=((i=n.new)==null?void 0:i.request_id)||((p=n.old)==null?void 0:p.request_id);R(V=>V.map(N=>N.id===x?{...N}:N)),h()}}).subscribe();return()=>{u.removeChannel(l),u.removeChannel(a),u.removeChannel(o)}},[h]),{requests:s,loading:M,error:k,userVotes:U,currentUserId:v,loadRequests:h,createRequest:D,updateRequest:A,deleteRequest:K,addVote:B,removeVote:z,loadComments:b,addComment:w,deleteComment:g}}function Ee({request:s,onClose:R,onUpdate:M}){const{t:r}=ae(),{role:k}=me(),{confirm:_}=ge(),v=k==="super_admin",{userVotes:L,currentUserId:U,addVote:$,removeVote:h,loadComments:D,addComment:A,deleteComment:K,updateRequest:B}=de(),[z,b]=c.useState([]),[w,g]=c.useState(""),[l,a]=c.useState(!0),[o,n]=c.useState(!1),[i,p]=c.useState(!1),[x,V]=c.useState(s.status),[N,P]=c.useState(s.priority||""),[F,J]=c.useState(s.version_completed||""),[O,q]=c.useState(!1),[Q,I]=c.useState(s.votes),[W,T]=c.useState(s.comments_count||0);c.useEffect(()=>{I(s.votes),T(s.comments_count||0)},[s.id,s.votes,s.comments_count]),c.useEffect(()=>{(async()=>{a(!0);const{data:f}=await D(s.id);b(f||[]),a(!1)})()},[s.id]);const H=async()=>{if(L.has(s.id)){const{error:m}=await h(s.id);m||I(f=>Math.max(0,f-1))}else{const{error:m}=await $(s.id);m||I(f=>f+1)}},G=async m=>{if(m.preventDefault(),!w.trim())return;n(!0);const{data:f,error:C}=await A(s.id,w.trim());!C&&f&&(b([...z,f]),g(""),T(y=>y+1)),n(!1)},X=async m=>{if(!await _({title:r("settings.feedbackRequests.detail.deleteComment"),message:r("common.confirmDelete"),confirmText:r("common.delete"),variant:"danger"}))return;const{error:C}=await K(m,s.id);C||(b(z.filter(y=>y.id!==m)),T(y=>Math.max(0,y-1)))},Y=async()=>{q(!0);const m={status:x,priority:N||null,version_completed:F||null};x==="completed"&&s.status!=="completed"&&(m.completed_at=new Date().toISOString(),m.completed_by=U);const{error:f,data:C}=await B(s.id,m);f||(p(!1),M&&M(C)),q(!1)},j=m=>{if(!m)return"open";switch(m.toLowerCase()){case"in_progress":case"inprogress":case"in progress":return"in_progress";case"completed":return"completed";case"archived":return"archived";case"open":default:return"open"}},Z=m=>{switch(j(m),m){case"completed":return ie;case"in_progress":return oe;case"archived":return le;default:return ce}},ee=m=>{switch(j(m)){case"completed":return"text-green-600";case"in_progress":return"text-blue-600";case"archived":return"text-gray-400";default:return"text-yellow-600"}};return e.createElement(fe,{isOpen:!0,onClose:R,size:"lg",showCloseButton:!1},e.createElement("div",{className:"bg-gray-50 border-b border-gray-200 px-6 py-4"},e.createElement("div",{className:"flex-1"},e.createElement("div",{className:"flex items-center gap-2 mb-2"},e.createElement("span",{className:`inline-flex items-center px-2 py-1 rounded text-xs font-medium ${s.type==="issue"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`},e.createElement(E,{path:s.type==="issue"?te:se,size:.5,className:"mr-1"}),r(`settings.feedbackRequests.types.${s.type}`))),e.createElement("h2",{className:"text-xl font-bold text-gray-900"},s.title),e.createElement("div",{className:"flex items-center gap-4 text-xs text-gray-500 mt-2"},e.createElement("span",null,s.user_email),e.createElement("span",null,new Date(s.created_at).toLocaleDateString()),s.version_completed&&!i&&e.createElement("span",{className:"text-green-600 font-medium"},"v",s.version_completed)))),e.createElement("div",{className:"px-6 py-4"},s.description&&e.createElement("div",{className:"mb-6"},e.createElement("p",{className:"text-gray-700 whitespace-pre-wrap"},s.description)),v&&e.createElement("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg text-left flex flex-col"},e.createElement("div",{className:"flex items-center justify-between mb-3"},e.createElement("h3",{className:"font-semibold text-blue-900"},r("settings.feedbackRequests.detail.status")),i?e.createElement("div",{className:"flex gap-2"},e.createElement("button",{onClick:()=>p(!1),className:"text-sm text-gray-600 hover:text-gray-700"},r("common.cancel")),e.createElement("button",{onClick:Y,disabled:O,className:"text-sm text-blue-600 hover:text-blue-700 font-medium"},r(O?"common.saving":"common.save"))):e.createElement("button",{onClick:()=>p(!0),className:"text-sm text-blue-600 hover:text-blue-700"},r("common.edit"))),(()=>{const m={open:"open",in_progress:"inProgress",completed:"completed",archived:"archived"},f=j(s.status),C=m[f]||"open";return e.createElement("div",{className:"mt-2 space-y-4"},e.createElement("div",{className:"flex flex-col"},e.createElement("label",{htmlFor:"feedback-status-select",className:"text-sm font-medium text-gray-700 mb-1"},r("settings.feedbackRequests.detail.statusCurrent")||r("settings.feedbackRequests.detail.status")||"Status"),i?e.createElement("select",{id:"feedback-status-select","aria-label":r("settings.feedbackRequests.detail.statusAriaEdit")||"Edit status",value:x,onChange:y=>V(y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm"},e.createElement("option",{value:"open"},r("settings.feedbackRequests.statuses.open")),e.createElement("option",{value:"in_progress"},r("settings.feedbackRequests.statuses.inProgress")),e.createElement("option",{value:"completed"},r("settings.feedbackRequests.statuses.completed")),e.createElement("option",{value:"archived"},r("settings.feedbackRequests.statuses.archived"))):e.createElement("span",{role:"status","data-testid":"feedback-status-badge","aria-label":`Current status: ${r(`settings.feedbackRequests.statuses.${C}`)}`,className:`inline-flex items-center gap-2 px-2 py-1 rounded-md border text-sm font-medium ${ee(f)}`},e.createElement(E,{path:Z(f),size:.8}),r(`settings.feedbackRequests.statuses.${C}`))),e.createElement("div",{className:"flex flex-col"},e.createElement("label",{className:"text-sm font-medium text-gray-700 mb-1"},r("settings.feedbackRequests.detail.priority")),i?e.createElement("select",{value:N,onChange:y=>P(y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm","aria-label":r("settings.feedbackRequests.detail.priorityAriaEdit")||"Edit priority"},e.createElement("option",{value:""},r("settings.feedbackRequests.priorities.none")||"No priority"),e.createElement("option",{value:"low"},r("settings.feedbackRequests.priorities.low")),e.createElement("option",{value:"medium"},r("settings.feedbackRequests.priorities.medium")),e.createElement("option",{value:"high"},r("settings.feedbackRequests.priorities.high"))):e.createElement("span",{className:`inline-flex items-center gap-2 px-2 py-1 rounded-md border text-sm font-medium ${s.priority==="high"?"border-red-300 bg-red-50 text-red-700":s.priority==="medium"?"border-yellow-300 bg-yellow-50 text-yellow-700":s.priority==="low"?"border-green-300 bg-green-50 text-green-700":"border-gray-300 bg-white text-gray-600"}`,"data-testid":"feedback-priority-badge",role:"status","aria-label":`Current priority: ${s.priority?r(`settings.feedbackRequests.priorities.${s.priority}`):r("settings.feedbackRequests.priorities.none")||"No priority"}`},s.priority?r(`settings.feedbackRequests.priorities.${s.priority}`):r("settings.feedbackRequests.priorities.none")||"No priority")),i&&e.createElement("div",{className:"flex flex-col"},e.createElement("label",{className:"text-sm font-medium text-gray-700 mb-1"},r("settings.feedbackRequests.detail.version")),e.createElement("input",{type:"text",value:F,onChange:y=>J(y.target.value),placeholder:"e.g., 1.2.0",className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm"})))})()),e.createElement("div",{className:"mb-6"},e.createElement("button",{onClick:H,className:`flex items-center gap-2 px-4 py-2 rounded-lg border transition-colors ${L.has(s.id)?"bg-blue-50 border-blue-500 text-blue-700":"bg-white border-gray-300 text-gray-700 hover:bg-gray-50"}`},e.createElement(E,{path:re,size:.8}),e.createElement("span",{className:"font-medium"},L.has(s.id)?r("common.voted"):r("common.vote")),e.createElement("span",{className:"text-sm","aria-label":`Total votes: ${Q}`},"(",Q,")"))),e.createElement("div",null,e.createElement("h3",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2"},e.createElement(E,{path:ne,size:.8}),r("settings.feedbackRequests.detail.comments")," (",W,")"),l?e.createElement("div",{className:"text-center py-4 text-gray-500"},r("common.loading")):z.length===0?e.createElement("p",{className:"text-gray-500 text-sm mb-4"},r("settings.feedbackRequests.detail.noComments")):e.createElement("div",{className:"space-y-3 mb-4"},z.map(m=>e.createElement("div",{key:m.id,className:"bg-gray-50 rounded-lg p-3"},e.createElement("div",{className:"flex items-start justify-between mb-2"},e.createElement("div",{className:"text-sm"},e.createElement("span",{className:"font-medium text-gray-900"},m.user_email),e.createElement("span",{className:"text-gray-500 ml-2"},new Date(m.created_at).toLocaleDateString())),(m.user_id===U||v)&&e.createElement("button",{onClick:()=>X(m.id),className:"text-red-600 hover:text-red-700"},e.createElement(E,{path:be,size:.6}))),e.createElement("p",{className:"text-gray-700 text-sm whitespace-pre-wrap"},m.comment)))),e.createElement("form",{onSubmit:G,className:"flex gap-2"},e.createElement("input",{type:"text",value:w,onChange:m=>g(m.target.value),placeholder:r("settings.feedbackRequests.detail.addComment"),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.createElement("button",{type:"submit",disabled:o||!w.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2"},e.createElement(E,{path:pe,size:.7}),r("settings.feedbackRequests.detail.postComment"))))))}function Ne(){const{t:s}=ae(),{role:R}=me(),M=R==="super_admin",{preferences:r,loading:k,updatePreference:_}=xe(),{requests:v,loading:L,error:U,userVotes:$,currentUserId:h,loadRequests:D,createRequest:A,updateRequest:K,addVote:B,removeVote:z}=de(),[b,w]=c.useState("all"),[g,l]=c.useState([]),[a,o]=c.useState([]),[n,i]=c.useState(""),[p,x]=c.useState(null),[V,N]=c.useState(!1),[P,F]=c.useState(!1),J=c.useRef(null),O=c.useRef(null),[q,Q]=c.useState(!1);c.useEffect(()=>{r&&!k&&(w(r.feedback_active_tab||"all"),l(r.feedback_filter_types||[]),o(r.feedback_filter_statuses||[]),Q(!0),console.log("FeedbackRequests: Preferences loaded and applied (sync)"))},[r,k]),c.useEffect(()=>{const t=d=>{J.current&&!J.current.contains(d.target)&&N(!1),O.current&&!O.current.contains(d.target)&&F(!1)};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[]);const[I,W]=c.useState("feature"),[T,H]=c.useState(""),[G,X]=c.useState(""),[Y,j]=c.useState(!1);c.useEffect(()=>{const t={};b==="my"&&h&&(t.userId=h),D(t)},[b,h,D]),c.useEffect(()=>{if(r&&!k&&q&&b!==r.feedback_active_tab){console.log("FeedbackRequests: Saving activeTab",b);const t=setTimeout(()=>{_("feedback_active_tab",b),console.log("FeedbackRequests: activeTab saved")},500);return()=>clearTimeout(t)}},[b,r,k,q,_]),c.useEffect(()=>{if(r&&!k&&q&&JSON.stringify(g)!==JSON.stringify(r.feedback_filter_types)){console.log("FeedbackRequests: Saving filterTypes",g);const t=setTimeout(()=>{_("feedback_filter_types",g),console.log("FeedbackRequests: filterTypes saved")},500);return()=>clearTimeout(t)}},[g,r,k,q,_]),c.useEffect(()=>{if(r&&!k&&q&&JSON.stringify(a)!==JSON.stringify(r.feedback_filter_statuses)){console.log("FeedbackRequests: Saving filterStatuses",a);const t=setTimeout(()=>{_("feedback_filter_statuses",a),console.log("FeedbackRequests: filterStatuses saved")},500);return()=>clearTimeout(t)}},[a,r,k,q,_]);const Z=v.filter(t=>{var d;if(n){const S=n.toLowerCase();if(!(t.title.toLowerCase().includes(S)||((d=t.description)==null?void 0:d.toLowerCase().includes(S))||t.user_email.toLowerCase().includes(S)))return!1}if(g.length>0&&!g.includes(t.type))return!1;if(a.length>0){const S=t.status||"open";if(!a.includes(S))return!1}return!0}),ee=async t=>{$.has(t)?await z(t):await B(t)},m=async t=>{if(t.preventDefault(),!T.trim())return;j(!0);const{error:d}=await A({type:I,title:T.trim(),description:G.trim()});d||(H(""),X(""),w("all")),j(!1)},f=t=>{switch(t){case"completed":return ie;case"in_progress":return oe;case"archived":return le;default:return ce}},C=t=>{switch(t){case"completed":return"text-green-600";case"in_progress":return"text-blue-600";case"archived":return"text-gray-400";default:return"text-yellow-600"}},y=t=>{if(!t)return"open";const d=t.toLowerCase();return d==="in_progress"||d==="inprogress"||d==="in progress"?"inProgress":d==="completed"?"completed":d==="archived"?"archived":"open"},ue=t=>t==="issue"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800";return L&&v.length===0?e.createElement("div",{className:"flex items-center justify-center p-8"},e.createElement("div",{className:"text-gray-500"},s("common.loading"))):e.createElement("div",{className:"space-y-6"},e.createElement("div",null,e.createElement("h2",{className:"text-2xl font-bold text-gray-900"},s("settings.feedbackRequests.title")),e.createElement("p",{className:"mt-1 text-sm text-gray-600"},s("settings.feedbackRequests.description"))),e.createElement("div",{className:"border-b border-gray-200"},e.createElement("nav",{className:"-mb-px flex space-x-8"},e.createElement("button",{onClick:()=>w("all"),className:`py-4 px-1 border-b-2 font-medium text-sm ${b==="all"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`},s("settings.feedbackRequests.tabs.all")),e.createElement("button",{onClick:()=>w("my"),className:`py-4 px-1 border-b-2 font-medium text-sm ${b==="my"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`},s("settings.feedbackRequests.tabs.myRequests")),e.createElement("button",{onClick:()=>w("submit"),className:`py-4 px-1 border-b-2 font-medium text-sm ${b==="submit"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`},e.createElement(E,{path:ye,size:.7,className:"inline mr-1"}),s("settings.feedbackRequests.tabs.submit")))),(b==="all"||b==="my")&&e.createElement("div",{className:"bg-gray-50 p-4 rounded-lg space-y-4"},e.createElement("div",{className:"flex items-center gap-2 text-sm text-gray-700"},e.createElement(E,{path:he,size:.8}),e.createElement("span",{className:"font-medium"},s("settings.feedbackRequests.filters.title"))),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4"},e.createElement("input",{type:"text",placeholder:s("settings.feedbackRequests.filters.search"),value:n,onChange:t=>i(t.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.createElement("div",{className:"relative",ref:J},e.createElement("button",{type:"button",onClick:()=>N(!V),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white text-left flex items-center justify-between"},e.createElement("span",{className:"text-sm text-gray-900"},g.length===0?s("settings.feedbackRequests.filters.allTypes"):g.length===1?s(`settings.feedbackRequests.types.${g[0]}`):`${g.length} ${s("settings.feedbackRequests.filters.selectedTypes")||"selected types"}`),e.createElement("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"}))),V&&e.createElement("div",{className:"absolute z-10 mt-1 w-full bg-white border border-gray-300 rounded-md shadow-lg"},e.createElement("div",{className:"p-2 space-y-1"},e.createElement("label",{className:"flex items-center px-2 py-1 hover:bg-gray-50 cursor-pointer"},e.createElement("input",{type:"checkbox",checked:g.length===0,onChange:()=>l([]),className:"mr-2"}),e.createElement("span",{className:"text-sm text-gray-900"},s("settings.feedbackRequests.filters.allTypes"))),["issue","feature"].map(t=>e.createElement("label",{key:t,className:"flex items-center px-2 py-1 hover:bg-gray-50 cursor-pointer"},e.createElement("input",{type:"checkbox",checked:g.includes(t),onChange:d=>{d.target.checked?l([...g,t]):l(g.filter(S=>S!==t))},className:"mr-2"}),e.createElement("span",{className:"text-sm text-gray-900"},s(`settings.feedbackRequests.types.${t}`))))))),e.createElement("div",{className:"relative",ref:O},e.createElement("button",{type:"button",onClick:()=>F(!P),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white text-left flex items-center justify-between"},e.createElement("span",{className:"text-sm text-gray-900"},a.length===0?s("settings.feedbackRequests.filters.allStatuses"):a.length===1?s(`settings.feedbackRequests.statuses.${y(a[0])}`):`${a.length} ${s("settings.feedbackRequests.filters.selectedStatuses")}`),e.createElement("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"}))),P&&e.createElement("div",{className:"absolute z-10 mt-1 w-full bg-white border border-gray-300 rounded-md shadow-lg"},e.createElement("div",{className:"p-2 space-y-1"},e.createElement("label",{className:"flex items-center px-2 py-1 hover:bg-gray-50 cursor-pointer"},e.createElement("input",{type:"checkbox",checked:a.length===0,onChange:()=>o([]),className:"mr-2"}),e.createElement("span",{className:"text-sm text-gray-900"},s("settings.feedbackRequests.filters.allStatuses"))),["open","in_progress","completed","archived"].map(t=>e.createElement("label",{key:t,className:"flex items-center px-2 py-1 hover:bg-gray-50 cursor-pointer"},e.createElement("input",{type:"checkbox",checked:a.includes(t),onChange:d=>{d.target.checked?o([...a,t]):o(a.filter(S=>S!==t))},className:"mr-2"}),e.createElement("span",{className:"text-sm text-gray-900"},s(`settings.feedbackRequests.statuses.${y(t)}`))))))))),b==="submit"?e.createElement("div",{className:"bg-white border border-gray-200 rounded-lg p-6"},e.createElement("h3",{className:"text-lg font-semibold mb-4"},s("settings.feedbackRequests.submit.title")),e.createElement("form",{onSubmit:m,className:"space-y-4"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},s("settings.feedbackRequests.submit.type")),e.createElement("div",{className:"flex gap-4"},e.createElement("label",{className:"flex items-center"},e.createElement("input",{type:"radio",value:"feature",checked:I==="feature",onChange:t=>W(t.target.value),className:"mr-2"}),e.createElement(E,{path:se,size:.8,className:"mr-1 text-blue-600"}),s("settings.feedbackRequests.types.feature")),e.createElement("label",{className:"flex items-center"},e.createElement("input",{type:"radio",value:"issue",checked:I==="issue",onChange:t=>W(t.target.value),className:"mr-2"}),e.createElement(E,{path:te,size:.8,className:"mr-1 text-red-600"}),s("settings.feedbackRequests.types.issue")))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},s("settings.feedbackRequests.submit.title")," *"),e.createElement("input",{type:"text",value:T,onChange:t=>H(t.target.value),placeholder:s("settings.feedbackRequests.submit.titlePlaceholder"),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},s("settings.feedbackRequests.submit.description")),e.createElement("textarea",{value:G,onChange:t=>X(t.target.value),placeholder:s("settings.feedbackRequests.submit.descriptionPlaceholder"),rows:5,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})),T&&e.createElement("div",{className:"text-sm text-gray-600 bg-blue-50 p-3 rounded"},"ðŸ’¡ ",s("settings.feedbackRequests.submit.duplicateHint")),e.createElement("button",{type:"submit",disabled:Y||!T.trim(),className:"w-full px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed"},s(Y?"common.saving":"settings.feedbackRequests.submit.button")))):e.createElement("div",{className:"space-y-3"},U&&e.createElement("div",{className:"bg-red-50 text-red-800 p-4 rounded-lg"},U),Z.length===0?e.createElement("div",{className:"text-center py-12 text-gray-500"},s("settings.feedbackRequests.noRequests")):Z.map(t=>e.createElement("div",{key:t.id,className:"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow cursor-pointer",onClick:()=>x(t)},e.createElement("div",{className:"flex items-start justify-between"},e.createElement("div",{className:"flex-1"},e.createElement("div",{className:"flex items-center gap-2 mb-2"},e.createElement("span",{className:`inline-flex items-center px-2 py-1 rounded text-xs font-medium ${ue(t.type)}`},e.createElement(E,{path:t.type==="issue"?te:se,size:.5,className:"mr-1"}),s(`settings.feedbackRequests.types.${t.type}`)),e.createElement("span",{className:`inline-flex items-center gap-1 text-sm ${C(t.status)}`,role:"status","data-testid":"feedback-status-list-badge","aria-label":`Status: ${s(`settings.feedbackRequests.statuses.${y(t.status)}`)}`},e.createElement(E,{path:f(t.status),size:.6}),s(`settings.feedbackRequests.statuses.${y(t.status)}`)),t.priority&&M&&e.createElement("span",{className:"text-xs text-gray-500"},s(`settings.feedbackRequests.priorities.${t.priority}`))),e.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-1"},t.title),t.description&&e.createElement("p",{className:"text-sm text-gray-600 line-clamp-2 mb-2"},t.description),e.createElement("div",{className:"flex items-center gap-4 text-xs text-gray-500"},e.createElement("span",null,t.user_email),e.createElement("span",null,new Date(t.created_at).toLocaleDateString()),t.version_completed&&e.createElement("span",{className:"text-green-600 font-medium"},"v",t.version_completed))),e.createElement("div",{className:"flex flex-col items-end gap-2 ml-4"},e.createElement("button",{onClick:d=>{d.stopPropagation(),ee(t.id)},className:`flex items-center gap-1 px-3 py-1 rounded-full border ${$.has(t.id)?"bg-blue-50 border-blue-500 text-blue-700":"bg-white border-gray-300 text-gray-700 hover:bg-gray-50"}`},e.createElement(E,{path:re,size:.6}),e.createElement("span",{className:"font-medium"},t.votes)),e.createElement("div",{className:"flex items-center gap-1 text-gray-600"},e.createElement(E,{path:ne,size:.6}),e.createElement("span",{className:"text-sm"},t.comments_count))))))),p&&e.createElement(Ee,{request:p,onClose:()=>x(null),onUpdate:t=>{if(t){const d=v.findIndex(S=>S.id===t.id);d!==-1&&(v[d]={...v[d],...t})}x(null),D()}}))}export{Ne as default};
