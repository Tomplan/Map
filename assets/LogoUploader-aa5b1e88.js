import{s as v,r as p,R as e,g as F,I as u,am as z,an as A,ao as I,aj as M,k as j,P as n}from"./index-1e4c7e6c.js";const d="Logos",P=5*1024*1024,B=["image/png","image/jpeg","image/jpg","image/webp","image/avif","image/svg+xml"];async function C(t,s="companies"){try{const r=U(t);if(!r.valid)return{error:r.error};const a=t.name.split(".").pop(),f=Date.now(),E=Math.random().toString(36).substring(2,8),m=`${f}_${E}.${a}`,i=s?`${s}/${m}`:m,{data:x,error:o}=await v.storage.from(d).upload(i,t,{cacheControl:"3600",upsert:!1});if(o)return console.error("Upload error:",o),{error:`Upload failed: ${o.message}`};const{data:{publicUrl:l}}=v.storage.from(d).getPublicUrl(i);return{url:l,path:i,error:null}}catch(r){return console.error("Upload service error:",r),{error:`Upload failed: ${r.message}`}}}function U(t){return t?B.includes(t.type)?t.size>P?{valid:!1,error:`File too large. Maximum size: ${P/1024/1024}MB`}:{valid:!0,error:null}:{valid:!1,error:"Invalid file type. Allowed: PNG, JPG, WEBP, AVIF, SVG"}:{valid:!1,error:"No file selected"}}async function R(){try{const{data:t,error:s}=await v.storage.listBuckets();return s?{exists:!1,error:`Error accessing storage: ${s.message}`}:(t==null?void 0:t.some(a=>a.name===d))?{exists:!0,error:null}:{exists:!1,error:`Storage bucket "${d}" not found. Available buckets: ${(t==null?void 0:t.map(a=>a.name).join(", "))||"none"}`}}catch(t){return{exists:!1,error:`Error checking storage bucket: ${t.message}`}}}function $({currentLogo:t="",onUploadComplete:s,onDelete:r,folder:a="companies",label:f="Upload Logo",showPreview:E=!0,allowDelete:m=!1}){const[i,x]=p.useState(!1),[o,l]=p.useState(null),[w,c]=p.useState(""),b=p.useRef(null),y=async L=>{var S;const h=(S=L.target.files)==null?void 0:S[0];if(!h)return;l(null),c("");const N=U(h);if(!N.valid){l("error"),c(N.error);return}x(!0);const g=await C(h,a);x(!1),g.error?(l("error"),c(g.error)):(l("success"),c("Upload successful!"),s&&s(g.url,g.path),setTimeout(()=>{l(null),c("")},3e3)),b.current&&(b.current.value="")},k=()=>{r&&r()};return e.createElement("div",{className:"flex flex-col gap-2"},E&&t&&e.createElement("div",{className:"flex items-center gap-2 mb-2"},e.createElement("img",{src:F(t),alt:"Current logo",className:"h-12 w-12 object-contain border rounded p-1"}),m&&r&&e.createElement("button",{type:"button",onClick:k,className:"p-2 text-red-600 hover:bg-red-50 rounded",title:"Remove logo"},e.createElement(u,{path:z,size:.7}))),e.createElement("div",{className:"flex items-center gap-2"},e.createElement("input",{ref:b,type:"file",accept:"image/png,image/jpeg,image/jpg,image/webp,image/avif,image/svg+xml",onChange:y,className:"hidden",id:`logo-upload-${a}`}),e.createElement("label",{htmlFor:`logo-upload-${a}`,className:`
            flex items-center gap-1 px-2 py-1 rounded cursor-pointer text-xs
            ${i?"bg-gray-400":"bg-blue-600 hover:bg-blue-700"}
            text-white transition-colors whitespace-nowrap
          `},i?e.createElement(e.Fragment,null,e.createElement(u,{path:A,size:.8,spin:!0}),"Uploading..."):e.createElement(e.Fragment,null,e.createElement(u,{path:I,size:.8}),f)),o&&e.createElement("div",{className:"flex items-center gap-2"},o==="success"&&e.createElement("div",{className:"flex items-center gap-1 text-green-600"},e.createElement(u,{path:M,size:.8}),e.createElement("span",{className:"text-sm"},w)),o==="error"&&e.createElement("div",{className:"flex items-center gap-1 text-red-600"},e.createElement(u,{path:j,size:.8}),e.createElement("span",{className:"text-sm"},w)))),e.createElement("p",{className:"text-xs text-gray-500"},"Supported: PNG, JPG, WEBP, AVIF, SVG â€¢ Max size: 5MB"))}$.propTypes={currentLogo:n.string,onUploadComplete:n.func.isRequired,onDelete:n.func,folder:n.string,label:n.string,showPreview:n.bool,allowDelete:n.bool};$.defaultProps={currentLogo:"",onDelete:null,folder:"companies",label:"Upload Logo",showPreview:!0,allowDelete:!1};export{$ as L,R as c};
