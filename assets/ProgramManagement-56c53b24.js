import{u as ye,j as e,r as l,K as ve,M as we,s as Y,R as Ee}from"./index-c3c9ac92.js";import{u as Fe}from"./useEventActivities-8366b04c.js";import{u as Se}from"./useEventMapSettings-2f04b57b.js";import{a as $e,c as Ce,d as Me,e as Ne,f as De,g as ke,h as Te,i as Le,j as Ae}from"./index-93ad2f14.js";import{u as Ie}from"./useCompanies-c16be9a2.js";import{u as Be}from"./useEventSubscriptions-f300fdbd.js";import"./phone-376c158e.js";function Re({scope:s="global"}){const{t:n}=ye(),h=n(s==="global"?"admin.yearScope.global":"admin.yearScope.eventSpecific"),i=s==="global"?"bg-green-100 text-green-800":"bg-blue-50 text-blue-800";return e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${i} border border-transparent`,role:"status","aria-label":h,title:h,children:h})}function Pe({activity:s=null,day:n="saturday",year:h=new Date().getFullYear(),initialActivityData:i=null,onSave:E=()=>{},onClose:F=()=>{}}){const{t:o,i18n:G}=ye(),[S,K]=l.useState("nl"),le=G&&G.language==="nl"?"nl":"en",[xe,U]=l.useState((s==null?void 0:s.title_nl)||""),[de,ee]=l.useState((s==null?void 0:s.title_en)||""),[ie,I]=l.useState((s==null?void 0:s.title_de)||""),[u,B]=l.useState((s==null?void 0:s.description_nl)||""),[ce,J]=l.useState((s==null?void 0:s.description_en)||""),[R,$]=l.useState((s==null?void 0:s.description_de)||""),[P,C]=l.useState((s==null?void 0:s.location_nl)||""),[Q,_]=l.useState((s==null?void 0:s.location_en)||""),[se,V]=l.useState((s==null?void 0:s.location_de)||""),[me,j]=l.useState((s==null?void 0:s.badge_nl)||""),[te,g]=l.useState((s==null?void 0:s.badge_en)||""),[O,M]=l.useState((s==null?void 0:s.badge_de)||""),[re,W]=l.useState((s==null?void 0:s.start_time)||""),[D,q]=l.useState((s==null?void 0:s.end_time)||""),[y,k]=l.useState((s==null?void 0:s.display_order)??0),[ne,N]=l.useState((s==null?void 0:s.is_active)??!0),[ae,b]=l.useState((s==null?void 0:s.show_location_type_badge)??!1),[z,X]=l.useState((s==null?void 0:s.location_type)||(s!=null&&s.company_id?"exhibitor":"venue")),[v,T]=l.useState((s==null?void 0:s.company_id)??null),a=(s==null?void 0:s.id)??"new",{toastSuccess:w,toastError:ge}=ve(),{companies:pe}=Ie(),{subscriptions:be}=Be(h),he=new Set(be.map(r=>r.company_id)),fe=pe.filter(r=>he.has(r.id));l.useEffect(()=>{s?(U(s.title_nl||""),ee(s.title_en||""),I(s.title_de||""),B(s.description_nl||""),J(s.description_en||""),$(s.description_de||""),C(s.location_nl||""),_(s.location_en||""),V(s.location_de||""),j(s.badge_nl||""),g(s.badge_en||""),M(s.badge_de||""),W(s.start_time||""),q(s.end_time||""),k(s.display_order||0),N(s.is_active??!0),b(s.show_location_type_badge??!1),X(s.location_type||(s.company_id?"exhibitor":"venue")),T(s.company_id||null)):i?(U(i.title_nl||""),ee(i.title_en||""),I(i.title_de||""),B(i.description_nl||""),J(i.description_en||""),$(i.description_de||""),C(i.location_nl||""),_(i.location_en||""),V(i.location_de||""),j(i.badge_nl||""),g(i.badge_en||""),M(i.badge_de||""),W(i.start_time||""),q(i.end_time||""),k(i.display_order||0),N(i.is_active??!0),b(i.show_location_type_badge??!1),X(i.location_type||(i.company_id?"exhibitor":"venue")),T(i.company_id||null)):(U(""),ee(""),I(""),B(""),J(""),$(""),C(""),_(""),V(""),j(""),g(""),M(""),W(""),q(""),k(0),N(!0),b(!1),X("venue"),T(null))},[s,i]);const _e=async r=>{r&&r.preventDefault&&r.preventDefault();const je=v!=null&&v!==""?Number(v):null,f={organization_id:1,day:n,start_time:re||null,end_time:D||null,display_order:y||null,title_nl:xe||null,title_en:de||null,title_de:ie||null,description_nl:u||null,description_en:ce||null,description_de:R||null,location_type:z||"venue",company_id:je,location_nl:P||null,location_en:Q||null,location_de:se||null,badge_nl:me||null,badge_en:te||null,badge_de:O||null,is_active:!!ne,show_location_type_badge:!!ae};f.event_year=h;try{if(console.debug("ActivityForm payload",f),!(s!=null&&s.id)&&(!y||y===0)){const{data:c,error:x}=await Y.from("event_activities").select("display_order").eq("day",n).order("display_order",{ascending:!1}).limit(1).maybeSingle();!x&&c&&typeof c.display_order=="number"?f.display_order=c.display_order+1:f.display_order=1}if(s&&s.id){const{error:c}=await Y.from("event_activities").update(f).eq("id",s.id);if(c)throw c;const{data:x,error:L}=await Y.from("event_activities").select().eq("id",s.id).maybeSingle();if(L&&console.warn("Failed to fetch updated activity:",L),x&&typeof x.show_location_type_badge<"u"){const t=!!x.show_location_type_badge;if(t!==f.show_location_type_badge){console.warn("Persisted show_location_type_badge does not match requested value",{requested:f.show_location_type_badge,persisted:t,id:s==null?void 0:s.id});try{ge(o("activityForm.savePersistMismatch"))}catch{}}b(t)}}else{const{error:c}=await Y.from("event_activities").insert([{...f}]);if(c)throw c;const{data:x,error:L}=await Y.from("event_activities").select().eq("day",n).order("created_at",{ascending:!1}).limit(1).maybeSingle();L&&console.warn("Failed to fetch inserted activity:",L),x&&typeof x.show_location_type_badge<"u"&&b(!!x.show_location_type_badge)}await E();try{w(o("activityForm.saveSuccess"))}catch{}try{window.dispatchEvent(new Event("eventActivitiesUpdated"))}catch{}F()}catch(c){console.error("Error saving activity:",c);try{ge(o("activityForm.saveError")+(c.message?": "+c.message:""))}catch{alert(o("activityForm.saveError")+(c.message?": "+c.message:""))}}};return e.jsxs(we,{isOpen:!0,onClose:F,title:o("activityForm.createTitle"),size:"lg",children:[e.jsxs("div",{className:"px-6 pt-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("button",{type:"button",onClick:()=>K("nl"),className:`px-3 py-1 rounded ${S==="nl"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"}`,children:"NL"}),e.jsx("button",{type:"button",onClick:()=>K("en"),className:`px-3 py-1 rounded ${S==="en"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"}`,children:"EN"}),e.jsx("button",{type:"button",onClick:()=>K("de"),className:`px-3 py-1 rounded ${S==="de"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"}`,children:"DE"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:`start-time-${a}`,className:"block text-sm font-medium text-gray-700 mb-2",children:o("activityForm.startTime")}),e.jsx("input",{id:`start-time-${a}`,type:"time",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:re||"",onChange:r=>W(r.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:`end-time-${a}`,className:"block text-sm font-medium text-gray-700 mb-2",children:o("activityForm.endTime")}),e.jsx("input",{id:`end-time-${a}`,type:"time",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:D||"",onChange:r=>q(r.target.value)})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:`location-type-${a}`,className:"block text-sm font-medium text-gray-700 mb-2",children:o("activityForm.locationType")}),e.jsxs("select",{id:`location-type-${a}`,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:z,onChange:r=>X(r.target.value),children:[e.jsx("option",{value:"venue",children:o("activityForm.venue")}),e.jsx("option",{value:"exhibitor",children:o("activityForm.exhibitor")})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{htmlFor:`company-${a}`,className:"block text-sm font-medium text-gray-700",children:o("activityForm.company")}),e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:o("activityForm.subscribedCompanies",{year:h})})]}),e.jsxs("select",{id:`company-${a}`,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:v||"",onChange:r=>T(r.target.value||null),children:[e.jsx("option",{value:"",children:o("activityForm.selectCompany")}),fe.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:o("activityForm.companyScopeHint")})]})]})]}),e.jsxs("div",{className:"mt-8 pt-6 border-t border-gray-200",children:[S==="nl"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:`title-nl-${a}`,className:"block text-sm font-medium text-gray-700 mb-2",children:o("activityForm.titleNL",{lng:le})}),e.jsx("input",{id:`title-nl-${a}`,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:xe,onChange:r=>U(r.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:`description-nl-${a}`,className:"block text-sm font-medium text-gray-700 mb-2",children:o("activityForm.descriptionNL")}),e.jsx("textarea",{id:`description-nl-${a}`,rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:u,onChange:r=>B(r.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:`location-nl-${a}`,className:"block text-sm font-medium text-gray-700 mb-2",children:o("activityForm.locationNL")}),e.jsx("input",{id:`location-nl-${a}`,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:P,onChange:r=>C(r.target.value)})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:`badge-nl-${a}`,className:"block text-sm font-medium text-gray-700 mb-2",children:[o("activityForm.badgeNL")," ",e.jsx("span",{className:"text-xs text-gray-500",children:o("activityForm.optional")})]}),e.jsx("input",{id:`badge-nl-${a}`,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:me,onChange:r=>j(r.target.value)})]})]})]}),S==="en"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:`title-en-${a}`,className:"block text-sm font-medium text-gray-700 mb-2",children:o("activityForm.titleEN",{lng:le})}),e.jsx("input",{id:`title-en-${a}`,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:de,onChange:r=>ee(r.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:`description-en-${a}`,className:"block text-sm font-medium text-gray-700 mb-2",children:o("activityForm.descriptionEN")}),e.jsx("textarea",{id:`description-en-${a}`,rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:ce,onChange:r=>J(r.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:`location-en-${a}`,className:"block text-sm font-medium text-gray-700 mb-2",children:o("activityForm.locationEN")}),e.jsx("input",{id:`location-en-${a}`,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:Q,onChange:r=>_(r.target.value)})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:`badge-en-${a}`,className:"block text-sm font-medium text-gray-700 mb-2",children:[o("activityForm.badgeEN")," ",e.jsx("span",{className:"text-xs text-gray-500",children:o("activityForm.optional")})]}),e.jsx("input",{id:`badge-en-${a}`,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:te,onChange:r=>g(r.target.value)})]})]})]}),S==="de"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:`title-de-${a}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Title (DE)"}),e.jsx("input",{id:`title-de-${a}`,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:ie,onChange:r=>I(r.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:`description-de-${a}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Description (DE)"}),e.jsx("textarea",{id:`description-de-${a}`,rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:R,onChange:r=>$(r.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:`location-de-${a}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Location (DE)"}),e.jsx("input",{id:`location-de-${a}`,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:se,onChange:r=>V(r.target.value)})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:`badge-de-${a}`,className:"block text-sm font-medium text-gray-700 mb-2",children:["Badge (DE)"," ",e.jsx("span",{className:"text-xs text-gray-500",children:o("activityForm.optional")})]}),e.jsx("input",{id:`badge-de-${a}`,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:O,onChange:r=>M(r.target.value)})]})]})]})]}),e.jsx("div",{className:"mt-6 px-6 py-4 bg-gray-50 border-t border-gray-200",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{id:`isActive-${a}`,type:"checkbox",className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500",checked:ne,onChange:r=>N(r.target.checked)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{htmlFor:`isActive-${a}`,className:"text-sm text-gray-700 cursor-pointer",children:o("activityForm.isActive")}),e.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:o("activityForm.isActiveHelp")})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{id:`showLocBadge-${a}`,type:"checkbox",className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500",checked:ae,onChange:r=>b(r.target.checked)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{htmlFor:`showLocBadge-${a}`,className:"text-sm text-gray-700 cursor-pointer",children:o("activityForm.showLocationBadge")}),e.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:o("activityForm.showLocationBadgeHelp")})]})]})]})})]}),e.jsx("form",{onSubmit:_e,className:"px-6 py-4 border-t border-gray-100",children:e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:F,className:"px-4 py-2 bg-white text-gray-900 border border-gray-300 rounded hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-300","aria-label":o("activityForm.cancel"),children:o("activityForm.cancel")}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-300","aria-label":o("activityForm.save"),children:o("activityForm.save")})]})})]})}function Je({selectedYear:s}){var x,L;const{t:n,i18n:h}=ye(),{confirm:i,toastError:E,toastSuccess:F,toastInfo:o}=ve(),{activities:G,loading:S,error:K,getActivityLocation:le,createActivity:xe,updateActivity:U,deleteActivity:de,archiveCurrentYear:ee,copyFromPreviousYear:ie,refetch:I}=Fe(s),{settings:u,loading:B,updateSettings:ce,resetToGlobal:J}=Se(s),[R,$]=l.useState((u==null?void 0:u.event_start_date)??""),[P,C]=l.useState((u==null?void 0:u.event_end_date)??""),[Q,_]=l.useState(!1);Ee.useEffect(()=>{if(!u){$(""),C("");return}$(u.event_start_date||""),C(u.event_end_date||"")},[u]);const se=(t,d)=>{t==="start"?$(d):C(d)},V=async()=>{if(R&&P){const t=new Date(R),d=new Date(P);if(t>d){E(n("programManagement.eventDates.invalidRange"));return}}_(!0);try{await ce({event_start_date:R||null,event_end_date:P||null}),F(n("programManagement.eventDates.saveSuccess"))}catch(t){console.error("Error updating event dates:",t),E(n("programManagement.eventDates.saveError")+": "+(t.message||t))}finally{_(!1)}},me=async()=>{_(!0);try{await J(),F(n("programManagement.eventDates.resetSuccess"))}catch(t){console.error("Error resetting event dates:",t),E(n("programManagement.eventDates.resetError")+": "+(t.message||t))}finally{_(!1)}},[j,te]=l.useState("saturday"),[g,O]=l.useState(null),[M,re]=l.useState(!1),[W,D]=l.useState(!1),[q,y]=l.useState(null),[k,ne]=l.useState(null),[N,ae]=l.useState(!1),[b,z]=l.useState(null),[X,v]=l.useState(null),[T,a]=l.useState(!1),w=G[j]||[],ge=async t=>{if(!(!g||g.id!==t)){re(!0);try{const{error:d}=await de(t);if(d)throw new Error(d);O(null)}catch(d){console.error("Error deleting activity:",d),E(n("programManagement.deleteError")+": "+d.message)}finally{re(!1)}}},pe=async()=>{const t=s-1;if(!await i({title:"Copy Activities",message:`Copy all activities from ${t} to ${s}?`,confirmText:"Copy",variant:"default"}))return;const{error:p}=await ie(t);p?E(`Error copying activities: ${p}`):F(`Activities copied from ${t} to ${s}`)},be=t=>{const d={start_time:t.start_time,end_time:t.end_time,display_order:t.display_order,title_nl:t.title_nl,title_en:t.title_en,title_de:t.title_de,description_nl:t.description_nl,description_en:t.description_en,description_de:t.description_de,location_type:t.location_type,company_id:t.company_id,location_nl:t.location_nl,location_en:t.location_en,location_de:t.location_de,badge_nl:t.badge_nl,badge_en:t.badge_en,badge_de:t.badge_de,is_active:t.is_active,show_location_type_badge:t.show_location_type_badge};z(d),o('Activity copied! Click "Paste" to create a duplicate.')},he=()=>{b&&(y(null),D(!0))},fe=async t=>{try{const{error:d}=await U(t,{is_active:!0});if(d)throw new Error(d);F(n("programManagement.reactivateSuccess"))}catch(d){console.error("Error reactivating activity:",d),E(n("programManagement.reactivateError")+": "+d.message)}},_e=(t,d,p)=>{ne({activity:d,index:p}),t.dataTransfer.effectAllowed="move",t.currentTarget.style.opacity="0.4"},r=t=>{t.currentTarget.style.opacity="1",ne(null),v(null)},je=(t,d)=>{t.preventDefault(),t.dataTransfer.dropEffect="move",v(d)},f=()=>{v(null)},c=async(t,d)=>{if(t.preventDefault(),!(!k||k.index===d)){ae(!0);try{const p=[...w],[A]=p.splice(k.index,1);p.splice(d,0,A);const ue=p.map((Z,H)=>({id:Z.id,display_order:H+1}));for(const Z of ue){const{error:H}=await Y.from("event_activities").update({display_order:Z.display_order}).eq("id",Z.id);if(H)throw H}await I()}catch(p){console.error("Error reordering activities:",p),alert(n("programManagement.reorderError")+": "+p.message)}finally{ae(!1)}}};return S?e.jsxs("div",{className:"flex justify-center items-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-3 text-gray-600",children:n("programManagement.loading")})]}):K?e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("p",{className:"text-red-800",children:[n("programManagement.error"),": ",K.message]})}):e.jsxs("div",{className:"bg-white rounded-lg shadow-sm","data-testid":"program-management-container",children:[e.jsx("div",{className:"border-b border-gray-200 px-6 py-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:n("programManagement.title")}),e.jsx("div",{children:e.jsx(Re,{scope:"year",year:s})})]}),e.jsxs("div",{className:"flex gap-2 relative z-50",children:[e.jsxs("button",{onClick:()=>{y(null),z(null),D(!0)},"data-testid":"add-activity-button",className:"flex items-center gap-2 px-3 py-1.5 text-sm font-medium bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:[e.jsx($e,{className:"text-xl"}),e.jsx("span",{children:n("programManagement.addActivity")})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>a(!T),className:"flex items-center gap-2 px-3 py-1.5 text-sm font-medium bg-white text-gray-700 border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 shadow-sm transition-all",title:"Actions Menu",children:[e.jsx("span",{children:"Actions"}),T?e.jsx(Ce,{className:"text-lg"}):e.jsx(Me,{className:"text-lg"})]}),T&&e.jsxs("div",{className:"absolute right-0 mt-1 w-56 bg-white border border-gray-200 rounded-lg shadow-xl z-50 overflow-hidden py-1",children:[e.jsx("div",{className:"px-4 py-2 text-xs font-semibold text-gray-500 uppercase tracking-wider bg-gray-50 border-b border-gray-100",children:"Tools"}),e.jsxs("button",{onClick:()=>{pe(),a(!1)},"data-testid":"copy-from-previous-year-button",className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 flex items-center gap-2",children:[e.jsx(Ne,{className:"text-lg text-gray-400"}),"Copy from ",s-1]}),b&&e.jsxs("button",{onClick:()=>{he(),a(!1)},"data-testid":"paste-activity-button",className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 flex items-center gap-2",children:[e.jsx(De,{className:"text-lg text-gray-400"}),"Paste Activity"]})]})]})]})]})}),e.jsx("div",{className:"border-b border-gray-200 px-6 py-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-md font-semibold text-gray-700",children:n("programManagement.eventDates.title")}),e.jsx("p",{className:"text-sm text-gray-500",children:n("programManagement.eventDates.description")})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx("span",{className:"text-xs",children:n("programManagement.eventDates.startLabel")}),e.jsx("input",{type:"date",value:R,onChange:t=>se("start",t.target.value),className:"input-base","data-testid":"event-start-date-input"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx("span",{className:"text-xs",children:n("programManagement.eventDates.endLabel")}),e.jsx("input",{type:"date",value:P,onChange:t=>se("end",t.target.value),className:"input-base","data-testid":"event-end-date-input"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:V,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",disabled:B||Q,"data-testid":"save-event-dates-button",children:n(Q?"common.saving":"programManagement.eventDates.save")}),e.jsx("button",{type:"button",onClick:me,className:"px-3 py-2 bg-gray-100 rounded-lg text-sm hover:bg-gray-200",disabled:B||Q,"data-testid":"reset-event-dates-button",children:n("programManagement.eventDates.resetToGlobal")})]})]})]})}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("div",{className:"flex",children:[e.jsxs("button",{onClick:()=>te("saturday"),"data-testid":"saturday-tab",className:`px-6 py-3 font-medium transition-colors ${j==="saturday"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:[n("programManagement.saturday")," (",((x=G.saturday)==null?void 0:x.length)||0,")"]}),e.jsxs("button",{onClick:()=>te("sunday"),"data-testid":"sunday-tab",className:`px-6 py-3 font-medium transition-colors ${j==="sunday"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:[n("programManagement.sunday")," (",((L=G.sunday)==null?void 0:L.length)||0,")"]})]})}),e.jsx("div",{className:"divide-y divide-gray-200","data-testid":"activities-list",children:w.length===0?e.jsxs("div",{className:"px-6 py-12 text-center",children:[e.jsx("p",{className:"text-gray-500",children:n("programManagement.noActivitiesFound")}),e.jsx("button",{onClick:()=>{y(null),z(null),D(!0)},className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:n("programManagement.addFirstActivity")})]}):e.jsx(e.Fragment,{children:w.map((t,d)=>{const p=le(t,h.language),A=h.language||"en",ue=A==="nl"?t.title_nl:A==="de"?t.title_de:t.title_en,Z=A==="nl"?t.description_nl:A==="de"?t.description_de:t.description_en,H=A==="nl"?t.badge_nl:A==="de"?t.badge_de:t.badge_en,m=!t.is_active;return e.jsxs("div",{children:[X===d&&k&&e.jsx("div",{className:"h-1 bg-blue-500 rounded-full mb-2 animate-pulse"}),e.jsx("div",{draggable:!N&&!m,onDragStart:oe=>_e(oe,t,d),onDragEnd:r,onDragOver:oe=>je(oe,d),onDragLeave:f,onDrop:oe=>c(oe,d),className:`px-6 py-4 transition-colors ${m?"bg-gray-100 border-l-4 border-gray-400 relative overflow-hidden":N?"hover:bg-gray-50 opacity-50 cursor-wait":"hover:bg-gray-50 cursor-move"}`,style:m?{backgroundImage:`repeating-linear-gradient(
                       45deg,
                       transparent,
                       transparent 10px,
                       rgba(156, 163, 175, 0.1) 10px,
                       rgba(156, 163, 175, 0.1) 20px
                     )`}:void 0,children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("button",{className:`mt-1 ${m?"text-gray-300 cursor-not-allowed":N?"text-gray-400 cursor-wait":"text-gray-400 hover:text-gray-600 cursor-move"}`,title:n(m?"programManagement.inactive":"programManagement.dragToReorder"),disabled:N||m,children:e.jsx(ke,{className:"text-2xl"})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsxs("span",{className:`text-sm ${m?"text-gray-600":"text-gray-500"}`,children:[t.start_time," - ",t.end_time]}),H&&e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${m?"text-gray-600 bg-gray-200":"text-blue-700 bg-blue-100"}`,children:H}),m&&e.jsx("span",{className:"px-2 py-1 text-xs font-medium text-orange-700 bg-orange-100 rounded",children:n("programManagement.inactive")})]}),e.jsx("h3",{className:`text-lg font-semibold mb-1 ${m?"text-gray-700":"text-gray-900"}`,children:ue}),e.jsx("p",{className:"text-sm mb-2 line-clamp-2 text-gray-600",children:Z}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsxs("span",{className:m?"text-gray-600":"text-gray-500",children:[n("programManagement.location"),":"]}),e.jsx("span",{className:"font-medium text-gray-700",children:p.text}),t.show_location_type_badge&&e.jsx("span",{className:`px-2 py-0.5 text-xs rounded ${m?t.location_type==="exhibitor"||t.location_type==="company"?"bg-green-50 text-green-600":"bg-gray-50 text-gray-600":t.location_type==="exhibitor"||t.location_type==="company"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:t.location_type==="exhibitor"||t.location_type==="company"?n("programManagement.exhibitor"):n("programManagement.venue")})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>be(t),"data-testid":"copy-activity-button",className:`p-2 rounded-lg transition-colors ${m?"text-gray-400 hover:bg-gray-50 cursor-not-allowed":"text-gray-600 hover:bg-gray-50"}`,title:"Copy activity",disabled:m,children:e.jsx(Ne,{className:"text-xl"})}),e.jsx("button",{onClick:()=>{y(t),D(!0)},className:`p-2 rounded-lg transition-colors ${m?"text-blue-400 hover:bg-blue-50":"text-blue-600 hover:bg-blue-50"}`,title:n("programManagement.edit"),children:e.jsx(Te,{className:"text-xl"})}),m?e.jsx("button",{onClick:()=>fe(t.id),className:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:n("programManagement.reactivate"),children:e.jsx(Le,{className:"text-xl"})}):e.jsx("button",{onClick:()=>O({id:t.id,title:ue}),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:n("programManagement.delete"),children:e.jsx(Ae,{className:"text-xl"})})]})]})})]})})]},`activity-${t.id}`)})})}),w.length>0&&e.jsx("div",{className:"border-t border-gray-200 px-6 py-3 bg-gray-50","data-testid":"program-stats",children:e.jsxs("div",{className:"flex gap-6 text-sm",children:[e.jsxs("p",{className:"text-gray-600",children:[n("programManagement.totalActivities"),":"," ",e.jsx("span",{className:"font-medium",children:w.length})]}),e.jsxs("p",{className:"text-gray-600",children:[n("programManagement.activeActivities"),":"," ",e.jsx("span",{className:"font-medium text-green-600",children:w.filter(t=>t.is_active).length})]}),e.jsxs("p",{className:"text-gray-600",children:[n("programManagement.inactiveActivities"),":"," ",e.jsx("span",{className:"font-medium text-orange-600",children:w.filter(t=>!t.is_active).length})]})]})}),e.jsxs(we,{isOpen:!!g,onClose:()=>O(null),title:n("programManagement.confirmDelete"),size:"md",children:[e.jsxs("div",{className:"p-6",children:[e.jsx("p",{className:"text-gray-700",children:n("programManagement.confirmDeleteMessage")}),e.jsxs("p",{className:"mt-2 font-medium text-gray-900",children:['"',g==null?void 0:g.title,'"']})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-50 flex justify-end gap-3 border-t border-gray-200",children:[e.jsx("button",{onClick:()=>O(null),disabled:M,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50",children:n("programManagement.cancel")}),e.jsx("button",{onClick:()=>ge(g==null?void 0:g.id),disabled:M,className:"px-4 py-2 text-white bg-red-600 rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50 flex items-center gap-2",children:M?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),n("programManagement.deleting")]}):n("programManagement.deleteButton")})]})]}),W&&e.jsx(Pe,{activity:q,day:j,year:s,initialActivityData:q?null:b,onSave:()=>{I(),b&&z(null)},onClose:()=>{D(!1),y(null)}})]})}export{Je as default};
