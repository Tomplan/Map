import{u as Ne,j as e,r as d,K as we,M as Ee,s as ee,R as Fe}from"./index-66b9036e.js";import{u as Se}from"./useEventActivities-86170596.js";import{u as $e}from"./useEventMapSettings-3b56aff4.js";import{c as ve,d as Ce,e as Me,a as De,f as ke,g as Te,h as Le,i as Ae}from"./index-1b8da4f8.js";import{u as Ie}from"./useCompanies-574afd66.js";import{u as Be}from"./useEventSubscriptions-a45e40db.js";import"./phone-376c158e.js";function Re({scope:s="global"}){const{t:n}=Ne(),f=n(s==="global"?"admin.yearScope.global":"admin.yearScope.eventSpecific"),i=s==="global"?"bg-green-100 text-green-800":"bg-blue-50 text-blue-800";return e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${i} border border-transparent`,role:"status","aria-label":f,title:f,children:f})}function Pe({activity:s=null,day:n="saturday",year:f=new Date().getFullYear(),initialActivityData:i=null,onSave:j=()=>{},onClose:y=()=>{}}){const{t:o,i18n:S}=Ne(),[$,G]=d.useState("nl"),le=S&&S.language==="nl"?"nl":"en",[pe,K]=d.useState((s==null?void 0:s.title_nl)||""),[de,U]=d.useState((s==null?void 0:s.title_en)||""),[ie,I]=d.useState((s==null?void 0:s.title_de)||""),[u,B]=d.useState((s==null?void 0:s.description_nl)||""),[ce,J]=d.useState((s==null?void 0:s.description_en)||""),[R,C]=d.useState((s==null?void 0:s.description_de)||""),[P,M]=d.useState((s==null?void 0:s.location_nl)||""),[Q,N]=d.useState((s==null?void 0:s.location_en)||""),[se,V]=d.useState((s==null?void 0:s.location_de)||""),[me,v]=d.useState((s==null?void 0:s.badge_nl)||""),[te,g]=d.useState((s==null?void 0:s.badge_en)||""),[q,D]=d.useState((s==null?void 0:s.badge_de)||""),[re,W]=d.useState((s==null?void 0:s.start_time)||""),[k,O]=d.useState((s==null?void 0:s.end_time)||""),[w,T]=d.useState((s==null?void 0:s.display_order)??0),[ne,E]=d.useState((s==null?void 0:s.is_active)??!0),[ae,h]=d.useState((s==null?void 0:s.show_location_type_badge)??!1),[z,X]=d.useState((s==null?void 0:s.location_type)||(s!=null&&s.company_id?"exhibitor":"venue")),[F,b]=d.useState((s==null?void 0:s.company_id)??null),a=(s==null?void 0:s.id)??"new",{toastSuccess:xe,toastError:ge}=we(),{companies:be}=Ie(),{subscriptions:he}=Be(f),fe=new Set(he.map(r=>r.company_id)),_e=be.filter(r=>fe.has(r.id));d.useEffect(()=>{s?(K(s.title_nl||""),U(s.title_en||""),I(s.title_de||""),B(s.description_nl||""),J(s.description_en||""),C(s.description_de||""),M(s.location_nl||""),N(s.location_en||""),V(s.location_de||""),v(s.badge_nl||""),g(s.badge_en||""),D(s.badge_de||""),W(s.start_time||""),O(s.end_time||""),T(s.display_order||0),E(s.is_active??!0),h(s.show_location_type_badge??!1),X(s.location_type||(s.company_id?"exhibitor":"venue")),b(s.company_id||null)):i?(K(i.title_nl||""),U(i.title_en||""),I(i.title_de||""),B(i.description_nl||""),J(i.description_en||""),C(i.description_de||""),M(i.location_nl||""),N(i.location_en||""),V(i.location_de||""),v(i.badge_nl||""),g(i.badge_en||""),D(i.badge_de||""),W(i.start_time||""),O(i.end_time||""),T(i.display_order||0),E(i.is_active??!0),h(i.show_location_type_badge??!1),X(i.location_type||(i.company_id?"exhibitor":"venue")),b(i.company_id||null)):(K(""),U(""),I(""),B(""),J(""),C(""),M(""),N(""),V(""),v(""),g(""),D(""),W(""),O(""),T(0),E(!0),h(!1),X("venue"),b(null))},[s,i]);const je=async r=>{r&&r.preventDefault&&r.preventDefault();const ye=F!=null&&F!==""?Number(F):null,_={organization_id:1,day:n,start_time:re||null,end_time:k||null,display_order:w||null,title_nl:pe||null,title_en:de||null,title_de:ie||null,description_nl:u||null,description_en:ce||null,description_de:R||null,location_type:z||"venue",company_id:ye,location_nl:P||null,location_en:Q||null,location_de:se||null,badge_nl:me||null,badge_en:te||null,badge_de:q||null,is_active:!!ne,show_location_type_badge:!!ae};_.event_year=f;try{if(console.debug("ActivityForm payload",_),!(s!=null&&s.id)&&(!w||w===0)){const{data:c,error:p}=await ee.from("event_activities").select("display_order").eq("day",n).order("display_order",{ascending:!1}).limit(1).maybeSingle();!p&&c&&typeof c.display_order=="number"?_.display_order=c.display_order+1:_.display_order=1}if(s&&s.id){const{error:c}=await ee.from("event_activities").update(_).eq("id",s.id);if(c)throw c;const{data:p,error:L}=await ee.from("event_activities").select().eq("id",s.id).maybeSingle();if(L&&console.warn("Failed to fetch updated activity:",L),p&&typeof p.show_location_type_badge<"u"){const Z=!!p.show_location_type_badge;if(Z!==_.show_location_type_badge){console.warn("Persisted show_location_type_badge does not match requested value",{requested:_.show_location_type_badge,persisted:Z,id:s==null?void 0:s.id});try{ge(o("activityForm.savePersistMismatch"))}catch{}}h(Z)}}else{const{error:c}=await ee.from("event_activities").insert([{..._}]);if(c)throw c;const{data:p,error:L}=await ee.from("event_activities").select().eq("day",n).order("created_at",{ascending:!1}).limit(1).maybeSingle();L&&console.warn("Failed to fetch inserted activity:",L),p&&typeof p.show_location_type_badge<"u"&&h(!!p.show_location_type_badge)}await j();try{xe(o("activityForm.saveSuccess"))}catch{}try{window.dispatchEvent(new Event("eventActivitiesUpdated"))}catch{}y()}catch(c){console.error("Error saving activity:",c);try{ge(o("activityForm.saveError")+(c.message?": "+c.message:""))}catch{alert(o("activityForm.saveError")+(c.message?": "+c.message:""))}}};return e.jsxs(Ee,{isOpen:!0,onClose:y,title:o("activityForm.createTitle"),size:"lg",children:[e.jsxs("div",{className:"px-6 pt-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("button",{type:"button",onClick:()=>G("nl"),className:`px-3 py-1 rounded ${$==="nl"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"}`,children:"NL"}),e.jsx("button",{type:"button",onClick:()=>G("en"),className:`px-3 py-1 rounded ${$==="en"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"}`,children:"EN"}),e.jsx("button",{type:"button",onClick:()=>G("de"),className:`px-3 py-1 rounded ${$==="de"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"}`,children:"DE"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:`start-time-${a}`,className:"block text-sm font-medium text-gray-700 mb-2",children:o("activityForm.startTime")}),e.jsx("input",{id:`start-time-${a}`,type:"time",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:re||"",onChange:r=>W(r.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:`end-time-${a}`,className:"block text-sm font-medium text-gray-700 mb-2",children:o("activityForm.endTime")}),e.jsx("input",{id:`end-time-${a}`,type:"time",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:k||"",onChange:r=>O(r.target.value)})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:`location-type-${a}`,className:"block text-sm font-medium text-gray-700 mb-2",children:o("activityForm.locationType")}),e.jsxs("select",{id:`location-type-${a}`,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:z,onChange:r=>X(r.target.value),children:[e.jsx("option",{value:"venue",children:o("activityForm.venue")}),e.jsx("option",{value:"exhibitor",children:o("activityForm.exhibitor")})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{htmlFor:`company-${a}`,className:"block text-sm font-medium text-gray-700",children:o("activityForm.company")}),e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:o("activityForm.subscribedCompanies",{year:f})})]}),e.jsxs("select",{id:`company-${a}`,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:F||"",onChange:r=>b(r.target.value||null),children:[e.jsx("option",{value:"",children:o("activityForm.selectCompany")}),_e.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:o("activityForm.companyScopeHint")})]})]})]}),e.jsxs("div",{className:"mt-8 pt-6 border-t border-gray-200",children:[$==="nl"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:`title-nl-${a}`,className:"block text-sm font-medium text-gray-700 mb-2",children:o("activityForm.titleNL",{lng:le})}),e.jsx("input",{id:`title-nl-${a}`,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:pe,onChange:r=>K(r.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:`description-nl-${a}`,className:"block text-sm font-medium text-gray-700 mb-2",children:o("activityForm.descriptionNL")}),e.jsx("textarea",{id:`description-nl-${a}`,rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:u,onChange:r=>B(r.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:`location-nl-${a}`,className:"block text-sm font-medium text-gray-700 mb-2",children:o("activityForm.locationNL")}),e.jsx("input",{id:`location-nl-${a}`,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:P,onChange:r=>M(r.target.value)})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:`badge-nl-${a}`,className:"block text-sm font-medium text-gray-700 mb-2",children:[o("activityForm.badgeNL")," ",e.jsx("span",{className:"text-xs text-gray-500",children:o("activityForm.optional")})]}),e.jsx("input",{id:`badge-nl-${a}`,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:me,onChange:r=>v(r.target.value)})]})]})]}),$==="en"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:`title-en-${a}`,className:"block text-sm font-medium text-gray-700 mb-2",children:o("activityForm.titleEN",{lng:le})}),e.jsx("input",{id:`title-en-${a}`,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:de,onChange:r=>U(r.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:`description-en-${a}`,className:"block text-sm font-medium text-gray-700 mb-2",children:o("activityForm.descriptionEN")}),e.jsx("textarea",{id:`description-en-${a}`,rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:ce,onChange:r=>J(r.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:`location-en-${a}`,className:"block text-sm font-medium text-gray-700 mb-2",children:o("activityForm.locationEN")}),e.jsx("input",{id:`location-en-${a}`,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:Q,onChange:r=>N(r.target.value)})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:`badge-en-${a}`,className:"block text-sm font-medium text-gray-700 mb-2",children:[o("activityForm.badgeEN")," ",e.jsx("span",{className:"text-xs text-gray-500",children:o("activityForm.optional")})]}),e.jsx("input",{id:`badge-en-${a}`,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:te,onChange:r=>g(r.target.value)})]})]})]}),$==="de"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:`title-de-${a}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Title (DE)"}),e.jsx("input",{id:`title-de-${a}`,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:ie,onChange:r=>I(r.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:`description-de-${a}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Description (DE)"}),e.jsx("textarea",{id:`description-de-${a}`,rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:R,onChange:r=>C(r.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:`location-de-${a}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Location (DE)"}),e.jsx("input",{id:`location-de-${a}`,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:se,onChange:r=>V(r.target.value)})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:`badge-de-${a}`,className:"block text-sm font-medium text-gray-700 mb-2",children:["Badge (DE)"," ",e.jsx("span",{className:"text-xs text-gray-500",children:o("activityForm.optional")})]}),e.jsx("input",{id:`badge-de-${a}`,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:q,onChange:r=>D(r.target.value)})]})]})]})]}),e.jsx("div",{className:"mt-6 px-6 py-4 bg-gray-50 border-t border-gray-200",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{id:`isActive-${a}`,type:"checkbox",className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500",checked:ne,onChange:r=>E(r.target.checked)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{htmlFor:`isActive-${a}`,className:"text-sm text-gray-700 cursor-pointer",children:o("activityForm.isActive")}),e.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:o("activityForm.isActiveHelp")})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{id:`showLocBadge-${a}`,type:"checkbox",className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500",checked:ae,onChange:r=>h(r.target.checked)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{htmlFor:`showLocBadge-${a}`,className:"text-sm text-gray-700 cursor-pointer",children:o("activityForm.showLocationBadge")}),e.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:o("activityForm.showLocationBadgeHelp")})]})]})]})})]}),e.jsx("form",{onSubmit:je,className:"px-6 py-4 border-t border-gray-100",children:e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:y,className:"px-4 py-2 bg-white text-gray-900 border border-gray-300 rounded hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-300","aria-label":o("activityForm.cancel"),children:o("activityForm.cancel")}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-300","aria-label":o("activityForm.save"),children:o("activityForm.save")})]})})]})}function Je({selectedYear:s}){var c,p,L,Z;const{t:n,i18n:f}=Ne(),{confirm:i,toastError:j,toastSuccess:y,toastInfo:o}=we(),{activities:S,loading:$,error:G,getActivityLocation:le,createActivity:pe,updateActivity:K,deleteActivity:de,archiveCurrentYear:U,copyFromPreviousYear:ie,refetch:I}=Se(s),{settings:u,loading:B,updateSettings:ce,resetToGlobal:J}=$e(s),[R,C]=d.useState((u==null?void 0:u.event_start_date)??""),[P,M]=d.useState((u==null?void 0:u.event_end_date)??""),[Q,N]=d.useState(!1);Fe.useEffect(()=>{if(!u){C(""),M("");return}C(u.event_start_date||""),M(u.event_end_date||"")},[u]);const se=(t,l)=>{t==="start"?C(l):M(l)},V=async()=>{if(R&&P){const t=new Date(R),l=new Date(P);if(t>l){j(n("programManagement.eventDates.invalidRange"));return}}N(!0);try{await ce({event_start_date:R||null,event_end_date:P||null}),y(n("programManagement.eventDates.saveSuccess"))}catch(t){console.error("Error updating event dates:",t),j(n("programManagement.eventDates.saveError")+": "+(t.message||t))}finally{N(!1)}},me=async()=>{N(!0);try{await J(),y(n("programManagement.eventDates.resetSuccess"))}catch(t){console.error("Error resetting event dates:",t),j(n("programManagement.eventDates.resetError")+": "+(t.message||t))}finally{N(!1)}},[v,te]=d.useState("saturday"),[g,q]=d.useState(null),[D,re]=d.useState(!1),[W,k]=d.useState(!1),[O,w]=d.useState(null),[T,ne]=d.useState(null),[E,ae]=d.useState(!1),[h,z]=d.useState(null),[X,F]=d.useState(null),b=S[v]||[],a=async t=>{if(!(!g||g.id!==t)){re(!0);try{const{error:l}=await de(t);if(l)throw new Error(l);q(null)}catch(l){console.error("Error deleting activity:",l),j(n("programManagement.deleteError")+": "+l.message)}finally{re(!1)}}},xe=async()=>{if(!await i({title:"Archive Activities",message:`Archive all activities for ${s}? This will move them to the archive and clear the current year.`,confirmText:"Archive",variant:"warning"}))return;const{error:l}=await U();l?j(`Error archiving: ${l}`):y(`Successfully archived activities for ${s}`)},ge=async()=>{const t=s-1;if(!await i({title:"Copy Activities",message:`Copy all activities from ${t} to ${s}?`,confirmText:"Copy",variant:"default"}))return;const{error:x}=await ie(t);x?j(`Error copying activities: ${x}`):y(`Activities copied from ${t} to ${s}`)},be=t=>{const l={start_time:t.start_time,end_time:t.end_time,display_order:t.display_order,title_nl:t.title_nl,title_en:t.title_en,title_de:t.title_de,description_nl:t.description_nl,description_en:t.description_en,description_de:t.description_de,location_type:t.location_type,company_id:t.company_id,location_nl:t.location_nl,location_en:t.location_en,location_de:t.location_de,badge_nl:t.badge_nl,badge_en:t.badge_en,badge_de:t.badge_de,is_active:t.is_active,show_location_type_badge:t.show_location_type_badge};z(l),o('Activity copied! Click "Paste" to create a duplicate.')},he=()=>{h&&(w(null),k(!0))},fe=async t=>{try{const{error:l}=await K(t,{is_active:!0});if(l)throw new Error(l);y(n("programManagement.reactivateSuccess"))}catch(l){console.error("Error reactivating activity:",l),j(n("programManagement.reactivateError")+": "+l.message)}},_e=(t,l,x)=>{ne({activity:l,index:x}),t.dataTransfer.effectAllowed="move",t.currentTarget.style.opacity="0.4"},je=t=>{t.currentTarget.style.opacity="1",ne(null),F(null)},r=(t,l)=>{t.preventDefault(),t.dataTransfer.dropEffect="move",F(l)},ye=()=>{F(null)},_=async(t,l)=>{if(t.preventDefault(),!(!T||T.index===l)){ae(!0);try{const x=[...b],[A]=x.splice(T.index,1);x.splice(l,0,A);const ue=x.map((Y,H)=>({id:Y.id,display_order:H+1}));for(const Y of ue){const{error:H}=await ee.from("event_activities").update({display_order:Y.display_order}).eq("id",Y.id);if(H)throw H}await I()}catch(x){console.error("Error reordering activities:",x),alert(n("programManagement.reorderError")+": "+x.message)}finally{ae(!1)}}};return $?e.jsxs("div",{className:"flex justify-center items-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-3 text-gray-600",children:n("programManagement.loading")})]}):G?e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("p",{className:"text-red-800",children:[n("programManagement.error"),": ",G.message]})}):e.jsxs("div",{className:"bg-white rounded-lg shadow-sm","data-testid":"program-management-container",children:[e.jsx("div",{className:"border-b border-gray-200 px-6 py-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:n("programManagement.title")}),e.jsx("div",{children:e.jsx(Re,{scope:"year",year:s})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:ge,"data-testid":"copy-from-previous-year-button",className:"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",title:`Copy from ${s-1}`,children:[e.jsx(ve,{className:"text-lg"}),"Copy from ",s-1]}),e.jsxs("button",{onClick:xe,"data-testid":"archive-year-button",className:"flex items-center gap-2 px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 disabled:opacity-50 disabled:cursor-not-allowed",disabled:(((c=S.saturday)==null?void 0:c.length)||0)+(((p=S.sunday)==null?void 0:p.length)||0)===0,title:`Archive all activities for ${s}`,children:[e.jsx(Ce,{className:"text-lg"}),"Archive ",s]}),h&&e.jsxs("button",{onClick:he,"data-testid":"paste-activity-button",className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",title:"Paste copied activity",children:[e.jsx(Me,{className:"text-lg"}),"Paste Activity"]}),e.jsxs("button",{onClick:()=>{w(null),z(null),k(!0)},"data-testid":"add-activity-button",className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(De,{className:"text-xl"}),e.jsx("span",{children:n("programManagement.addActivity")})]})]})]})}),e.jsx("div",{className:"border-b border-gray-200 px-6 py-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-md font-semibold text-gray-700",children:n("programManagement.eventDates.title")}),e.jsx("p",{className:"text-sm text-gray-500",children:n("programManagement.eventDates.description")})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx("span",{className:"text-xs",children:n("programManagement.eventDates.startLabel")}),e.jsx("input",{type:"date",value:R,onChange:t=>se("start",t.target.value),className:"input-base","data-testid":"event-start-date-input"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx("span",{className:"text-xs",children:n("programManagement.eventDates.endLabel")}),e.jsx("input",{type:"date",value:P,onChange:t=>se("end",t.target.value),className:"input-base","data-testid":"event-end-date-input"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:V,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",disabled:B||Q,"data-testid":"save-event-dates-button",children:n(Q?"common.saving":"programManagement.eventDates.save")}),e.jsx("button",{type:"button",onClick:me,className:"px-3 py-2 bg-gray-100 rounded-lg text-sm hover:bg-gray-200",disabled:B||Q,"data-testid":"reset-event-dates-button",children:n("programManagement.eventDates.resetToGlobal")})]})]})]})}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("div",{className:"flex",children:[e.jsxs("button",{onClick:()=>te("saturday"),"data-testid":"saturday-tab",className:`px-6 py-3 font-medium transition-colors ${v==="saturday"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:[n("programManagement.saturday")," (",((L=S.saturday)==null?void 0:L.length)||0,")"]}),e.jsxs("button",{onClick:()=>te("sunday"),"data-testid":"sunday-tab",className:`px-6 py-3 font-medium transition-colors ${v==="sunday"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:[n("programManagement.sunday")," (",((Z=S.sunday)==null?void 0:Z.length)||0,")"]})]})}),e.jsx("div",{className:"divide-y divide-gray-200","data-testid":"activities-list",children:b.length===0?e.jsxs("div",{className:"px-6 py-12 text-center",children:[e.jsx("p",{className:"text-gray-500",children:n("programManagement.noActivitiesFound")}),e.jsx("button",{onClick:()=>{w(null),z(null),k(!0)},className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:n("programManagement.addFirstActivity")})]}):e.jsx(e.Fragment,{children:b.map((t,l)=>{const x=le(t,f.language),A=f.language||"en",ue=A==="nl"?t.title_nl:A==="de"?t.title_de:t.title_en,Y=A==="nl"?t.description_nl:A==="de"?t.description_de:t.description_en,H=A==="nl"?t.badge_nl:A==="de"?t.badge_de:t.badge_en,m=!t.is_active;return e.jsxs("div",{children:[X===l&&T&&e.jsx("div",{className:"h-1 bg-blue-500 rounded-full mb-2 animate-pulse"}),e.jsx("div",{draggable:!E&&!m,onDragStart:oe=>_e(oe,t,l),onDragEnd:je,onDragOver:oe=>r(oe,l),onDragLeave:ye,onDrop:oe=>_(oe,l),className:`px-6 py-4 transition-colors ${m?"bg-gray-100 border-l-4 border-gray-400 relative overflow-hidden":E?"hover:bg-gray-50 opacity-50 cursor-wait":"hover:bg-gray-50 cursor-move"}`,style:m?{backgroundImage:`repeating-linear-gradient(
                       45deg,
                       transparent,
                       transparent 10px,
                       rgba(156, 163, 175, 0.1) 10px,
                       rgba(156, 163, 175, 0.1) 20px
                     )`}:void 0,children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("button",{className:`mt-1 ${m?"text-gray-300 cursor-not-allowed":E?"text-gray-400 cursor-wait":"text-gray-400 hover:text-gray-600 cursor-move"}`,title:n(m?"programManagement.inactive":"programManagement.dragToReorder"),disabled:E||m,children:e.jsx(ke,{className:"text-2xl"})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsxs("span",{className:`text-sm ${m?"text-gray-600":"text-gray-500"}`,children:[t.start_time," - ",t.end_time]}),H&&e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${m?"text-gray-600 bg-gray-200":"text-blue-700 bg-blue-100"}`,children:H}),m&&e.jsx("span",{className:"px-2 py-1 text-xs font-medium text-orange-700 bg-orange-100 rounded",children:n("programManagement.inactive")})]}),e.jsx("h3",{className:`text-lg font-semibold mb-1 ${m?"text-gray-700":"text-gray-900"}`,children:ue}),e.jsx("p",{className:"text-sm mb-2 line-clamp-2 text-gray-600",children:Y}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsxs("span",{className:m?"text-gray-600":"text-gray-500",children:[n("programManagement.location"),":"]}),e.jsx("span",{className:"font-medium text-gray-700",children:x.text}),t.show_location_type_badge&&e.jsx("span",{className:`px-2 py-0.5 text-xs rounded ${m?t.location_type==="exhibitor"||t.location_type==="company"?"bg-green-50 text-green-600":"bg-gray-50 text-gray-600":t.location_type==="exhibitor"||t.location_type==="company"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:t.location_type==="exhibitor"||t.location_type==="company"?n("programManagement.exhibitor"):n("programManagement.venue")})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>be(t),"data-testid":"copy-activity-button",className:`p-2 rounded-lg transition-colors ${m?"text-gray-400 hover:bg-gray-50 cursor-not-allowed":"text-gray-600 hover:bg-gray-50"}`,title:"Copy activity",disabled:m,children:e.jsx(ve,{className:"text-xl"})}),e.jsx("button",{onClick:()=>{w(t),k(!0)},className:`p-2 rounded-lg transition-colors ${m?"text-blue-400 hover:bg-blue-50":"text-blue-600 hover:bg-blue-50"}`,title:n("programManagement.edit"),children:e.jsx(Te,{className:"text-xl"})}),m?e.jsx("button",{onClick:()=>fe(t.id),className:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:n("programManagement.reactivate"),children:e.jsx(Le,{className:"text-xl"})}):e.jsx("button",{onClick:()=>q({id:t.id,title:ue}),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:n("programManagement.delete"),children:e.jsx(Ae,{className:"text-xl"})})]})]})})]})})]},`activity-${t.id}`)})})}),b.length>0&&e.jsx("div",{className:"border-t border-gray-200 px-6 py-3 bg-gray-50","data-testid":"program-stats",children:e.jsxs("div",{className:"flex gap-6 text-sm",children:[e.jsxs("p",{className:"text-gray-600",children:[n("programManagement.totalActivities"),":"," ",e.jsx("span",{className:"font-medium",children:b.length})]}),e.jsxs("p",{className:"text-gray-600",children:[n("programManagement.activeActivities"),":"," ",e.jsx("span",{className:"font-medium text-green-600",children:b.filter(t=>t.is_active).length})]}),e.jsxs("p",{className:"text-gray-600",children:[n("programManagement.inactiveActivities"),":"," ",e.jsx("span",{className:"font-medium text-orange-600",children:b.filter(t=>!t.is_active).length})]})]})}),e.jsxs(Ee,{isOpen:!!g,onClose:()=>q(null),title:n("programManagement.confirmDelete"),size:"md",children:[e.jsxs("div",{className:"p-6",children:[e.jsx("p",{className:"text-gray-700",children:n("programManagement.confirmDeleteMessage")}),e.jsxs("p",{className:"mt-2 font-medium text-gray-900",children:['"',g==null?void 0:g.title,'"']})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-50 flex justify-end gap-3 border-t border-gray-200",children:[e.jsx("button",{onClick:()=>q(null),disabled:D,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50",children:n("programManagement.cancel")}),e.jsx("button",{onClick:()=>a(g==null?void 0:g.id),disabled:D,className:"px-4 py-2 text-white bg-red-600 rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50 flex items-center gap-2",children:D?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),n("programManagement.deleting")]}):n("programManagement.deleteButton")})]})]}),W&&e.jsx(Pe,{activity:O,day:v,year:s,initialActivityData:O?null:h,onSave:()=>{I(),h&&z(null)},onClose:()=>{k(!1),w(null)}})]})}export{Je as default};
