import{u as U,a as q,r as t,B as j,R as e,s as b}from"./index-1e4c7e6c.js";import{L as B}from"./LanguageToggle-08a9130b.js";function H({branding:r}){const{t:s}=U(),p=q(),[m,k]=t.useState(""),[g,S]=t.useState(""),[c,T]=t.useState(!1),[d,i]=t.useState(null),[E,u]=t.useState(null),[P,h]=t.useState(!1),[R,L]=t.useState(!1),w=t.useRef(null);t.useEffect(()=>{d&&w.current&&w.current.focus()},[d]),t.useEffect(()=>{(async()=>{const l=window.location.hash;let a;if(l.includes("error=")){const n=l.substring(1);a=new URLSearchParams(n)}else{const n=l.indexOf("#",1);if(n>0){const f=l.substring(n+1);a=new URLSearchParams(f)}else a=new URLSearchParams(window.location.search)}const N=a.get("access_token"),v=a.get("refresh_token"),y=a.get("error"),x=a.get("error_description");if(y){y==="access_denied"||x!=null&&x.includes("expired")?u(s("resetPassword.errors.tokenExpired")):u(s("resetPassword.errors.invalidToken"));return}if(N&&v){const{data:{session:n},error:f}=await b.auth.setSession({access_token:N,refresh_token:v});(f||!n)&&(console.error("Failed to set session:",f),u(s("resetPassword.errors.invalidToken")));return}const{data:{session:I}}=await b.auth.getSession();I||u(s("resetPassword.errors.invalidToken"))})()},[s]);const C=async o=>{if(o.preventDefault(),i(null),m.length<6){i(s("resetPassword.errors.passwordTooShort"));return}if(m!==g){i(s("resetPassword.errors.passwordMismatch"));return}h(!0);const{error:l}=await b.auth.updateUser({password:m});h(!1),l?i(s("resetPassword.errors.updateFailed")):(L(!0),setTimeout(()=>{p("/admin")},3e3))},_=(r==null?void 0:r.eventName)||"4x4 Vakantiebeurs",F=(r==null?void 0:r.logo)||j.getDefaultLogoPath();return e.createElement("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-orange-50 flex items-center justify-center px-4 py-8"},e.createElement("div",{className:"w-full max-w-md"},e.createElement("div",{className:"bg-white rounded-2xl shadow-xl p-8 border border-gray-100"},e.createElement("div",{className:"flex justify-end mb-6"},e.createElement(B,null)),e.createElement("div",{className:"flex flex-col items-center mb-8"},e.createElement("div",{className:"bg-gradient-to-br from-orange-500 to-orange-600 p-3 rounded-xl shadow-lg mb-4"},e.createElement("img",{src:F,alt:"Event Logo",className:"h-12 w-12 object-contain"})),e.createElement("h1",{className:"font-bold text-2xl text-gray-800 mb-1"},_),e.createElement("p",{className:"text-gray-500 text-sm"},"Manager Portal")),e.createElement("h2",{className:"text-xl font-bold mb-2 text-gray-800"},s("resetPassword.title")),e.createElement("p",{className:"text-sm text-gray-600 mb-6"},s("resetPassword.instructions")),R?e.createElement("div",{className:"bg-green-50 border-l-4 border-green-500 text-green-700 px-4 py-3 rounded-lg shadow-sm",role:"alert","aria-live":"polite"},e.createElement("div",{className:"flex items-center mb-2"},e.createElement("span",{className:"text-xl mr-3"},"‚úì"),e.createElement("span",{className:"font-semibold"},s("resetPassword.success"))),e.createElement("p",{className:"text-sm ml-8"},s("resetPassword.redirecting"))):E?e.createElement("div",{className:"space-y-4"},e.createElement("div",{ref:w,className:"bg-red-50 border-l-4 border-red-500 text-red-700 px-4 py-3 rounded-lg shadow-sm",role:"alert","aria-live":"assertive",tabIndex:-1},e.createElement("div",{className:"flex items-start"},e.createElement("span",{className:"text-xl mr-3"},"‚ö†"),e.createElement("div",{className:"flex-1"},e.createElement("p",{className:"font-semibold mb-1"},s("resetPassword.errors.linkExpiredTitle")),e.createElement("p",{className:"text-sm"},E)))),e.createElement("div",{className:"flex gap-3"},e.createElement("button",{type:"button",onClick:()=>p("/admin"),className:"flex-1 btn-primary"},s("resetPassword.requestNewLink")))):e.createElement("form",{onSubmit:C,className:"space-y-5"},e.createElement("div",null,e.createElement("label",{htmlFor:"new-password",className:"label-base"},s("resetPassword.newPassword")),e.createElement("div",{className:"relative"},e.createElement("input",{id:"new-password",type:c?"text":"password",value:m,onChange:o=>k(o.target.value),className:"input-base",placeholder:s("resetPassword.newPasswordPlaceholder"),"aria-label":s("resetPassword.newPassword"),required:!0,minLength:6}),e.createElement("button",{type:"button",onClick:()=>T(!c),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors text-sm","aria-label":s(c?"resetPassword.hidePassword":"resetPassword.showPassword")},c?"üëÅÔ∏è":"üëÅÔ∏è‚Äçüó®Ô∏è")),e.createElement("p",{className:"text-xs text-gray-500 mt-1"},s("resetPassword.passwordRequirements"))),e.createElement("div",null,e.createElement("label",{htmlFor:"confirm-password",className:"label-base"},s("resetPassword.confirmPassword")),e.createElement("input",{id:"confirm-password",type:c?"text":"password",value:g,onChange:o=>S(o.target.value),className:"input-base",placeholder:s("resetPassword.confirmPasswordPlaceholder"),"aria-label":s("resetPassword.confirmPassword"),required:!0})),d&&e.createElement("div",{ref:w,className:"bg-red-50 border-l-4 border-red-500 text-red-700 px-4 py-3 rounded-lg shadow-sm",role:"alert","aria-live":"assertive",tabIndex:-1},e.createElement("div",{className:"flex items-center"},e.createElement("span",{className:"text-xl mr-3"},"‚ö†"),e.createElement("span",{className:"text-sm"},d))),e.createElement("button",{type:"submit",className:"btn-primary w-full",disabled:P},s(P?"resetPassword.updating":"resetPassword.updatePassword")),e.createElement("button",{type:"button",onClick:()=>p("/admin"),className:"w-full py-2 text-orange-600 hover:text-orange-700 font-medium text-sm transition-colors"},"‚Üê ",s("resetPassword.backToLogin"))))))}export{H as default};
