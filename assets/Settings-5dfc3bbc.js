import{c as A,r,R as J,j as e,I as l}from"./vendor-react-600751b5.js";import{b5 as V,aZ as ee,b6 as P,b7 as se,a_ as te,a$ as ae,aY as ne,aF as B,at as G,b8 as re,b9 as ie,ba as K,bb as H,bc as Q,ap as q,bd as X,be as le,an as oe,aH as de}from"./vendor-57b332a3.js";import{u as Y}from"./useUserRole-783d1ca7.js";import"./ProtectedSection-2e9c3c4b.js";import{i as O,s as U,M as ce}from"./index-c9551a19.js";import{u as W}from"./useOrganizationSettings-07e9ee5f.js";import{L as me}from"./LanguageToggle-a8ff8a15.js";import ge from"./CategoryManagement-a3cb12e3.js";import{u as ue}from"./useEventMapSettings-2b4584df.js";import"./vendor-i18n-2e1fa53c.js";import"./vendor-supabase-a724a182.js";import"./vendor-map-53abdaff.js";import"./useCategories-e5851c15.js";function xe(){const{t:s}=A(),{isSuperAdmin:t}=Y(),{confirm:n}=O(),[f,$]=r.useState([]),[v,k]=r.useState(!0),[x,b]=r.useState(null),[Z,d]=r.useState(!1),[N,p]=r.useState(""),[a,D]=r.useState("event_manager"),[z,m]=r.useState(!1),[y,L]=r.useState(!1),[E,I]=r.useState(null),C=J.useCallback(async()=>{try{k(!0),b(null);let i,o;try{const _=await U.rpc("get_user_roles_with_email");i=_.data,o=_.error}catch{console.warn("get_user_roles_with_email not available, using fallback");const c=await U.from("user_roles").select("user_id, role, created_at, updated_at").order("created_at",{ascending:!1});i=c.data,o=c.error}if(o)throw o;const{data:{user:u}}=await U.auth.getUser(),h=(i||[]).map(_=>{const c=(u==null?void 0:u.id)===_.user_id;return{id:_.user_id,email:_.email||(c?u.email:`user-${_.user_id.substring(0,8)}...`),role:_.role,created_at:_.created_at,last_sign_in_at:_.last_sign_in_at||(c?u.last_sign_in_at:null),isCurrentUser:c}});$(h),k(!1)}catch(i){console.error("Error fetching users:",i),b(s("settings.userManagement.errors.fetchFailed")),k(!1)}},[s]);r.useEffect(()=>{C()},[C]);const M=async i=>{var o;i.preventDefault(),m(!0),b(null);try{const h="/Map",_=`${window.location.origin}${h}#/reset-password`,c=Math.random().toString(36).slice(-12)+"A1!",{data:R,error:S}=await U.auth.signUp({email:N,password:c,options:{data:{role:a},emailRedirectTo:_}});if(S)throw S;if((o=R==null?void 0:R.user)!=null&&o.id){const{error:T}=await U.from("user_roles").insert({user_id:R.user.id,role:a});T&&console.warn("Failed to add user to user_roles:",T)}const{error:j}=await U.auth.resetPasswordForEmail(N,{redirectTo:_});j&&console.warn("Password reset email failed:",j),L(!0),setTimeout(()=>{d(!1),L(!1),p(""),D("event_manager"),C()},8e3)}catch(u){console.error("Error inviting user:",u),b(u.message||s("settings.userManagement.errors.inviteFailed"))}finally{m(!1)}},g=async(i,o)=>{if(await n({title:s("settings.userManagement.deleteUser"),message:s("settings.userManagement.confirmDelete",{email:o}),confirmText:s("common.delete"),variant:"danger"}))try{b(null);const{error:h}=await U.from("user_roles").delete().eq("user_id",i);if(h)throw h;await C()}catch(h){console.error("Error deleting user:",h),b(s("settings.userManagement.errors.deleteFailed"))}},w={super_admin:s("settings.userManagement.roles.superAdmin"),system_manager:s("settings.userManagement.roles.systemManager"),event_manager:s("settings.userManagement.roles.eventManager")},F={super_admin:"bg-purple-100 text-purple-800 border-purple-200",system_manager:"bg-blue-100 text-blue-800 border-blue-200",event_manager:"bg-green-100 text-green-800 border-green-200"};return v?e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"text-gray-500",children:s("settings.userManagement.loading")})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(l,{path:V,size:1}),s("settings.userManagement.title")]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:s("settings.userManagement.description")})]}),e.jsxs("button",{onClick:()=>d(!0),className:"btn-primary flex items-center gap-2",children:[e.jsx(l,{path:ee,size:.8}),s("settings.userManagement.inviteUser")]})]}),x&&e.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 text-red-700 px-4 py-3 rounded-lg mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(l,{path:P,size:.8,className:"mr-2"}),e.jsx("span",{className:"text-sm",children:x})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-700",children:s("settings.userManagement.table.email")}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-700",children:s("settings.userManagement.table.role")}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-700",children:s("settings.userManagement.table.created")}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-700",children:s("settings.userManagement.table.lastLogin")}),e.jsx("th",{className:"text-right py-3 px-4 text-sm font-semibold text-gray-700",children:s("settings.userManagement.table.actions")})]})}),e.jsx("tbody",{children:f.map(i=>e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(l,{path:se,size:.7,className:"text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-900",children:i.email})]})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-xs font-medium border ${F[i.role]||"bg-gray-100 text-gray-800"}`,children:w[i.role]||i.role})}),e.jsx("td",{className:"py-3 px-4 text-sm text-gray-600",children:new Date(i.created_at).toLocaleDateString()}),e.jsx("td",{className:"py-3 px-4 text-sm text-gray-600",children:i.last_sign_in_at?new Date(i.last_sign_in_at).toLocaleDateString():"-"}),e.jsx("td",{className:"py-3 px-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>I(i),className:"p-2 text-blue-600 hover:bg-blue-50 rounded transition-colors",title:s("settings.userManagement.editRole"),children:e.jsx(l,{path:te,size:.7})}),t&&e.jsx("button",{onClick:()=>g(i.id,i.email),className:"p-2 text-red-600 hover:bg-red-50 rounded transition-colors",title:s("settings.userManagement.deleteUser"),children:e.jsx(l,{path:ae,size:.7})})]})})]},i.id))})]})})]}),e.jsx(ce,{isOpen:Z,onClose:()=>d(!1),title:s("settings.userManagement.inviteUser"),size:"md",children:e.jsx("div",{className:"p-6",children:y?e.jsx("div",{className:"bg-green-50 border-l-4 border-green-500 text-green-700 px-4 py-3 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(l,{path:ne,size:.8,className:"mr-2"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:s("settings.userManagement.inviteSuccess")}),e.jsx("p",{className:"text-sm mt-1",children:s("settings.userManagement.inviteSuccessMessage")})]})]})}):e.jsxs("form",{onSubmit:M,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label-base",children:s("settings.userManagement.emailLabel")}),e.jsx("input",{type:"email",value:N,onChange:i=>p(i.target.value),className:"input-base",placeholder:"manager@example.com",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label-base",children:s("settings.userManagement.roleLabel")}),e.jsxs("select",{value:a,onChange:i=>D(i.target.value),className:"input-base",children:[e.jsx("option",{value:"event_manager",children:w.event_manager}),e.jsx("option",{value:"system_manager",children:w.system_manager}),t&&e.jsx("option",{value:"super_admin",children:w.super_admin})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:s(`settings.userManagement.roleDescriptions.${a}`)})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:()=>d(!1),className:"flex-1 py-2 px-4 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:s("settings.userManagement.cancel")}),e.jsx("button",{type:"submit",disabled:z,className:"flex-1 btn-primary",children:s(z?"settings.userManagement.sending":"settings.userManagement.sendInvite")})]})]})})})]})}function pe(){const{t:s}=A(),{settings:t,loading:n,error:f,updateSettings:$}=W(),{toastError:v,toastWarning:k}=O(),[x,b]=r.useState(!1),[Z,d]=r.useState(!1),[N,p]=r.useState(null),[a,D]=r.useState(0),[z,m]=r.useState(0),[y,L]=r.useState(0),[E,I]=r.useState(0),[C,M]=r.useState(0),[g,w]=r.useState(!0),[F,i]=r.useState(!0),[o,u]=r.useState(!0);r.useEffect(()=>{if(t&&(D(t.default_breakfast_sat??0),m(t.default_lunch_sat??0),L(t.default_bbq_sat??0),I(t.default_breakfast_sun??0),M(t.default_lunch_sun??0),t.notification_settings)){const c=typeof t.notification_settings=="string"?JSON.parse(t.notification_settings):t.notification_settings;w(c.emailNotifications??!0),i(c.newSubscriptionNotify??!0),u(c.assignmentChangeNotify??!0)}},[t]);const h=async c=>{var R;c.preventDefault(),b(!0),p(null),d(!1);try{if(!await $({default_breakfast_sat:a,default_lunch_sat:z,default_bbq_sat:y,default_breakfast_sun:E,default_lunch_sun:C,notification_settings:{emailNotifications:g,newSubscriptionNotify:F,assignmentChangeNotify:o}}))throw new Error("Failed to update settings");d(!0),setTimeout(()=>d(!1),3e3)}catch(S){console.error("Failed to save settings:",S),(R=S.message)!=null&&R.includes("updated by another admin")?(k(S.message),p(s("settings.eventDefaults.errors.saveFailed"))):(v(S.message||s("settings.eventDefaults.errors.saveFailed")),p(S.message||s("settings.eventDefaults.errors.saveFailed")))}finally{b(!1)}},_=()=>{if(t&&(D(t.default_breakfast_sat??0),m(t.default_lunch_sat??0),L(t.default_bbq_sat??0),I(t.default_breakfast_sun??0),M(t.default_lunch_sun??0),t.notification_settings)){const c=typeof t.notification_settings=="string"?JSON.parse(t.notification_settings):t.notification_settings;w(c.emailNotifications??!0),i(c.newSubscriptionNotify??!0),u(c.assignmentChangeNotify??!0)}};return n?e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-orange-600"}),e.jsx("span",{className:"ml-3 text-gray-600",children:s("settings.eventDefaults.loading")})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:s("settings.eventDefaults.title")}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-orange-50 border border-orange-200 rounded-lg",children:[e.jsx(l,{path:B,size:.6,className:"text-orange-600"}),e.jsx("span",{className:"text-xs font-semibold text-orange-700 uppercase tracking-wide",children:"Organization Setting"})]})]}),e.jsx("p",{className:"text-sm text-gray-600",children:s("settings.eventDefaults.description")})]}),Z&&e.jsxs("div",{className:"bg-green-50 border-l-4 border-green-500 p-4 rounded-lg flex items-start",children:[e.jsx(l,{path:G,size:1,className:"text-green-600 mr-3 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-green-800",children:s("settings.eventDefaults.saveSuccess")}),e.jsx("p",{className:"text-sm text-green-700",children:s("settings.eventDefaults.saveSuccessMessage")})]})]}),N&&e.jsxs("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 rounded-lg flex items-start",children:[e.jsx(l,{path:P,size:1,className:"text-red-600 mr-3 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-red-800",children:s("settings.eventDefaults.error")}),e.jsx("p",{className:"text-sm text-red-700",children:N})]})]}),e.jsxs("form",{onSubmit:h,className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(l,{path:re,size:1,className:"text-orange-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s("settings.eventDefaults.mealDefaults.title")})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-6",children:s("settings.eventDefaults.mealDefaults.description")}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:s("settings.eventDefaults.mealDefaults.saturday")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"breakfastSat",className:"label-base",children:s("settings.eventDefaults.mealDefaults.breakfast")}),e.jsx("input",{type:"number",id:"breakfastSat",min:"0",max:"9999",value:a,onChange:c=>D(parseInt(c.target.value)||0),className:"input-base"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"lunchSat",className:"label-base",children:s("settings.eventDefaults.mealDefaults.lunch")}),e.jsx("input",{type:"number",id:"lunchSat",min:"0",max:"9999",value:z,onChange:c=>m(parseInt(c.target.value)||0),className:"input-base"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"bbqSat",className:"label-base",children:s("settings.eventDefaults.mealDefaults.bbq")}),e.jsx("input",{type:"number",id:"bbqSat",min:"0",max:"9999",value:y,onChange:c=>L(parseInt(c.target.value)||0),className:"input-base"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:s("settings.eventDefaults.mealDefaults.sunday")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"breakfastSun",className:"label-base",children:s("settings.eventDefaults.mealDefaults.breakfast")}),e.jsx("input",{type:"number",id:"breakfastSun",min:"0",max:"9999",value:E,onChange:c=>I(parseInt(c.target.value)||0),className:"input-base"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"lunchSun",className:"label-base",children:s("settings.eventDefaults.mealDefaults.lunch")}),e.jsx("input",{type:"number",id:"lunchSun",min:"0",max:"9999",value:C,onChange:c=>M(parseInt(c.target.value)||0),className:"input-base"})]}),e.jsxs("div",{className:"opacity-50",children:[e.jsx("label",{className:"label-base text-gray-400",children:s("settings.eventDefaults.mealDefaults.bbq")}),e.jsx("span",{className:"input-base bg-gray-100 cursor-not-allowed block w-full h-[2.5rem] rounded text-center text-gray-400","aria-disabled":"true",children:"‚Äî"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:s("settings.eventDefaults.mealDefaults.sundayNoBbq")})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(l,{path:ie,size:1,className:"text-orange-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s("settings.eventDefaults.notifications.title")})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-6",children:s("settings.eventDefaults.notifications.description")}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"emailNotifications",className:"font-medium text-gray-900",children:s("settings.eventDefaults.notifications.emailNotifications")}),e.jsx("p",{className:"text-sm text-gray-600",children:s("settings.eventDefaults.notifications.emailNotificationsDesc")})]}),e.jsx("button",{type:"button",role:"switch","aria-checked":g,onClick:()=>w(!g),className:`relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2 ${g?"bg-orange-600":"bg-gray-300"}`,children:e.jsx("span",{className:`pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out ${g?"translate-x-5":"translate-x-0"}`})})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"newSubscriptionNotify",className:"font-medium text-gray-900",children:s("settings.eventDefaults.notifications.newSubscription")}),e.jsx("p",{className:"text-sm text-gray-600",children:s("settings.eventDefaults.notifications.newSubscriptionDesc")})]}),e.jsx("button",{type:"button",role:"switch","aria-checked":F,onClick:()=>i(!F),disabled:!g,className:`relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2 ${F&&g?"bg-orange-600":"bg-gray-300"} ${g?"":"opacity-50 cursor-not-allowed"}`,children:e.jsx("span",{className:`pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out ${F?"translate-x-5":"translate-x-0"}`})})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"assignmentChangeNotify",className:"font-medium text-gray-900",children:s("settings.eventDefaults.notifications.assignmentChange")}),e.jsx("p",{className:"text-sm text-gray-600",children:s("settings.eventDefaults.notifications.assignmentChangeDesc")})]}),e.jsx("button",{type:"button",role:"switch","aria-checked":o,onClick:()=>u(!o),disabled:!g,className:`relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2 ${o&&g?"bg-orange-600":"bg-gray-300"} ${g?"":"opacity-50 cursor-not-allowed"}`,children:e.jsx("span",{className:`pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out ${o?"translate-x-5":"translate-x-0"}`})})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 bg-white rounded-lg shadow p-6",children:[e.jsx("button",{type:"button",onClick:_,disabled:x,className:"px-6 py-2 border border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:s("settings.eventDefaults.reset")}),e.jsx("button",{type:"submit",disabled:x,className:"btn-primary px-6 py-2 disabled:opacity-50 disabled:cursor-not-allowed",children:s(x?"settings.eventDefaults.saving":"settings.eventDefaults.save")})]})]})]})}function he(){const{t:s}=A(),{settings:t,loading:n,updateSettings:f}=W(),{toastError:$,toastWarning:v}=O(),[k,x]=r.useState(!1),[b,Z]=r.useState(!1),[d,N]=r.useState("#3b82f6"),[p,a]=r.useState("Arvo, serif");r.useEffect(()=>{t&&(N(t.theme_color||"#3b82f6"),a(t.font_family||"Arvo, serif"))},[t]);const D=async()=>{var m;try{if(x(!0),!await f({theme_color:d,font_family:p}))throw new Error("Failed to update branding settings");Z(!0),setTimeout(()=>Z(!1),3e3)}catch(y){console.error("Error saving branding settings:",y),(m=y.message)!=null&&m.includes("updated by another admin")?v(y.message):$(y.message||s("settings.branding.errors.saveFailed"))}finally{x(!1)}},z=()=>{t&&(N(t.theme_color||"#3b82f6"),a(t.font_family||"Arvo, serif"))};return n?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx("div",{className:"text-gray-500",children:s("settings.branding.loading")})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(l,{path:K,size:1,className:"text-orange-600"}),e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:s("settings.branding.title")})]}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-orange-50 border border-orange-200 rounded-lg",children:[e.jsx(l,{path:B,size:.6,className:"text-orange-600"}),e.jsx("span",{className:"text-xs font-semibold text-orange-700 uppercase tracking-wide",children:"Organization Setting"})]})]}),e.jsx("p",{className:"text-sm text-gray-600",children:s("settings.branding.description")}),e.jsxs("p",{className:"mt-2 text-xs text-gray-500",children:["üí° ",s("settings.branding.note")]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:s("settings.branding.themeColor.label")}),e.jsx("p",{className:"text-xs text-gray-500 mb-3",children:s("settings.branding.themeColor.description")}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("input",{type:"color",value:d,onChange:m=>N(m.target.value),className:"h-12 w-24 border border-gray-300 rounded cursor-pointer"}),e.jsx("input",{type:"text",value:d,onChange:m=>N(m.target.value),placeholder:"#ffffff",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",maxLength:7})]}),e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsxs("div",{className:"p-4 rounded-lg border-2",style:{backgroundColor:d,borderColor:d},children:[e.jsx("p",{className:"font-bold text-white text-lg",children:"Preview Text (White on Color)"}),e.jsx("p",{className:"text-white text-sm opacity-90",children:"The quick brown fox jumps over the lazy dog"})]}),e.jsxs("div",{className:"p-4 rounded-lg border-2 border-gray-300 bg-white",children:[e.jsx("p",{className:"font-bold text-lg",style:{color:d},children:"Preview Text (Color on White)"}),e.jsx("p",{className:"text-sm",style:{color:d},children:"The quick brown fox jumps over the lazy dog"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:s("settings.branding.fontFamily.label")}),e.jsx("p",{className:"text-xs text-gray-500 mb-3",children:s("settings.branding.fontFamily.description")}),e.jsxs("select",{value:p,onChange:m=>a(m.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"Arvo, Sans-serif",children:"Arvo (Default)"}),e.jsx("option",{value:"Arial, sans-serif",children:"Arial"}),e.jsx("option",{value:"Helvetica, sans-serif",children:"Helvetica"}),e.jsx("option",{value:"Georgia, serif",children:"Georgia"}),e.jsx("option",{value:"'Times New Roman', serif",children:"Times New Roman"}),e.jsx("option",{value:"'Courier New', monospace",children:"Courier New"}),e.jsx("option",{value:"Verdana, sans-serif",children:"Verdana"}),e.jsx("option",{value:"'Comic Sans MS', cursive",children:"Comic Sans MS"}),e.jsx("option",{value:"Impact, sans-serif",children:"Impact"})]}),e.jsxs("div",{className:"mt-3 p-4 rounded-lg border border-gray-300 bg-white",style:{fontFamily:p},children:[e.jsx("p",{className:"text-lg text-gray-900 font-semibold",children:"The quick brown fox jumps over the lazy dog"}),e.jsx("p",{className:"text-sm text-gray-700 mt-1",children:"1234567890 !@#$%^&*()"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("button",{onClick:z,className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-md hover:bg-gray-50",children:s("settings.branding.reset")}),e.jsx("button",{onClick:D,disabled:k,className:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:k?s("common.saving"):b?e.jsxs(e.Fragment,{children:[e.jsx(l,{path:G,size:.8}),s("settings.branding.saveSuccess")]}):s("common.save")})]})]})}function fe(){const{t:s}=A();return e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(l,{path:H,size:1.2,className:"text-blue-600"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:s("settings.uiLanguage.title")}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:s("settings.uiLanguage.description")})]})]}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx(l,{path:Q,size:.6,className:"text-blue-600"}),e.jsx("span",{className:"text-xs font-semibold text-blue-700 uppercase tracking-wide",children:"Personal Setting"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(l,{path:H,size:.9,className:"text-blue-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("p",{className:"font-semibold mb-1",children:s("settings.uiLanguage.note.title")}),e.jsx("p",{children:s("settings.uiLanguage.note.description")})]})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:s("settings.uiLanguage.selectLanguage")}),e.jsx(me,{})]})]})]})}function be(){return e.jsx(ge,{})}function je(){const{t:s}=A(),{settings:t,loading:n,error:f,updateSettings:$}=W(),{toastError:v,toastWarning:k}=O(),[x,b]=r.useState(!1),[Z,d]=r.useState(!1),[N,p]=r.useState(null),[a,D]=r.useState(51.898095),[z,m]=r.useState(5.772961),[y,L]=r.useState(17),[E,I]=r.useState(14),[C,M]=r.useState(22),[g,w]=r.useState(21);r.useEffect(()=>{t&&(D(t.map_center_lat??51.898095),m(t.map_center_lng??5.772961),L(t.map_default_zoom??17),I(t.map_min_zoom??14),M(t.map_max_zoom??22),w(t.map_search_zoom??21))},[t]);const F=async o=>{var u;o.preventDefault(),b(!0),p(null),d(!1);try{if(E>y||y>C)throw new Error(s("settings.mapDefaults.errors.invalidZoomLevels"));if(g<E||g>C)throw new Error(s("settings.mapDefaults.errors.invalidSearchZoom"));if(!await $({map_center_lat:parseFloat(a),map_center_lng:parseFloat(z),map_default_zoom:parseInt(y),map_min_zoom:parseInt(E),map_max_zoom:parseInt(C),map_search_zoom:parseInt(g)}))throw new Error("Failed to update map settings");d(!0),setTimeout(()=>d(!1),3e3)}catch(h){console.error("Failed to save map settings:",h),(u=h.message)!=null&&u.includes("updated by another admin")?(k(h.message),p(s("settings.mapDefaults.errors.saveFailed"))):(v(h.message||s("settings.mapDefaults.errors.saveFailed")),p(h.message||s("settings.mapDefaults.errors.saveFailed")))}finally{b(!1)}},i=()=>{t&&(D(t.map_center_lat??51.898095),m(t.map_center_lng??5.772961),L(t.map_default_zoom??17),I(t.map_min_zoom??14),M(t.map_max_zoom??22),w(t.map_search_zoom??21))};return n?e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-orange-600"}),e.jsx("span",{className:"ml-3 text-gray-600",children:s("settings.mapDefaults.loading")})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:s("settings.mapDefaults.title")}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-orange-50 border border-orange-200 rounded-lg",children:[e.jsx(l,{path:B,size:.6,className:"text-orange-600"}),e.jsx("span",{className:"text-xs font-semibold text-orange-700 uppercase tracking-wide",children:"Organization Setting"})]})]}),e.jsx("p",{className:"text-sm text-gray-600",children:s("settings.mapDefaults.description")})]}),Z&&e.jsxs("div",{className:"bg-green-50 border-l-4 border-green-500 p-4 rounded-lg flex items-start",children:[e.jsx(l,{path:G,size:1,className:"text-green-600 mr-3 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-green-800",children:s("settings.mapDefaults.saveSuccess")}),e.jsx("p",{className:"text-sm text-green-700",children:s("settings.mapDefaults.saveSuccessMessage")})]})]}),N&&e.jsxs("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 rounded-lg flex items-start",children:[e.jsx(l,{path:P,size:1,className:"text-red-600 mr-3 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-red-800",children:s("settings.mapDefaults.error")}),e.jsx("p",{className:"text-sm text-red-700",children:N})]})]}),e.jsxs("form",{onSubmit:F,className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(l,{path:q,size:1,className:"text-orange-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s("settings.mapDefaults.mapCenter.title")})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-6",children:s("settings.mapDefaults.mapCenter.description")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"mapCenterLat",className:"label-base",children:s("settings.mapDefaults.mapCenter.latitude")}),e.jsx("input",{type:"number",id:"mapCenterLat",step:"0.000001",min:"-90",max:"90",value:a,onChange:o=>D(o.target.value),className:"input-base",placeholder:"51.898095"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:s("settings.mapDefaults.mapCenter.latitudeRange")})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"mapCenterLng",className:"label-base",children:s("settings.mapDefaults.mapCenter.longitude")}),e.jsx("input",{type:"number",id:"mapCenterLng",step:"0.000001",min:"-180",max:"180",value:z,onChange:o=>m(o.target.value),className:"input-base",placeholder:"5.772961"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:s("settings.mapDefaults.mapCenter.longitudeRange")})]})]}),e.jsxs("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg flex items-start gap-2",children:[e.jsx(l,{path:X,size:.8,className:"text-blue-600 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-sm text-blue-800",children:s("settings.mapDefaults.mapCenter.hint")})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(l,{path:q,size:1,className:"text-orange-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s("settings.mapDefaults.zoomLevels.title")})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-6",children:s("settings.mapDefaults.zoomLevels.description")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"mapDefaultZoom",className:"label-base",children:s("settings.mapDefaults.zoomLevels.defaultZoom")}),e.jsx("input",{type:"number",id:"mapDefaultZoom",min:"1",max:"22",value:y,onChange:o=>L(o.target.value),className:"input-base"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:s("settings.mapDefaults.zoomLevels.defaultZoomDesc")})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"mapSearchZoom",className:"label-base",children:s("settings.mapDefaults.zoomLevels.searchZoom")}),e.jsx("input",{type:"number",id:"mapSearchZoom",min:"1",max:"22",value:g,onChange:o=>w(o.target.value),className:"input-base"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:s("settings.mapDefaults.zoomLevels.searchZoomDesc")})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"mapMinZoom",className:"label-base",children:s("settings.mapDefaults.zoomLevels.minZoom")}),e.jsx("input",{type:"number",id:"mapMinZoom",min:"1",max:"22",value:E,onChange:o=>I(o.target.value),className:"input-base"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:s("settings.mapDefaults.zoomLevels.minZoomDesc")})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"mapMaxZoom",className:"label-base",children:s("settings.mapDefaults.zoomLevels.maxZoom")}),e.jsx("input",{type:"number",id:"mapMaxZoom",min:"1",max:"22",value:C,onChange:o=>M(o.target.value),className:"input-base"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:s("settings.mapDefaults.zoomLevels.maxZoomDesc")})]})]}),e.jsx("div",{className:"mt-4 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-amber-800",children:[e.jsxs("span",{className:"font-medium",children:[s("settings.mapDefaults.zoomLevels.constraint"),":"]})," ",s("settings.mapDefaults.zoomLevels.constraintDesc")]})})]}),e.jsxs("div",{className:"flex justify-end gap-3 bg-white rounded-lg shadow p-6",children:[e.jsx("button",{type:"button",onClick:i,disabled:x,className:"px-6 py-2 border border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:s("settings.mapDefaults.reset")}),e.jsx("button",{type:"submit",disabled:x,className:"btn-primary px-6 py-2 disabled:opacity-50 disabled:cursor-not-allowed",children:s(x?"settings.mapDefaults.saving":"settings.mapDefaults.save")})]})]})]})}function ve({selectedYear:s,setSelectedYear:t}){const{t:n}=A(),{settings:f,loading:$}=W(),{settings:v,loading:k,updateSettings:x,resetToGlobal:b}=ue(s),{toastError:Z,toastWarning:d,confirm:N}=O(),[p,a]=r.useState(!1),[D,z]=r.useState(!1),[m,y]=r.useState(null),[L,E]=r.useState(51.898095),[I,C]=r.useState(5.772961),[M,g]=r.useState(17),[w,F]=r.useState(14),[i,o]=r.useState(22),[u,h]=r.useState(21);r.useEffect(()=>{v?(E(v.map_center_lat??51.898095),C(v.map_center_lng??5.772961),g(v.map_default_zoom??17),F(v.map_min_zoom??14),o(v.map_max_zoom??22),h(v.map_search_zoom??21)):f&&(E(f.map_center_lat??51.898095),C(f.map_center_lng??5.772961),g(f.map_default_zoom??17),F(f.map_min_zoom??14),o(f.map_max_zoom??22),h(f.map_search_zoom??21))},[v,f]);const _=async j=>{j.preventDefault(),a(!0),y(null),z(!1);try{if(w>M||M>i)throw new Error(n("settings.mapDefaults.errors.invalidZoomLevels"));if(u<w||u>i)throw new Error(n("settings.mapDefaults.errors.invalidSearchZoom"));if(!await x({map_center_lat:parseFloat(L),map_center_lng:parseFloat(I),map_default_zoom:parseInt(M),map_min_zoom:parseInt(w),map_max_zoom:parseInt(i),map_search_zoom:parseInt(u)}))throw new Error("Failed to update map settings");z(!0),setTimeout(()=>z(!1),3e3)}catch(T){console.error("Failed to save map settings:",T),Z(T.message||n("settings.mapDefaults.errors.saveFailed")),y(T.message||n("settings.mapDefaults.errors.saveFailed"))}finally{a(!1)}},c=async()=>{if(await N({title:"Reset to Global Settings",message:`Reset map settings for ${s} to use global organization defaults? This will delete any event-specific settings.`,confirmText:"Reset",variant:"warning"}))try{a(!0),await b()&&(z(!0),setTimeout(()=>z(!1),3e3))}catch(T){console.error("Failed to reset to global settings:",T),Z("Failed to reset settings")}finally{a(!1)}},R=$||k,S=!!v;return R?e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-orange-600"}),e.jsx("span",{className:"ml-3 text-gray-600",children:n("settings.mapDefaults.loading")})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:[n("settings.mapDefaults.title")," - ",s]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:`flex items-center gap-2 px-3 py-1.5 border rounded-lg ${S?"bg-green-50 border-green-200":"bg-orange-50 border-orange-200"}`,children:[e.jsx(l,{path:B,size:.6,className:S?"text-green-600":"text-orange-600"}),e.jsx("span",{className:`text-xs font-semibold uppercase tracking-wide ${S?"text-green-700":"text-orange-700"}`,children:S?"Event Settings":"Global Defaults"})]})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Event Year"}),e.jsxs("select",{value:s,onChange:j=>t(parseInt(j.target.value)),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:2024,children:"2024"}),e.jsx("option",{value:2025,children:"2025"}),e.jsx("option",{value:2026,children:"2026"}),e.jsx("option",{value:2027,children:"2027"})]})]}),e.jsx("p",{className:"text-sm text-gray-600",children:S?`Configure map settings specific to the ${s} event.`:`Using global organization defaults for ${s}. Configure event-specific settings below.`})]}),D&&e.jsxs("div",{className:"bg-green-50 border-l-4 border-green-500 p-4 rounded-lg flex items-start",children:[e.jsx(l,{path:G,size:1,className:"text-green-600 mr-3 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-green-800",children:n("settings.mapDefaults.saveSuccess")}),e.jsx("p",{className:"text-sm text-green-700",children:S?`Map settings updated for ${s}.`:`Settings reset to global defaults for ${s}.`})]})]}),m&&e.jsxs("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 rounded-lg flex items-start",children:[e.jsx(l,{path:P,size:1,className:"text-red-600 mr-3 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-red-800",children:n("settings.mapDefaults.error")}),e.jsx("p",{className:"text-sm text-red-700",children:m})]})]}),e.jsxs("form",{onSubmit:_,className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(l,{path:q,size:1,className:"text-orange-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:n("settings.mapDefaults.mapCenter.title")})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-6",children:n("settings.mapDefaults.mapCenter.description")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"mapCenterLat",className:"label-base",children:n("settings.mapDefaults.mapCenter.latitude")}),e.jsx("input",{type:"number",id:"mapCenterLat",step:"0.000001",min:"-90",max:"90",value:L,onChange:j=>E(j.target.value),className:"input-base",placeholder:"51.898095"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:n("settings.mapDefaults.mapCenter.latitudeRange")})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"mapCenterLng",className:"label-base",children:n("settings.mapDefaults.mapCenter.longitude")}),e.jsx("input",{type:"number",id:"mapCenterLng",step:"0.000001",min:"-180",max:"180",value:I,onChange:j=>C(j.target.value),className:"input-base",placeholder:"5.772961"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:n("settings.mapDefaults.mapCenter.longitudeRange")})]})]}),e.jsxs("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg flex items-start gap-2",children:[e.jsx(l,{path:X,size:.8,className:"text-blue-600 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-sm text-blue-800",children:n("settings.mapDefaults.mapCenter.hint")})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(l,{path:q,size:1,className:"text-orange-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:n("settings.mapDefaults.zoomLevels.title")})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-6",children:n("settings.mapDefaults.zoomLevels.description")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"mapDefaultZoom",className:"label-base",children:n("settings.mapDefaults.zoomLevels.defaultZoom")}),e.jsx("input",{type:"number",id:"mapDefaultZoom",min:"1",max:"22",value:M,onChange:j=>g(j.target.value),className:"input-base"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:n("settings.mapDefaults.zoomLevels.defaultZoomDesc")})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"mapSearchZoom",className:"label-base",children:n("settings.mapDefaults.zoomLevels.searchZoom")}),e.jsx("input",{type:"number",id:"mapSearchZoom",min:"1",max:"22",value:u,onChange:j=>h(j.target.value),className:"input-base"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:n("settings.mapDefaults.zoomLevels.searchZoomDesc")})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"mapMinZoom",className:"label-base",children:n("settings.mapDefaults.zoomLevels.minZoom")}),e.jsx("input",{type:"number",id:"mapMinZoom",min:"1",max:"22",value:w,onChange:j=>F(j.target.value),className:"input-base"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:n("settings.mapDefaults.zoomLevels.minZoomDesc")})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"mapMaxZoom",className:"label-base",children:n("settings.mapDefaults.zoomLevels.maxZoom")}),e.jsx("input",{type:"number",id:"mapMaxZoom",min:"1",max:"22",value:i,onChange:j=>o(j.target.value),className:"input-base"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:n("settings.mapDefaults.zoomLevels.maxZoomDesc")})]})]}),e.jsx("div",{className:"mt-4 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-amber-800",children:[e.jsxs("span",{className:"font-medium",children:[n("settings.mapDefaults.zoomLevels.constraint"),":"]})," ",n("settings.mapDefaults.zoomLevels.constraintDesc")]})})]}),e.jsxs("div",{className:"flex justify-between bg-white rounded-lg shadow p-6",children:[e.jsxs("button",{type:"button",onClick:c,disabled:p||!S,className:"flex items-center gap-2 px-6 py-2 border border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(l,{path:le,size:.8}),n("settings.mapDefaults.reset")]}),e.jsx("button",{type:"submit",disabled:p,className:"btn-primary px-6 py-2 disabled:opacity-50 disabled:cursor-not-allowed",children:n(p?"settings.mapDefaults.saving":"settings.mapDefaults.save")})]})]})]})}function Ie({selectedYear:s,setSelectedYear:t}){var p;const{t:n}=A(),{role:f,isSuperAdmin:$,isSystemManager:v,isEventManager:k}=Y(),[x,b]=r.useState("user-management"),d=[{id:"ui-language",label:n("settings.uiLanguage.title"),icon:H,roles:["super_admin","system_manager","event_manager"],component:e.jsx(fe,{}),scope:"personal",description:"Your personal language preference"},{id:"user-management",label:n("settings.userManagement.title"),icon:V,roles:["super_admin","system_manager"],component:e.jsx(xe,{}),scope:"organization",description:"Manage user accounts and roles"},{id:"category-settings",label:n("settings.categoryManagement.title"),icon:oe,roles:["super_admin","system_manager"],component:e.jsx(be,{}),scope:"organization",description:"Company categories for all users"},{id:"branding",label:n("settings.branding.title"),icon:K,roles:["super_admin","system_manager"],component:e.jsx(he,{}),scope:"organization",description:"Logo, colors, and app name"},{id:"map-defaults",label:n("settings.mapDefaults.title"),icon:q,roles:["super_admin","system_manager"],component:e.jsx(je,{}),scope:"organization",description:"Default map position and zoom"},{id:"map-settings",label:"Map Settings by Year",icon:q,roles:["super_admin","system_manager"],component:e.jsx(ve,{selectedYear:s,setSelectedYear:t}),scope:"organization",description:"Configure map settings per event year"},{id:"event-defaults",label:n("settings.eventDefaults.title"),icon:de,roles:["super_admin","system_manager","event_manager"],component:e.jsx(pe,{}),scope:"organization",description:"Default meal counts for events"},{id:"advanced",label:n("settings.advanced.title"),icon:P,roles:["super_admin"],component:e.jsx(Ne,{}),scope:"organization",description:"System configuration (danger zone)"}].filter(a=>$?!0:a.roles.includes(f));J.useEffect(()=>{var a;d.find(D=>D.id===x)||b(((a=d[0])==null?void 0:a.id)||"event-defaults")},[f,d,x]);const N=(p=d.find(a=>a.id===x))==null?void 0:p.component;return e.jsxs("div",{className:"h-full flex flex-col","data-testid":"settings-container",children:[e.jsxs("div",{className:"bg-white border-b border-gray-200 px-6 py-4","data-testid":"settings-header",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:n("settings.title")}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[n("settings.subtitle"),e.jsx("span",{className:"ml-2 px-2 py-0.5 bg-blue-100 text-blue-800 rounded text-xs font-medium capitalize",children:f==null?void 0:f.replace("_"," ")})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsx("aside",{className:"w-64 bg-white border-r border-gray-200 overflow-y-auto","data-testid":"settings-sidebar",children:e.jsxs("nav",{className:"p-4 space-y-4",children:[d.filter(a=>a.scope==="personal").length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 mb-1","data-testid":"personal-settings-group",children:[e.jsx(l,{path:Q,size:.7,className:"text-blue-600"}),e.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Personal Settings"})]}),e.jsx("div",{className:"space-y-1",children:d.filter(a=>a.scope==="personal").map(a=>e.jsxs("button",{onClick:()=>b(a.id),"data-testid":`settings-section-${a.id}`,className:`w-full flex items-start gap-3 px-4 py-3 rounded-lg text-left transition-colors ${x===a.id?"bg-blue-50 text-blue-700 font-medium":"text-gray-700 hover:bg-gray-50"}`,title:a.description,children:[e.jsx(l,{path:a.icon,size:.9,className:"flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium",children:a.label}),e.jsx("div",{className:"text-xs text-gray-500 mt-0.5",children:a.description})]})]},a.id))})]}),d.filter(a=>a.scope==="organization").length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 mb-1","data-testid":"organization-settings-group",children:[e.jsx(l,{path:B,size:.7,className:"text-orange-600"}),e.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Organization Settings"})]}),e.jsx("div",{className:"space-y-1",children:d.filter(a=>a.scope==="organization").map(a=>e.jsxs("button",{onClick:()=>b(a.id),"data-testid":`settings-section-${a.id}`,className:`w-full flex items-start gap-3 px-4 py-3 rounded-lg text-left transition-colors ${x===a.id?"bg-orange-50 text-orange-700 font-medium":"text-gray-700 hover:bg-gray-50"}`,title:a.description,children:[e.jsx(l,{path:a.icon,size:.9,className:"flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium",children:a.label}),e.jsx("div",{className:"text-xs text-gray-500 mt-0.5",children:a.description})]})]},a.id))})]})]})}),e.jsx("main",{className:"flex-1 overflow-y-auto bg-gray-50 p-6","data-testid":"settings-content",children:N})]})]})}function Ne(){const{t:s}=A();return e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(l,{path:P,size:1,className:"text-red-600"}),s("settings.advanced.title")]}),e.jsx("p",{className:"text-gray-600",children:s("settings.advanced.description")}),e.jsx("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-sm text-red-800",children:"‚ö†Ô∏è Advanced Settings (Danger Zone) coming soon..."})})]})}export{Ie as default};
