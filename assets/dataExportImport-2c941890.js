import{E as A,_ as b}from"./index-d4e44bf1.js";var U={exports:{}};(function(t,r){(function(a,h){h()})(A,function(){function a(c,o){return typeof o>"u"?o={autoBom:!1}:typeof o!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),o={autoBom:!o}),o.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(c.type)?new Blob(["\uFEFF",c],{type:c.type}):c}function h(c,o,u){var i=new XMLHttpRequest;i.open("GET",c),i.responseType="blob",i.onload=function(){y(i.response,o,u)},i.onerror=function(){console.error("could not download file")},i.send()}function l(c){var o=new XMLHttpRequest;o.open("HEAD",c,!1);try{o.send()}catch{}return 200<=o.status&&299>=o.status}function g(c){try{c.dispatchEvent(new MouseEvent("click"))}catch{var o=document.createEvent("MouseEvents");o.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),c.dispatchEvent(o)}}var p=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof A=="object"&&A.global===A?A:void 0,n=p.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),y=p.saveAs||(typeof window!="object"||window!==p?function(){}:"download"in HTMLAnchorElement.prototype&&!n?function(c,o,u){var i=p.URL||p.webkitURL,m=document.createElement("a");o=o||c.name||"download",m.download=o,m.rel="noopener",typeof c=="string"?(m.href=c,m.origin===location.origin?g(m):l(m.href)?h(c,o,u):g(m,m.target="_blank")):(m.href=i.createObjectURL(c),setTimeout(function(){i.revokeObjectURL(m.href)},4e4),setTimeout(function(){g(m)},0))}:"msSaveOrOpenBlob"in navigator?function(c,o,u){if(o=o||c.name||"download",typeof c!="string")navigator.msSaveOrOpenBlob(a(c,u),o);else if(l(c))h(c,o,u);else{var i=document.createElement("a");i.href=c,i.target="_blank",setTimeout(function(){g(i)})}}:function(c,o,u,i){if(i=i||open("","_blank"),i&&(i.document.title=i.document.body.innerText="downloading..."),typeof c=="string")return h(c,o,u);var m=c.type==="application/octet-stream",_=/constructor/i.test(p.HTMLElement)||p.safari,C=/CriOS\/[\d]+/.test(navigator.userAgent);if((C||m&&_||n)&&typeof FileReader<"u"){var E=new FileReader;E.onloadend=function(){var x=E.result;x=C?x:x.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=x:location=x,i=null},E.readAsDataURL(c)}else{var v=p.URL||p.webkitURL,S=v.createObjectURL(c);i?i.location=S:location.href=S,i=null,setTimeout(function(){v.revokeObjectURL(S)},4e4)}});p.saveAs=y.saveAs=y,t.exports=y})})(U);var F=U.exports;let M=null,I=null;typeof process<"u"&&process.env;async function V(t,r,a,h={}){try{let i=function(e){let s=e,d="";for(;s>0;){let f=(s-1)%26;d=String.fromCharCode(65+f)+d,s=Math.floor((s-f)/26)}return d};const l=t.map(e=>{const s={};return r.forEach(d=>{const f=e[d.key];if(d&&d.key&&String(d.key).startsWith("category:")){const w=f==null?"":String(f).trim().toUpperCase(),L=w==="TRUE"||w==="1"||w==="YES"||w==="+"||w==="X"||w==="✓";s[d.header]=L?"+":"-"}else s[d.header]=D(f,d.type)}),s});let g;if(M)g=M;else{const e=await b(()=>import("./exceljs.min-17ead07f.js").then(s=>s.e),["assets/exceljs.min-17ead07f.js","assets/index-d4e44bf1.js","assets/index-09b34d91.css"]);g=e&&e.default?e.default:e}const p=new g.Workbook,n=p.addWorksheet("Data"),y=r.map(e=>({header:e.header,key:e.header,origKey:e.key,origType:e.type}));y.length&&(n.columns=y),n.addRows(l);const c=10,o=60,u=r.map(e=>{let d=String(e.header||"").length;for(const w of l){const L=w[e.header],R=L==null?"":String(L);R.length>d&&(d=R.length)}return{width:Math.min(Math.max(d+2,c),o)}});n.columns.forEach((e,s)=>{u[s]&&(e.width=u[s].width)}),r.forEach((e,s)=>{if(e.wrapText){const d=s+1;for(let f=2;f<=(n.rowCount||l.length+1);f++){const w=n.getRow(f).getCell(d);w.alignment={wrapText:!0,vertical:"top",horizontal:"left"}}}});for(let e=2;e<=(n.rowCount||l.length+1);e++){const s=n.getRow(e);for(let d=1;d<=r.length;d++){const f=s.getCell(d);f.alignment={...f.alignment,vertical:"top"}}}const m=l.length+1,_=r.length,C=i(_);try{n.addTable({name:`Data_${Date.now()}`,ref:`A1:${C}${m}`,headerRow:!0,totalsRow:!1,style:{theme:"TableStyleMedium2",showRowStripes:!0,showColumnStripes:!1},columns:r.map(e=>({name:e.header})),rows:l.map(e=>r.map(s=>e[s.header]))})}catch{}const E=n.columns.map((e,s)=>({c:e,i:s})).filter(e=>!!(e.c&&e.c.origKey&&String(e.c.origKey).startsWith("category:")||e.c&&e.c.origType==="boolean"||e.c&&e.c.header&&String(e.c.header).toLowerCase().includes("category"))).map(e=>e.i+1);for(let e=2;e<=(n.rowCount||l.length+1);e++){const s=n.getRow(e);for(const d of E){const f=s.getCell(d);try{f.dataValidation={type:"list",allowBlank:!0,formulae:['"+,-"'],showErrorMessage:!0,errorStyle:"stop",errorTitle:"Invalid value",error:"Please select either + or - from the list."}}catch{}}}for(let e=2;e<=(n.rowCount||l.length+1);e++){const s=n.getRow(e);for(const d of E){const f=s.getCell(d);try{f.alignment={vertical:"top",horizontal:"center"}}catch{}}}const v=h&&Number.isInteger(h.freezeColumns)&&h.freezeColumns>0?h.freezeColumns:1,S=v+1;n.views=[{state:"frozen",xSplit:v,ySplit:1,topLeftCell:`${i(S)}2`}];try{const e=n.getRow(1);for(let s=1;s<=r.length;s++)try{e.getCell(s).protection={locked:!0}}catch{}for(let s=2;s<=(n.rowCount||l.length+1);s++){const d=n.getRow(s);for(let f=1;f<=r.length;f++)try{d.getCell(f).protection={locked:f<=v}}catch{}}try{n.protect&&n.protect("",{})}catch{}}catch{}try{const e=p.addWorksheet("__export_metadata"),s={columns:r.map(f=>({key:f.key,header:f.header}))},d=Object.assign({},s,h.metadata||{});e.getCell("A1").value=JSON.stringify(d);try{e.state="veryHidden"}catch{}}catch{}const x=await p.xlsx.writeBuffer(),O=new Blob([x],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});return F.saveAs(O,`${a}.xlsx`),{success:!0}}catch(l){return console.error("Excel export error:",l),{success:!1,error:l.message}}}async function P(t,r,a){try{const h=t.map(y=>{const c={};return r.forEach(o=>{const u=y[o.key];c[o.header]=D(u,o.type)}),c});let l;if(I)l=I;else{const y=await b(()=>import("./xlsx-6ed613d4.js"),[]);l=y&&y.default?y.default:y}const g=l.utils.json_to_sheet(h),p=l.utils.sheet_to_csv(g),n=new Blob([p],{type:"text/csv;charset=utf-8;"});return F.saveAs(n,`${a}.csv`),{success:!0}}catch(h){return console.error("CSV export error:",h),{success:!1,error:h.message}}}async function W(t,r){try{const a=JSON.stringify(t,null,2),h=new Blob([a],{type:"application/json"});return F.saveAs(h,`${r}.json`),{success:!0}}catch(a){return console.error("JSON export error:",a),{success:!1,error:a.message}}}function D(t,r){if(t==null)return"";switch(r){case"number":return typeof t=="number"?t:"";case"boolean":if(typeof t=="boolean")return t?"TRUE":"FALSE";const a=String(t).trim().toUpperCase();return a==="TRUE"||a==="1"||a==="YES"||a==="+"||a==="X"?"TRUE":"FALSE";default:return String(t)}}async function j(t){return new Promise(r=>{const a=new FileReader;a.onload=async h=>{try{let l;typeof process<"u"&&process.env;{const u=await b(()=>import("./xlsx-6ed613d4.js"),[]);l=u&&u.default?u.default:u}const g=new Uint8Array(h.target.result),p=l.read(g,{type:"array"});let n=null;try{const u=p.Sheets.__export_metadata;u&&u.A1&&u.A1.v&&(n=JSON.parse(String(u.A1.v)))}catch{}const y=p.SheetNames[0],c=p.Sheets[y],o=l.utils.sheet_to_json(c,{defval:"",raw:!1});if(n&&n.format==="long"&&Array.isArray(n.columns)){const u=n.columns.find(e=>e.key==="category_slug"),i=n.columns.find(e=>e.key==="category_selected"),m=u?u.header:(n.columns.find(e=>String(e.header).toLowerCase().includes("category slug"))||{}).header,_=i?i.header:(n.columns.find(e=>String(e.header).toLowerCase().includes("selected"))||{}).header,C=n.columns.find(e=>e.key==="id"),E=C?C.header:(n.columns.find(e=>String(e.header).toLowerCase()==="id")||{}).header,v=n.columns.find(e=>e.key==="name"),S=v?v.header:(n.columns.find(e=>String(e.header).toLowerCase().includes("company name"))||{}).header,x={};o.forEach((e,s)=>{const d=E?String(e[E]):"",f=S?String(e[S]):"",w=d&&d!=="undefined"&&d!=="null"?`id:${d}`:f?`name:${f}`:`row:${s}`;if(!x[w]){const X={};Object.keys(e).forEach(T=>{T===m||T===_||(X[T]=e[T])}),X.__aggregatedCategories=new Set,x[w]=X}const L=m?e[m]:void 0,R=_?e[_]:void 0,k=R==null?"":String(R).trim().toUpperCase();L&&(k==="TRUE"||k==="1"||k==="YES"||k==="+"||k==="X")&&x[w].__aggregatedCategories.add(String(L).trim())});const O=Object.values(x).map(e=>{const s=Array.from(e.__aggregatedCategories);return delete e.__aggregatedCategories,e.Categories=s.join(", "),e});o.length=0,O.forEach(e=>o.push(e))}if(n&&Array.isArray(n.columns)){const u=n.columns.filter(i=>i.key&&String(i.key).startsWith("category:"));u.length&&o.forEach(i=>{const m=[];u.forEach(_=>{const C=_.header,E=String(_.key).split(":")[1],v=i[C];if(v!=null){const S=String(v).trim().toUpperCase();(S==="TRUE"||S==="1"||S==="YES"||S==="+"||S==="X"||S==="✓")&&m.push(E)}}),i.Categories=m.join(", ")})}r({data:o,error:null,metadata:n})}catch(l){console.error("Error parsing Excel file:",l),r({data:null,error:l.message})}},a.onerror=()=>{r({data:null,error:"Failed to read file"})},a.readAsArrayBuffer(t)})}async function N(t){return new Promise(r=>{const a=new FileReader;a.onload=async h=>{try{const l=h.target.result;let g;typeof process<"u"&&process.env;{const o=await b(()=>import("./xlsx-6ed613d4.js"),[]);g=o&&o.default?o.default:o}const p=g.read(l,{type:"string"}),n=p.SheetNames[0],y=p.Sheets[n],c=g.utils.sheet_to_json(y,{defval:"",raw:!1});r({data:c,error:null})}catch(l){console.error("Error parsing CSV file:",l),r({data:null,error:l.message})}},a.onerror=()=>{r({data:null,error:"Failed to read file"})},a.readAsText(t)})}async function $(t){return new Promise(r=>{const a=new FileReader;a.onload=h=>{try{const l=JSON.parse(h.target.result);if(!Array.isArray(l)){r({data:null,error:"JSON must be an array of objects"});return}r({data:l,error:null})}catch(l){console.error("Error parsing JSON file:",l),r({data:null,error:"Invalid JSON format"})}},a.onerror=()=>{r({data:null,error:"Failed to read file"})},a.readAsText(t)})}async function z(t){const r=t.name.split(".").pop().toLowerCase();switch(r){case"xlsx":case"xls":return j(t);case"csv":return N(t);case"json":return $(t);default:return{data:null,error:`Unsupported file type: .${r}`}}}function J(t){if(Array.isArray(t))return t.map(a=>J(a));if(!t||typeof t!="object")return t;const r={};return Object.keys(t).forEach(a=>{String(a).startsWith("_")||(r[a]=t[a])}),r}function q(t){if(!t||t.trim()==="")return{valid:!0,value:null,error:null};const r=t.toLowerCase().trim();return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r)?{valid:!0,value:r,error:null}:{valid:!1,value:null,error:`Invalid email format: "${t}"`}}function K(t,r){if(!t||t.trim()==="")return{valid:!0,value:null,error:null};const a=r(t);return a?{valid:!0,value:a,error:null}:{valid:!1,value:null,error:`Invalid phone format: "${t}"`}}function Y(t,r){return t==null||t===""?{valid:!1,error:`${r} is required`}:typeof t=="string"&&t.trim()===""?{valid:!1,error:`${r} cannot be empty`}:{valid:!0,error:null}}function G(t,r,a,h=!1){const l={};return t.forEach(g=>{let p=g[r];!h&&typeof p=="string"&&(p=p.toLowerCase().trim()),l[p]=g[a]}),l}export{F,q as a,K as b,P as c,V as d,W as e,G as f,z as p,J as s,Y as v};
