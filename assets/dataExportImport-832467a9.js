import{ab as A,ao as I}from"./vendor-eeb19b8c.js";let O=null,F=null;typeof process<"u"&&process.env;async function P(t,r,a,d={}){try{let m=function(e){let o=e,l="";for(;o>0;){let c=(o-1)%26;l=String.fromCharCode(65+c)+l,o=Math.floor((o-c)/26)}return l};const s=t.map(e=>{const o={};return r.forEach(l=>{const c=e[l.key];if(l&&l.key&&String(l.key).startsWith("category:")){const f=c==null?"":String(c).trim().toUpperCase(),_=f==="TRUE"||f==="1"||f==="YES"||f==="+"||f==="X"||f==="✓";o[l.header]=_?"+":"-"}else o[l.header]=N(c,l.type)}),o});let h;if(O)h=O;else{const e=await A(()=>import("./vendor-exceljs-c5610847.js").then(o=>o.e),["assets/vendor-exceljs-c5610847.js","assets/vendor-eeb19b8c.js","assets/vendor-react-868f88e1.js","assets/vendor-4b398481.css"]);h=e&&e.default?e.default:e}const u=new h.Workbook,n=u.addWorksheet("Data"),p=r.map(e=>({header:e.header,key:e.header,origKey:e.key,origType:e.type}));p.length&&(n.columns=p),n.addRows(s);const w=10,g=60,i=r.map(e=>{let l=String(e.header||"").length;for(const f of s){const _=f[e.header],L=_==null?"":String(_);L.length>l&&(l=L.length)}return{width:Math.min(Math.max(l+2,w),g)}});n.columns.forEach((e,o)=>{i[o]&&(e.width=i[o].width)}),r.forEach((e,o)=>{if(e.wrapText){const l=o+1;for(let c=2;c<=(n.rowCount||s.length+1);c++){const f=n.getRow(c).getCell(l);f.alignment={wrapText:!0,vertical:"top",horizontal:"left"}}}});for(let e=2;e<=(n.rowCount||s.length+1);e++){const o=n.getRow(e);for(let l=1;l<=r.length;l++){const c=o.getCell(l);c.alignment={...c.alignment,vertical:"top"}}}const x=s.length+1,C=r.length,v=m(C);try{n.addTable({name:`Data_${Date.now()}`,ref:`A1:${v}${x}`,headerRow:!0,totalsRow:!1,style:{theme:"TableStyleMedium2",showRowStripes:!0,showColumnStripes:!1},columns:r.map(e=>({name:e.header})),rows:s.map(e=>r.map(o=>e[o.header]))})}catch{}const E=n.columns.map((e,o)=>({c:e,i:o})).filter(e=>!!(e.c&&e.c.origKey&&String(e.c.origKey).startsWith("category:")||e.c&&e.c.origType==="boolean"||e.c&&e.c.header&&String(e.c.header).toLowerCase().includes("category"))).map(e=>e.i+1);for(let e=2;e<=(n.rowCount||s.length+1);e++){const o=n.getRow(e);for(const l of E){const c=o.getCell(l);try{c.dataValidation={type:"list",allowBlank:!0,formulae:['"+,-"'],showErrorMessage:!0,errorStyle:"stop",errorTitle:"Invalid value",error:"Please select either + or - from the list."}}catch{}}}for(let e=2;e<=(n.rowCount||s.length+1);e++){const o=n.getRow(e);for(const l of E){const c=o.getCell(l);try{c.alignment={vertical:"top",horizontal:"center"}}catch{}}}const S=d&&Number.isInteger(d.freezeColumns)&&d.freezeColumns>0?d.freezeColumns:1,y=S+1;n.views=[{state:"frozen",xSplit:S,ySplit:1,topLeftCell:`${m(y)}2`}];try{const e=n.getRow(1);for(let o=1;o<=r.length;o++)try{e.getCell(o).protection={locked:!0}}catch{}for(let o=2;o<=(n.rowCount||s.length+1);o++){const l=n.getRow(o);for(let c=1;c<=r.length;c++)try{l.getCell(c).protection={locked:c<=S}}catch{}}try{n.protect&&n.protect("",{})}catch{}}catch{}try{const e=u.addWorksheet("__export_metadata"),o={columns:r.map(c=>({key:c.key,header:c.header}))},l=Object.assign({},o,d.metadata||{});e.getCell("A1").value=JSON.stringify(l);try{e.state="veryHidden"}catch{}}catch{}const k=await u.xlsx.writeBuffer(),X=new Blob([k],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});return I.saveAs(X,`${a}.xlsx`),{success:!0}}catch(s){return console.error("Excel export error:",s),{success:!1,error:s.message}}}async function W(t,r,a){try{const d=t.map(p=>{const w={};return r.forEach(g=>{const i=p[g.key];w[g.header]=N(i,g.type)}),w});let s;if(F)s=F;else{const p=await A(()=>import("./vendor-xlsx-6ed613d4.js"),[]);s=p&&p.default?p.default:p}const h=s.utils.json_to_sheet(d),u=s.utils.sheet_to_csv(h),n=new Blob([u],{type:"text/csv;charset=utf-8;"});return I.saveAs(n,`${a}.csv`),{success:!0}}catch(d){return console.error("CSV export error:",d),{success:!1,error:d.message}}}async function z(t,r){try{const a=JSON.stringify(t,null,2),d=new Blob([a],{type:"application/json"});return I.saveAs(d,`${r}.json`),{success:!0}}catch(a){return console.error("JSON export error:",a),{success:!1,error:a.message}}}function N(t,r){if(t==null)return"";switch(r){case"number":return typeof t=="number"?t:"";case"boolean":if(typeof t=="boolean")return t?"TRUE":"FALSE";const a=String(t).trim().toUpperCase();return a==="TRUE"||a==="1"||a==="YES"||a==="+"||a==="X"?"TRUE":"FALSE";default:return String(t)}}async function $(t){return new Promise(r=>{const a=new FileReader;a.onload=async d=>{try{let s;typeof process<"u"&&process.env;{const i=await A(()=>import("./vendor-xlsx-6ed613d4.js"),[]);s=i&&i.default?i.default:i}const h=new Uint8Array(d.target.result),u=s.read(h,{type:"array"});let n=null;try{const i=u.Sheets.__export_metadata;i&&i.A1&&i.A1.v&&(n=JSON.parse(String(i.A1.v)))}catch{}const p=u.SheetNames[0],w=u.Sheets[p],g=s.utils.sheet_to_json(w,{defval:"",raw:!1});if(n&&n.format==="long"&&Array.isArray(n.columns)){const i=n.columns.find(e=>e.key==="category_slug"),m=n.columns.find(e=>e.key==="category_selected"),x=i?i.header:(n.columns.find(e=>String(e.header).toLowerCase().includes("category slug"))||{}).header,C=m?m.header:(n.columns.find(e=>String(e.header).toLowerCase().includes("selected"))||{}).header,v=n.columns.find(e=>e.key==="id"),E=v?v.header:(n.columns.find(e=>String(e.header).toLowerCase()==="id")||{}).header,S=n.columns.find(e=>e.key==="name"),y=S?S.header:(n.columns.find(e=>String(e.header).toLowerCase().includes("company name"))||{}).header,k={};g.forEach((e,o)=>{const l=E?String(e[E]):"",c=y?String(e[y]):"",f=l&&l!=="undefined"&&l!=="null"?`id:${l}`:c?`name:${c}`:`row:${o}`;if(!k[f]){const b={};Object.keys(e).forEach(R=>{R===x||R===C||(b[R]=e[R])}),b.__aggregatedCategories=new Set,k[f]=b}const _=x?e[x]:void 0,L=C?e[C]:void 0,T=L==null?"":String(L).trim().toUpperCase();_&&(T==="TRUE"||T==="1"||T==="YES"||T==="+"||T==="X")&&k[f].__aggregatedCategories.add(String(_).trim())});const X=Object.values(k).map(e=>{const o=Array.from(e.__aggregatedCategories);return delete e.__aggregatedCategories,e.Categories=o.join(", "),e});g.length=0,X.forEach(e=>g.push(e))}if(n&&Array.isArray(n.columns)){const i=n.columns.filter(m=>m.key&&String(m.key).startsWith("category:"));i.length&&g.forEach(m=>{const x=[];i.forEach(C=>{const v=C.header,E=String(C.key).split(":")[1],S=m[v];if(S!=null){const y=String(S).trim().toUpperCase();(y==="TRUE"||y==="1"||y==="YES"||y==="+"||y==="X"||y==="✓")&&x.push(E)}}),m.Categories=x.join(", ")})}r({data:g,error:null,metadata:n})}catch(s){console.error("Error parsing Excel file:",s),r({data:null,error:s.message})}},a.onerror=()=>{r({data:null,error:"Failed to read file"})},a.readAsArrayBuffer(t)})}async function D(t){return new Promise(r=>{const a=new FileReader;a.onload=async d=>{try{const s=d.target.result;let h;typeof process<"u"&&process.env;{const g=await A(()=>import("./vendor-xlsx-6ed613d4.js"),[]);h=g&&g.default?g.default:g}const u=h.read(s,{type:"string"}),n=u.SheetNames[0],p=u.Sheets[n],w=h.utils.sheet_to_json(p,{defval:"",raw:!1});r({data:w,error:null})}catch(s){console.error("Error parsing CSV file:",s),r({data:null,error:s.message})}},a.onerror=()=>{r({data:null,error:"Failed to read file"})},a.readAsText(t)})}async function J(t){return new Promise(r=>{const a=new FileReader;a.onload=d=>{try{const s=JSON.parse(d.target.result);if(!Array.isArray(s)){r({data:null,error:"JSON must be an array of objects"});return}r({data:s,error:null})}catch(s){console.error("Error parsing JSON file:",s),r({data:null,error:"Invalid JSON format"})}},a.onerror=()=>{r({data:null,error:"Failed to read file"})},a.readAsText(t)})}async function H(t){const r=t.name.split(".").pop().toLowerCase();switch(r){case"xlsx":case"xls":return $(t);case"csv":return D(t);case"json":return J(t);default:return{data:null,error:`Unsupported file type: .${r}`}}}function M(t){if(Array.isArray(t))return t.map(a=>M(a));if(!t||typeof t!="object")return t;const r={};return Object.keys(t).forEach(a=>{String(a).startsWith("_")||(r[a]=t[a])}),r}function q(t){if(!t||t.trim()==="")return{valid:!0,value:null,error:null};const r=t.toLowerCase().trim();return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r)?{valid:!0,value:r,error:null}:{valid:!1,value:null,error:`Invalid email format: "${t}"`}}function B(t,r){if(!t||t.trim()==="")return{valid:!0,value:null,error:null};const a=r(t);return a?{valid:!0,value:a,error:null}:{valid:!1,value:null,error:`Invalid phone format: "${t}"`}}function j(t,r){return t==null||t===""?{valid:!1,error:`${r} is required`}:typeof t=="string"&&t.trim()===""?{valid:!1,error:`${r} cannot be empty`}:{valid:!0,error:null}}function K(t,r,a,d=!1){const s={};return t.forEach(h=>{let u=h[r];!d&&typeof u=="string"&&(u=u.toLowerCase().trim()),s[u]=h[a]}),s}export{q as a,B as b,W as c,P as d,z as e,K as f,H as p,M as s,j as v};
