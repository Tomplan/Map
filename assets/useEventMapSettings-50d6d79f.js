import{r as o,s as a}from"./index-ef143467.js";function _(t){const[l,s]=o.useState(null),[f,c]=o.useState(!0),[d,i]=o.useState(null),u=o.useCallback(async()=>{if(!t){s(null),c(!1);return}try{c(!0),i(null);const{data:e,error:r}=await a.from("event_map_settings").select("*").eq("event_year",t).maybeSingle();r&&r.code!=="PGRST116"?(console.error("Error fetching event map settings:",r),i(r.message),s(null)):(s(e),i(null))}catch(e){console.error("Error in fetchSettings:",e),i(e.message),s(null)}finally{c(!1)}},[t]),p=o.useCallback(async e=>{if(!t)return console.error("Cannot update settings: No event year specified"),!1;try{const{data:{user:r}}=await a.auth.getUser();if(!r)return console.error("Cannot update settings: No user logged in"),!1;if(l){const{data:g,error:n}=await a.from("event_map_settings").update({...e,updated_by:r.id}).eq("event_year",t).select().single();if(n)throw console.error("Error updating event map settings:",n),new Error(n.message);s(g)}else{const{data:g,error:n}=await a.from("event_map_settings").insert([{event_year:t,...e,created_by:r.id,updated_by:r.id}]).select().single();if(n)throw console.error("Error creating event map settings:",n),new Error(n.message);s(g)}return!0}catch(r){throw console.error("Error in updateSettings:",r),r}},[t,l]),m=o.useCallback(async()=>{if(!t)return console.error("Cannot reset settings: No event year specified"),!1;try{const{error:e}=await a.from("event_map_settings").delete().eq("event_year",t);if(e)throw console.error("Error resetting event map settings:",e),new Error(e.message);return s(null),!0}catch(e){throw console.error("Error in resetToGlobal:",e),e}},[t]);return o.useEffect(()=>{u()},[u]),{settings:l,loading:f,error:d,updateSettings:p,resetToGlobal:m,refetch:u}}export{_ as u};
