# Logo optimization pipeline

This repository contains a small reproducible Node script to create optimized raster variants for logos (WebP + AVIF) so they are responsive and bandwidth-friendly.

Prerequisites
- Node 18+ and npm
- `sharp` requires libvips installed on your system (see https://sharp.pixelplumbing.com/install)

Quick usage

1. Dry run locally (no uploads):

```bash
# install dependencies
npm ci

# generate variants for all files in public/assets/logos -> public/assets/logos/generated
npm run images:optimize-logos
```

2. Check that 128px webp variants exist for each logo (CI-friendly):

```bash
npm run images:check-logos
```

Notes
- The script copies originals to `public/assets/logos/originals/` and creates generated variants in `public/assets/logos/generated/`.
- For logos that are vector (SVG) or simple icon marks, consider converting to true SVG and keeping it in the repo. For photographic logos use raster variants generated by the script.

Next steps
- Add automated uploads to Supabase Storage or push generated files into a versioned asset path for CDN caching.

Upload to Supabase and CI
- You can upload the generated assets to your Supabase `Logos` bucket so they are served from the edge/CDN. Use the `scripts/upload-logos.mjs` script which requires `SUPABASE_URL` and `SUPABASE_SERVICE_ROLE_KEY` env vars (service role key is required to upload to storage from CI).

CI example (GitHub Actions)
1. Add the following secrets to your repo: `SUPABASE_URL` and `SUPABASE_SERVICE_ROLE_KEY`.
2. Add a CI job (example workflow shown in `.github/workflows/upload-logos.yml`) that runs `npm ci`, `npm run images:optimize-logos`, then `npm run images:upload-logos`.

When uploaded to Supabase Storage under `generated/` the application can reference these assets directly by public URL or by `getLogoPath` / `getResponsiveLogoSources` helpers.
