# Regression Report — 2025-12-15

Summary:
- Snapshot branch: `snapshot/before-regression-2025-12-15` contains multiple changes made today.
- Last-known-good commit: `origin/development` (Merge PR #33, commit 2e6a186). Running full tests on that commit passes.

Immediate visible regressions (from running tests on snapshot):
- Failing test: `src/components/__tests__/EventSpecialMarkers.safeMarkersNull.test.jsx`
  - Error: Unable to find element `[data-testid="marker"]` when `safeMarkers` prop is `null`.
  - Repro: `npx jest src/components/__tests__/EventSpecialMarkers.safeMarkersNull.test.jsx` (see `regressions/EventSpecialMarkers.safeMarkersNull.output.txt`).
- Memory/OOM during full test run (heap OOM while running full suite) — likely due to newly added heavy dependencies (`xlsx`, `exceljs` mocked files added) increasing build memory footprint.
- Many files added/modified today (see `regressions/changed-files-2025-12-15.txt`). Key areas touched:
  - `src/components/EventMap/EventMapInner.jsx` (new file)
  - `src/components/EventSpecialMarkers.jsx` (modified)
  - `src/components/EventMap/EventMap.jsx` (modified)
  - `src/utils/minimap.js`, tests for minimap added
  - `package.json` and `package-lock.json` (dependencies changed)
  - `__mocks__/*` added for heavy libs
  - Tests: several new tests added under `src/components/__tests__` and top-level `tests/` (offline tests)

Recommended immediate recovery options:
1. Non-destructive restore (recommended):
   - Create and push a branch `restore/from-development-2025-12-15` (done) containing the known-good commit state.
   - Open a PR to replace the broken branch(s) or merge `restore/from-development-2025-12-15` into `development`/`main` to roll back today's changes after review.
2. Fast restore (destructive):
   - Force-reset `fix/safe-default-safeMarkers` (and other affected branches) to `origin/development` or `origin/main` then push (`git push --force`). Ask for explicit confirmation before doing this.

Next triage steps (I can run these now):
- Map failing tests to changed files and create per-regression entries.
- Decide whether to revert or to fix the new tests (if the tests are valid, implement required behavior to make them pass).
- If we revert, create a follow-up branch to reintroduce safe default for `safeMarkers` cleanly and add tests.

Artifacts created:
- `regressions/changed-files-2025-12-15.txt`
- `regressions/changed-commits-2025-12-15.txt`
- `regressions/EventSpecialMarkers.safeMarkersNull.output.txt`

